<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
    <channel>
        <title>Distribute System on Coding_Panda&#39;s Blog</title>
        <link>https://blog.ipandai.club/tags/distribute-system/</link>
        <description>Recent content in Distribute System on Coding_Panda&#39;s Blog</description>
        <generator>Hugo -- gohugo.io</generator>
        <language>en-us</language>
        <lastBuildDate>Thu, 02 Mar 2023 15:11:40 +0800</lastBuildDate><atom:link href="https://blog.ipandai.club/tags/distribute-system/index.xml" rel="self" type="application/rss+xml" /><item>
        <title>[FAST&#39;23] More Than Capacity: Performance-oriented Evolution of Pangu in Alibaba</title>
        <link>https://blog.ipandai.club/p/fast23-more-than-capacity-performance-oriented-evolution-of-pangu-in-alibaba/</link>
        <pubDate>Thu, 02 Mar 2023 15:11:40 +0800</pubDate>
        
        <guid>https://blog.ipandai.club/p/fast23-more-than-capacity-performance-oriented-evolution-of-pangu-in-alibaba/</guid>
        <description>&lt;p&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.usenix.org/conference/fast23/presentation/li-qiang-deployed&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[FAST&#39;23] More Than Capacity: Performance-oriented Evolution of Pangu in Alibaba&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;FAST&#39;23 ä¼šè®®è®ºæ–‡ç¿»è¯‘ï¼Œã€Šä¸ä»…ä»…æ˜¯å®¹é‡:ç›˜å¤é¢å‘æ€§èƒ½çš„æ¼”å˜ã€‹&lt;/p&gt;
&lt;p&gt;æœ¬è®ºæ–‡è®²è¿°äº†Panguå­˜å‚¨ç³»ç»Ÿæ˜¯å¦‚ä½•éšç€ç¡¬ä»¶åŠå•†ä¸šéœ€æ±‚ï¼Œå»æ¼”å˜æä¾›æ›´é«˜çš„æ€§èƒ½çš„ï¼Œå­˜å‚¨æœåŠ¡çš„I/Oå»¶è¿Ÿè¾¾åˆ°äº†100-usã€‚ç›˜å¤çš„æ¼”å˜ä¸»è¦æœ‰ä¸¤ä¸ªéƒ¨åˆ†ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Phase 1: ç›˜å¤é€šè¿‡ä¼˜åŒ–æ–‡ä»¶ç³»ç»Ÿå¹¶è®¾è®¡äº†ç”¨æˆ·ç«¯çš„å­˜å‚¨æ“ä½œç³»ç»Ÿï¼Œç§¯æå¼•å…¥é«˜é€ŸSSDå’ŒRemote Direct Memory Access(RDMA)ç½‘ç»œæŠ€æœ¯ã€‚å› æ­¤ï¼Œç›˜å¤åœ¨æœ‰æ•ˆé™ä½äº†I/Oå»¶è¿Ÿçš„åŒæ—¶ï¼Œè¿˜æé«˜äº†ååé‡å’ŒIOPSã€‚&lt;/li&gt;
&lt;li&gt;Phase 2: ç›˜å¤ä»é¢å‘å·çš„å­˜å‚¨ä¾›åº”å•†è½¬å˜ä¸ºé¢å‘æ€§èƒ½ã€‚ä¸ºäº†é€‚åº”è¿™ä¸€å•†ä¸šæ¨¡å¼çš„æ”¹å˜ï¼Œç›˜å¤ä½¿ç”¨è¶³å¤Ÿå¤šçš„SSDå’Œ25Gbps-100Gbpsçš„RDMAå¸¦å®½æ›´æ–°äº†åŸºç¡€è®¾æ–½ã€‚è¿™å¼•å…¥äº†ä¸€äº›åˆ—çš„å…³é”®è®¾è®¡ï¼ŒåŒ…æ‹¬å‡å°‘æµé‡æ”¾å¤§ï¼Œè¿œç¨‹ç›´æ¥ç¼“å­˜è®¿é—®ï¼Œå’ŒCPUè®¡ç®—å¸è½½ï¼Œæ¥ä¿è¯ç›˜å¤å®Œå…¨è·å¾—åŸºäºç¡¬ä»¶å‡çº§æ‰€å¸¦æ¥çš„æ€§èƒ½æå‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;é™¤äº†æŠ€æœ¯ä¸Šçš„åˆ›æ–°ï¼Œä½œè€…è¿˜åˆ†äº«äº†ç›˜å¤å‘å±•è¿‡ç¨‹ä¸­çš„è¿è¥ç»éªŒï¼Œå¹¶è®¨è®ºäº†å…¶ä¸­çš„é‡è¦æ•™è®­ã€‚&lt;/p&gt;
&lt;h1 id=&#34;0x00-intro&#34;&gt;0x00 Intro&lt;/h1&gt;
&lt;p&gt;ç›˜å¤çš„å¼€å‘å§‹äº2009å¹´ï¼Œç›®å‰å·²ç»æ˜¯é˜¿é‡Œå·´å·´é›†å›¢å’Œé˜¿é‡Œäº‘ç»Ÿä¸€å­˜å‚¨å¹³å°ã€‚ç›˜å¤ä¸ºé˜¿é‡Œçš„æ ¸å¿ƒä¸šåŠ¡æä¾›äº†å¯ä¼¸ç¼©æ€§ã€é«˜æ€§èƒ½å’Œå¯é æ€§ã€‚&lt;/p&gt;
&lt;p&gt;Elastic Block Storage(EBS), Object Storage Service(OSS), Network-Attached Storage(NAS), PolarDB, MaxComputeè¿™äº›äº‘æœåŠ¡åŸºäºç›˜å¤å»ºç«‹ã€‚ç»è¿‡åå‡ å¹´çš„å‘å±•ï¼Œç›˜å¤å·²ç»æˆä¸ºäº†ä¸€ä¸ªæ‹¥æœ‰ExaByteså¹¶ç®¡ç†ä¸‡äº¿æ–‡ä»¶çš„å…¨å±€å­˜å‚¨ç³»ç»Ÿã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç›˜å¤-10-æä¾›å­˜å‚¨å®¹é‡&#34;&gt;ç›˜å¤ 1.0: æä¾›å­˜å‚¨å®¹é‡&lt;/h2&gt;
&lt;p&gt;Pangu 1.0è®¾è®¡äº2009-2015å¹´ï¼Œé€šè¿‡é«˜æ€§èƒ½çš„CPUå’ŒHDDç»„æˆï¼Œå¯ä»¥æä¾›msæ¯«ç§’çº§åˆ«çš„I/Oå»¶è¿Ÿå’ŒGbpsçº§åˆ«çš„&lt;strong&gt;æ•°æ®ä¸­å¿ƒå¸¦å®½&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;Pangu 1.0åŸºäºLinux Ext4è®¾è®¡äº†ä¸€ä¸ªåˆ†å¸ƒå¼çš„å†…æ ¸æ–‡ä»¶ç³»ç»Ÿå’Œå†…æ ¸TCPï¼Œå¹¶ç»™äºˆä¸åŒç§ç±»çš„å­˜å‚¨æœåŠ¡æä¾›å¤šç§æ–‡ä»¶ç±»å‹æ”¯æŒï¼ˆTempfileï¼ŒLogFileï¼ŒRandom Access fileï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ­¤æ—¶æ­£å¤„äºäº‘è®¡ç®—çš„åˆå§‹é˜¶æ®µï¼Œæ€§èƒ½å—é™äºHDDæ€§èƒ½å’Œç½‘ç»œå¸¦å®½ï¼Œç›¸è¾ƒäºæ›´å¿«çš„è®¿é—®é€Ÿåº¦ï¼Œç”¨æˆ·æ›´å…³æ³¨å­˜å‚¨å®¹é‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;æ–°çš„ç¡¬ä»¶æ–°çš„è®¾è®¡&#34;&gt;æ–°çš„ç¡¬ä»¶ï¼Œæ–°çš„è®¾è®¡&lt;/h2&gt;
&lt;p&gt;è‡ª2015å¹´èµ·ï¼Œä¸ºäº†å¼•å…¥æ–°å…´çš„SSDå’ŒRDMAæŠ€æœ¯ï¼Œç›˜å¤2.0å¼€å§‹è®¾è®¡å’Œå¼€å‘ã€‚ç›˜å¤2.0çš„ç›®æ ‡æ˜¯æä¾›100usçº§åˆ«I/Oå»¶è¿Ÿçš„é«˜æ€§èƒ½çš„å­˜å‚¨æœåŠ¡ã€‚å°½ç®¡SSDå’ŒRDMAåœ¨å­˜å‚¨å’Œç½‘ç»œä¸­å®ç°ä½å»¶è¿Ÿã€é«˜æ€§èƒ½çš„I/Oï¼Œå›¢é˜Ÿå‘ç°ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç›˜å¤1.0ä¸­ä½¿ç”¨çš„å¤šç§æ–‡ä»¶ç±»å‹ï¼Œç‰¹åˆ«æ˜¯å…è®¸éšæœºè®¿é—®çš„æ–‡ä»¶ç±»å‹ï¼Œåœ¨å›ºæ€ç¡¬ç›˜ä¸Šçš„è¡¨ç°å¾ˆå·®ï¼Œè€Œå›ºæ€ç¡¬ç›˜åœ¨é¡ºåºæ“ä½œä¸Šå¯ä»¥å®ç°é«˜ååé‡å’ŒIOPSã€‚&lt;/li&gt;
&lt;li&gt;ç”±äºæ•°æ®å¤åˆ¶å’Œé¢‘ç¹çš„ä¸­æ–­ï¼Œå†…æ ¸ç©ºé—´çš„è½¯ä»¶æ ˆæ— æ³•è·Ÿä¸ŠSSDå’ŒRDMAçš„é«˜IOPSå’Œä½I/Oå»¶è¿Ÿã€‚&lt;/li&gt;
&lt;li&gt;ä»ä»¥æœåŠ¡å™¨ä¸ºä¸­å¿ƒçš„æ•°æ®ä¸­å¿ƒæ¶æ„å‘èµ„æºåˆ†æ•£çš„æ•°æ®ä¸­å¿ƒæ¶æ„çš„èŒƒå¼è½¬å˜ï¼Œå¯¹å®ç°ä½I/Oå»¶è¿Ÿæå‡ºäº†é¢å¤–çš„æŒ‘æˆ˜ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç›˜å¤20-phase-1-é€šè¿‡é‡æ„æ–‡ä»¶ç³»ç»Ÿä¸ç”¨æˆ·ç©ºé—´çš„å­˜å‚¨æ“ä½œç³»ç»Ÿæ¥æ‹¥æŠ±ssdå’Œrdma&#34;&gt;ç›˜å¤2.0 Phase 1: é€šè¿‡é‡æ„æ–‡ä»¶ç³»ç»Ÿä¸ç”¨æˆ·ç©ºé—´çš„å­˜å‚¨æ“ä½œç³»ç»Ÿæ¥æ‹¥æŠ±SSDå’ŒRDMA&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;ä¸ºäº†å®ç°é«˜æ€§èƒ½å’Œä½I/Oå»¶è¿Ÿï¼Œç›˜å¤2.0é¦–å…ˆåœ¨å…¶æ–‡ä»¶ç³»ç»Ÿä¸­çš„å…³é”®ç»„ä»¶æå‡ºäº†æ–°çš„è®¾è®¡ã€‚ä¸ºäº†ç®€åŒ–æ•´ä¸ªç³»ç»Ÿçš„å¼€å‘å’Œç®¡ç†ï¼Œç›˜å¤è®¾è®¡äº†ä¸€ä¸ªç»Ÿä¸€ã€è¿½åŠ å†™å…¥çš„æŒä¹…åŒ–å±‚ã€‚å®ƒè¿˜å¼•å…¥äº†ä¸€ä¸ªç‹¬ç«‹çš„åˆ†å—å¸ƒå±€ï¼Œä»¥å‡å°‘æ–‡ä»¶å†™å…¥æ“ä½œçš„I/Oå»¶è¿Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›˜å¤2.0è®¾è®¡äº†ä¸€ä¸ªç”¨æˆ·ç©ºé—´çš„å­˜å‚¨æ“ä½œç³»ç»Ÿï¼ˆUSSOSï¼‰ï¼ŒUSSOSSä½¿ç”¨ä¸€ä¸ªRTC(Run to completion)çº¿ç¨‹æ¨¡å‹æ¥å®ç°ç”¨æˆ·ç©ºé—´å­˜å‚¨æ ˆå’Œç”¨æˆ·ç©ºé—´ç½‘ç»œæ ˆçš„é«˜æ•ˆåä½œã€‚å®ƒè¿˜ä¸ºé«˜æ•ˆçš„CPUå’Œå†…å­˜èµ„æºåˆ†é…æå‡ºäº†ä¸€ä¸ªç”¨æˆ·ç©ºé—´çš„è°ƒåº¦æœºåˆ¶ã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;ç›˜å¤2.0éƒ¨ç½²äº†åœ¨åŠ¨æ€ç¯å¢ƒä¸‹æä¾›SLAä¿è¯çš„æœºåˆ¶ã€‚é€šè¿‡è¿™äº›åˆ›æ–°ï¼Œç›˜å¤2.0å®ç°äº†æ¯«ç§’çº§åˆ«çš„P999 I/Oå»¶è¿Ÿã€‚&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;ç›˜å¤20-phase-2-é€šè¿‡åŸºç¡€è®¾æ–½æ›´æ–°å’Œçªç ´ç½‘ç»œå†…å­˜cpuç“¶é¢ˆé€‚åº”ä»¥æ€§èƒ½ä¸ºå¯¼å‘çš„ä¸šåŠ¡æ¨¡å¼&#34;&gt;ç›˜å¤2.0 Phase 2: é€šè¿‡åŸºç¡€è®¾æ–½æ›´æ–°å’Œçªç ´ç½‘ç»œ/å†…å­˜/CPUç“¶é¢ˆï¼Œé€‚åº”ä»¥æ€§èƒ½ä¸ºå¯¼å‘çš„ä¸šåŠ¡æ¨¡å¼&lt;/h2&gt;
&lt;p&gt;2018å¹´èµ·ï¼Œç›˜å¤é€æ¸ä»å®¹é‡å¯¼å‘çš„å•†ä¸šæ¨¡å¼è½¬å˜ä¸ºæ€§èƒ½å¯¼å‘ã€‚è¿™æ˜¯å› ä¸ºè¶Šæ¥è¶Šå¤šçš„ä¼ä¸šç”¨æˆ·å°†ä»–ä»¬çš„ä¸šåŠ¡è½¬ç§»åˆ°äº†é˜¿é‡Œäº‘å¹¶ä¸”ä»–ä»¬å¯¹å­˜å‚¨æ€§èƒ½çš„å»¶è¿Ÿå’Œæ€§èƒ½æœ‰å¾ˆä¸¥æ ¼çš„è¦æ±‚ã€‚è¿™åœ¨COVID-19ç–«æƒ…çˆ†å‘ä¹‹åå˜å¾—è¶Šæ¥è¶Šå¿«ï¼Œä¸ºäº†é€‚åº”è¿™ä¸€å•†ä¸šæ¨¡å¼è½¬å˜å’Œæ—¥ç›Šå¢é•¿çš„ç”¨æˆ·ï¼Œç›˜å¤2.0éœ€è¦ç»§ç»­å‡çº§åŸºç¡€è®¾æ–½ã€‚&lt;/p&gt;
&lt;p&gt;ç”¨åŸæœ‰çš„æœåŠ¡å™¨å’Œäº¤æ¢æœºæ²¿ç€åŸºäºCLOSæ¶æ„çš„æ‹“æ‰‘ç»“æ„æ¥å¯¹åŸºç¡€è®¾æ–½è¿›è¡Œæ‰©å®¹æ˜¯ä¸ç»æµçš„ï¼ŒåŒ…æ‹¬é«˜æ˜‚çš„æ€»æˆæœ¬ï¼ˆæœºæ¶ç©ºé—´ã€ç”µåŠ›ã€æ•£çƒ­ã€äººåŠ›æˆæœ¬ï¼‰å’Œæ›´é«˜çš„ç¢³æ’æ”¾/ç¯å¢ƒé—®é¢˜ã€‚å› æ­¤ï¼Œç›˜å¤å¼€å‘æ¥å®¤å†…é«˜å®¹é‡å­˜å‚¨æœåŠ¡å™¨ï¼ˆæ¯ä¸ªæœåŠ¡å™¨96TB SSDï¼‰å¹¶ä¸”å‡çº§åˆ°äº†25Gbps-100Gbpsçš„ç½‘ç»œå¸¦å®½ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†å®Œå…¨è·å¾—è¿™äº›å‡çº§å¸¦æ¥çš„æ€§èƒ½æå‡ï¼Œç›˜å¤2.0æå‡ºäº†ä¸€ç³»åˆ—çš„æŠ€æœ¯æ¥å¤„ç†åœ¨{ç½‘ç»œ/å†…å­˜/CPU}çš„æ€§èƒ½ç“¶é¢ˆå¹¶å……åˆ†åˆ©ç”¨å…¶å¼ºå¤§çš„ç¡¬ä»¶èµ„æºã€‚å…·ä½“æ¥è¯´ï¼Œç›˜å¤2.0é€šè¿‡å‡å°‘ç½‘ç»œæµé‡æ”¾å¤§ç‡å’ŒåŠ¨æ€è°ƒæ•´ä¸åŒæµé‡çš„ä¼˜å…ˆçº§æ¥ä¼˜åŒ–ç½‘ç»œå¸¦å®½ï¼›é€šè¿‡æå‡ºRemote Direct Cache Access(RDCA)æ¥å¤„ç†å†…å­˜ç“¶é¢ˆï¼›é€šè¿‡æ¶ˆé™¤æ•°æ®åºåˆ—åŒ–/ååºåˆ—åŒ–çš„å¼€é”€å¹¶å¼•å…¥CPUç­‰å¾…æŒ‡ä»¤æ¥åŒæ­¥è¶…çº¿ç¨‹ï¼Œä»¥æ­¤æ¥è§£å†³CPUç“¶é¢ˆé—®é¢˜ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç”Ÿäº§ä¸­çš„é«˜æ€§èƒ½&#34;&gt;ç”Ÿäº§ä¸­çš„é«˜æ€§èƒ½&lt;/h2&gt;
&lt;p&gt;ç›˜å¤2.0æˆåŠŸæ”¯æŒäº†elastic SSD blockå­˜å‚¨æœåŠ¡ï¼Œå¹¶å¯è¾¾åˆ°100usçº§åˆ«çš„I/Oå»¶è¿Ÿå’Œ1Mçš„IOPSã€‚åœ¨2018å¹´åŒåä¸€æ´»åŠ¨ï¼Œç›˜å¤2.0åŠ æŒä¸‹çš„é˜¿é‡Œæ•°æ®åº“å®ç°äº†280usçš„å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºOTSå­˜å‚¨æœåŠ¡ï¼ŒåŒæ ·çš„ç¡¬ä»¶æ¡ä»¶ä¸‹ã€‚ç›˜å¤2.0çš„I/Oå»¶è¿Ÿæ¯”ç›˜å¤1.0é™ä½äº†ä¸€ä¸ªæ•°é‡çº§ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºå†™æ•æ„Ÿçš„æœåŠ¡ï¼ˆEBSäº‘ç›˜ï¼‰ï¼ŒP999 I/Oå»¶è¿Ÿä½äº1msã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºè¯»æ•æ„Ÿçš„æœåŠ¡ï¼ˆåœ¨çº¿æœç´¢ï¼‰ï¼ŒP999 I/Oå»¶è¿Ÿä½äº11msã€‚&lt;/p&gt;
&lt;p&gt;åœ¨ç¬¬äºŒé˜¶æ®µï¼Œé€šè¿‡å°†2x25Gbpså¸¦å®½å‡çº§åˆ°2x100Gbpsï¼Œå¹¶è§£å†³äº†ç½‘ç»œã€å†…å­˜ã€CPUç“¶é¢ˆï¼Œæ¯å°æ³°å±±å­˜å‚¨æœåŠ¡å™¨çš„æœ‰æ•ˆååé‡å¢åŠ äº†6.1å€ã€‚&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Elastic SSD Block/EBSäº‘ç›˜ï¼šæ˜¯ä¸ºé˜¿é‡Œäº‘ä¸ºäº‘æœåŠ¡å™¨ECSæä¾›çš„ä½æ—¶å»¶ã€æŒä¹…æ€§ã€é«˜å¯é çš„å—çº§éšæœºå­˜å‚¨ã€‚å—å­˜å‚¨æ”¯æŒåœ¨å¯ç”¨åŒºå†…è‡ªåŠ¨å¤åˆ¶ç”¨æˆ·çš„æ•°æ®ï¼Œé˜²æ­¢æ„å¤–ç¡¬ä»¶æ•…éšœå¯¼è‡´çš„æ•°æ®ä¸å¯ç”¨ï¼Œä¿æŠ¤ä¸šåŠ¡å…äºç¡¬ä»¶æ•…éšœçš„å¨èƒã€‚&lt;/p&gt;
&lt;p&gt;OTSï¼šOpen Table Serviceï¼Œå·²æ›´åTable Storeï¼Œæ˜¯æ„å»ºåœ¨é˜¿é‡Œäº‘é£å¤©åˆ†å¸ƒå¼ç³»ç»Ÿä¹‹ä¸Šçš„NoSQLæ•°æ®åº“æœåŠ¡ï¼Œæä¾›æµ·é‡ç»“æ„åŒ–æ•°æ®çš„å­˜å‚¨å’Œå®æ—¶è®¿é—®ã€‚Table Storeä»¥å®ä¾‹å’Œè¡¨çš„å½¢å¼ç»„ç»‡æ•°æ®ï¼Œé€šè¿‡æ•°æ®åˆ†ç‰‡å’Œè´Ÿè½½å‡è¡¡æŠ€æœ¯ï¼Œå®ç°è§„æ¨¡ä¸Šçš„æ— ç¼æ‰©å±•ã€‚&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h1 id=&#34;0x01-bg&#34;&gt;0x01 Bg&lt;/h1&gt;
&lt;h2 id=&#34;overview&#34;&gt;Overview&lt;/h2&gt;
&lt;p&gt;ç›˜å¤æ˜¯å¤§è§„æ¨¡åˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿï¼Œç”±ï¼šç›˜å¤æ ¸å¿ƒï¼Œç›˜å¤æœåŠ¡å±‚ï¼Œç›˜å¤ç›‘æ§ç³»ç»Ÿç»„æˆï¼ˆFigure 1ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.ipandai.club/img/image-20230303140052844.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20230303140052844&#34;
	
	
&gt;&lt;/p&gt;
&lt;h3 id=&#34;ç›˜å¤core&#34;&gt;ç›˜å¤Core&lt;/h3&gt;
&lt;p&gt;ç›˜å¤æ ¸å¿ƒç”±ï¼šclientsï¼Œmastersï¼Œchunk seversç»„æˆï¼Œæä¾›è¿½åŠ å†™å…¥çš„å­˜å‚¨è¯­ä¹‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Client&lt;/strong&gt;æä¾›è®¿é—®ç›˜å¤äº‘å­˜å‚¨æœåŠ¡ï¼ˆEBSï¼ŒOSSï¼‰çš„SDKï¼Œå¹¶è´Ÿè´£æ¥æ”¶ä»æœåŠ¡ç«¯å‘é€çš„æ–‡ä»¶è¯·æ±‚ï¼Œä¸masterså’Œchunk serversé€šä¿¡æ¥å®ç°è¿™äº›è¯·æ±‚ã€‚ç±»ä¼¼äºå…¶ä»–åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿï¼ˆTectonicï¼ŒColossusï¼‰ï¼Œç›˜å¤ä¸­çš„Clientsè´Ÿè´£è¾ƒé‡çš„å·¥ä½œå¹¶åœ¨ç›˜å¤çš„å¤åˆ¶ç®¡ç†ã€SLAä¿éšœã€æ•°æ®ä¸€è‡´æ€§ç®¡ç†ä¸­æ‰®æ¼”å…³é”®è§’è‰²ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Master&lt;/strong&gt;ç®¡ç†ç›˜å¤ä¸­çš„æ‰€æœ‰å…ƒæ•°æ®å¹¶ä½¿ç”¨åŸºäºRaftçš„åè®®æ¥ç»´æŠ¤å…ƒæ•°æ®çš„åˆ†å¸ƒå¼ä¸€è‡´æ€§ã€‚ä¸ºäº†æ›´å¥½çš„æ°´å¹³æ‰©å±•æ€§å’Œå»¶ä¼¸æ€§ï¼ˆå¤§é‡çš„æ–‡ä»¶æ•°ï¼‰ï¼Œç›˜å¤masteråˆ†è§£å…ƒæ•°æ®æœåŠ¡ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼šnamespaceæœåŠ¡å’Œstream metaæœåŠ¡ï¼Œstreamæ˜¯ä¸€ç»„chunkçš„æŠ½è±¡ã€‚è¿™ä¸¤ä¸ªæœåŠ¡é¦–å…ˆæ ¹æ®ç›®å½•æ ‘åˆ†éš”å…ƒæ•°æ®æ¥å®ç°å±€éƒ¨åŸæ•°æ®ï¼Œç„¶åé€šè¿‡å“ˆå¸Œå°†è¿™äº›streamè¿›ä¸€æ­¥åˆ†éš”ä»¥è¾¾åˆ°è´Ÿè½½å‡è¡¡ã€‚namespaceæœåŠ¡æä¾›æ–‡ä»¶çš„ä¿¡æ¯ï¼ˆç›®å½•æ ‘å’Œå‘½åç©ºé—´ï¼‰ï¼Œstreamå…ƒæ•°æ®æœåŠ¡æä¾›ä»æ–‡ä»¶åˆ°chunkçš„æ˜ å°„ï¼ˆchunkçš„ä½ç½®ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ChunkServers&lt;/strong&gt;ä»¥chunkå­˜å‚¨æ•°æ®å¹¶é…å¤‡æœ‰è‡ªå®šä¹‰çš„ç”¨æˆ·ç©ºé—´å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿï¼ˆUSSFSï¼‰ï¼ŒUSSFSä¸ºä¸åŒç¡¬ä»¶ï¼ˆSMRSTORE for HM-SMR drivesï¼‰æä¾›é«˜æ€§èƒ½ï¼Œè¿½åŠ å†™å…¥çš„å­˜å‚¨å¼•æ“ã€‚åœ¨ç›˜å¤2.0çš„ç¬¬ä¸€é˜¶æ®µï¼Œæ¯ä¸ªå­˜å‚¨åœ¨chunkserversçš„æ–‡ä»¶éƒ½æœ‰ä¸‰ä¸ªå†—ä½™ï¼Œç”±GCWorkerè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå¹¶ä½¿ç”¨ECï¼ˆErasure Codingï¼‰ç¼–ç æ¥å­˜å‚¨æ–‡ä»¶ã€‚åœ¨ç›˜å¤2.0çš„ç¬¬äºŒé˜¶æ®µï¼Œåœ¨å•†ä¸šæ¨¡å¼ä¸­ï¼Œä½¿ç”¨ECæ›¿æ¢3ä¸ªå†—ä½™çš„å­˜å‚¨æ–¹å¼æ¥å‡å°‘æµé‡æ”¾å¤§ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç›˜å¤service&#34;&gt;ç›˜å¤Service&lt;/h3&gt;
&lt;p&gt;ç›˜å¤æœåŠ¡å±‚æä¾›ä¼ ç»Ÿçš„äº‘å­˜å‚¨æœåŠ¡ï¼ˆEBSã€OSSã€NASï¼‰ï¼Œé€šè¿‡é¢ç›¸äº‘åŸç”Ÿçš„æ–‡ä»¶ç³»ç»Ÿï¼ˆFiscï¼‰æä¾›äº‘åŸç”Ÿå­˜å‚¨æœåŠ¡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç›˜å¤monitoring-system&#34;&gt;ç›˜å¤Monitoring System&lt;/h3&gt;
&lt;p&gt;Perseusä¸ºç›˜å¤æ ¸å¿ƒå’Œç›˜å¤æœåŠ¡æä¾›å®æ—¶ç›‘æ§å’Œäººå·¥æ™ºèƒ½è¾…åŠ©çš„æ ¹æœ¬åŸå› åˆ†ææœåŠ¡ã€‚ç›˜å¤Coreã€ç›˜å¤Serviceã€ç›˜å¤Monitoring Systemé€šè¿‡é«˜é€Ÿç½‘ç»œç›¸è¿ã€‚&lt;/p&gt;
&lt;h2 id=&#34;ç›˜å¤20çš„è®¾è®¡ç›®æ ‡&#34;&gt;ç›˜å¤2.0çš„è®¾è®¡ç›®æ ‡&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;ä½å»¶è¿Ÿï¼šç›˜å¤2.0è¦åˆ©ç”¨SSDå’ŒRDMAä½å»¶è¿Ÿçš„ç‰¹æ€§ï¼Œåœ¨è®¡ç®—-å­˜å‚¨åˆ†ç¦»æ¶æ„ä¸­å®ç°å¹³å‡100usçº§åˆ«I/Oå»¶è¿Ÿçš„æ€§èƒ½ç›®æ ‡ï¼Œå³ä½¿åœ¨ç½‘ç»œæµé‡æŠ–åŠ¨å’ŒæœåŠ¡å™¨æ•…éšœç­‰åŠ¨æ€ç¯å¢ƒä¸‹ï¼Œä¹Ÿèƒ½æä¾›æ¯«ç§’çº§åˆ« P999 SLAã€‚&lt;/li&gt;
&lt;li&gt;é«˜ååé‡ï¼šä½¿å­˜å‚¨æœåŠ¡å™¨çš„æœ‰æ•ˆååé‡æ¥è¿‘å…¶å®¹é‡ã€‚&lt;/li&gt;
&lt;li&gt;ä¸ºæ‰€æœ‰æœåŠ¡æä¾›ç»Ÿä¸€çš„é«˜æ€§èƒ½æ”¯æŒï¼šä¸ºè¿è¡Œåœ¨å…¶ä¸Šçš„æ‰€æœ‰ä¸šåŠ¡æä¾›ç»Ÿä¸€çš„é«˜æ€§èƒ½æ”¯æŒï¼Œä¾‹å¦‚åœ¨çº¿æœç´¢ã€æ•°æ®æµåˆ†æã€EBSã€OSSå’Œæ•°æ®åº“ã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;related-work&#34;&gt;Related Work&lt;/h2&gt;
&lt;p&gt;ç›®å‰æœ‰å¾ˆå¤šåˆ†å¸ƒå¼å­˜å‚¨ç³»ç»Ÿè¢«æå‡ºå’Œä½¿ç”¨&lt;/p&gt;
&lt;p&gt;å¼€æºï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://hadoop.apache.org/docs/r1.2.1/hdfs_design.htmll&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;HDFSï¼ˆHadoop FSï¼‰&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://ceph.com/en/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Cephï¼ˆRedhatï¼‰[OSDI&#39;06] Ceph: A Scalable, High-Performance Distributed File System&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;ç§æœ‰ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://pdos.csail.mit.edu/6.824/papers/gfs.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;GFSï¼ˆGoogleï¼‰[SOSP&#39;03] The Google File System&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://www.usenix.org/conference/fast21/presentation/pan&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Tectonic (FaceBook)[FAST&#39;21] Facebookâ€™s Tectonic Filesystem: Efficiency from Exascale&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a class=&#34;link&#34; href=&#34;https://aws.amazon.com/products/storage/&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;AWS&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;é˜¿é‡Œå·´å·´çš„ç›˜å¤å›¢é˜Ÿåˆ†äº«è¿‡å¾ˆå¤šç›˜å¤çš„è®¾è®¡ç†å¿µï¼ŒåŒ…æ‹¬ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;RDMAå¤§å‹éƒ¨ç½²,&lt;a class=&#34;link&#34; href=&#34;https://www.usenix.org/system/files/nsdi21-gao.pdf&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[NSDI&#39;21] When Cloud Storage Meets RDMA&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;æ¨ªå‘æ‰©å±•äº‘å­˜å‚¨æœåŠ¡çš„Key-Valueé”®å€¼å­˜å‚¨å¼•æ“&lt;a class=&#34;link&#34; href=&#34;https://dl.acm.org/doi/abs/10.1145/3448016.3457553&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[SIGMOD&#39;21] A Key-Value Engine for Scalable Cloud Storage Services&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;EBSå­˜å‚¨æœåŠ¡çš„ç½‘ç»œå’Œå­˜å‚¨è½¯ä»¶æ ˆååŒè®¾è®¡&lt;a class=&#34;link&#34; href=&#34;https://dl.acm.org/doi/abs/10.1145/3544216.3544238&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[SIGCOMM&#39;22] From Luna to Solar: the Evolu- tions of the Compute-to-Storage Networks in Alibaba Cloud&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;namespaceå…ƒæ•°æ®æœåŠ¡çš„å…³é”®è®¾è®¡&lt;a class=&#34;link&#34; href=&#34;https://www.usenix.org/conference/fast22/presentation/lv&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;[FAST&#39;22] InfiniFS: An Efficient Metadata Service for Large-Scale Distributed Filesystems&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;0x02-phase-one-embracing-ssd-and-rdma&#34;&gt;0x02 Phase One: Embracing SSD and RDMA&lt;/h1&gt;
&lt;p&gt;ç›¸è¾ƒäºHDDå’ŒTCPï¼ŒSSDå’ŒRDMAæŠ€æœ¯æ˜¾è‘—é™ä½äº†I/Oå»¶è¿Ÿå’Œç½‘ç»œé—®é¢˜ã€‚&lt;/p&gt;
&lt;p&gt;ç›˜å¤é€šè¿‡å¼€å‘ç”¨æˆ·ç©ºé—´å­˜å‚¨æ“ä½œç³»ç»Ÿå¹¶æå‡ºä¸€äº›æ–‡ä»¶ç³»ç»Ÿçš„è®¾è®¡æ¥å®ç°é«˜ååé‡ã€100usçº§åˆ«I/Oå»¶è¿Ÿçš„é«˜IOPSæ€§èƒ½ã€‚åŒæ—¶æä¾›äº†æ–°çš„æœºåˆ¶æ¥ä¿éšœSLAã€‚&lt;/p&gt;
&lt;h2 id=&#34;append-only-file-system&#34;&gt;Append-Only File System&lt;/h2&gt;
&lt;p&gt;ç›˜å¤æå‡ºäº†ç»Ÿä¸€ã€è¿½åŠ å†™å…¥çš„æŒä¹…å±‚ï¼Œé€šè¿‡åä¸ºFlatLogFileçš„è¿½åŠ å†™å…¥æ¥å£æ¥ç®€åŒ–æ¶æ„ã€‚FlatLogFileå…·æœ‰é«˜ååé‡å’Œä½å»¶è¿Ÿã€‚åŸºäºFlatLogFileï¼Œç›˜å¤é‡‡ç”¨è¿½åŠ å†™å…¥çš„chunkï¼Œå¹¶ä½¿ç”¨ç‹¬ç«‹chunkå¸ƒå±€æ¥ç®¡ç†chunkserverä¸­çš„chunk&lt;/p&gt;
&lt;h3 id=&#34;unified-append-only-persistence-layer&#34;&gt;Unified, Append-Only Persistence Layer&lt;/h3&gt;
&lt;p&gt;ç›˜å¤çš„æŒä¹…åŒ–å±‚ä¸ºå­˜å‚¨æœåŠ¡æä¾›æ¥å£ã€‚åœ¨æ—©æœŸå¼€å‘é˜¶æ®µï¼Œä¸åŒçš„å­˜å‚¨æœåŠ¡ä¼šä½¿ç”¨ä¸åŒçš„æ¥å£ï¼Œä¾‹å¦‚LogFileæ¥å£æœåŠ¡äºä½å»¶è¿Ÿçš„NASæœåŠ¡ï¼ŒTempFileæ¥å£æœåŠ¡äºé«˜ååé‡çš„å¤§å‹è®¡ç®—æ•°æ®åˆ†ææœåŠ¡ã€‚ç„¶è€Œï¼Œè¿™ç§è®¾è®¡ä½¿å¼€å‘å’Œç®¡ç†éå¸¸å¤æ‚ã€‚æ¯ä¸ªæ¥å£éƒ½éœ€è¦æœ‰äººå¼€å‘å’Œç»´æŠ¤ï¼ŒäººåŠ›æˆæœ¬é«˜åˆ‡å®¹æ˜“å‡ºé”™ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤ï¼Œéœ€è¦ç®€åŒ–å¼€å‘ç®¡ç†è¿‡ç¨‹ï¼Œè¿˜è¦å¼•å…¥ä½å»¶è¿Ÿçš„SSDï¼Œå—åˆ°è®¡ç®—æœºç½‘ç»œåˆ†å±‚æ¶æ„çš„å¯å‘ï¼Œç›˜å¤æå‡ºäº†ç»Ÿä¸€çš„æ–‡ä»¶ç±»å‹ï¼šFlatLogFileï¼ˆFigure 2ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.ipandai.club/img/image-20230303201714075.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20230303201714075&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;FlatLogFileä»…æ”¯æŒè¿½åŠ å†™å…¥ï¼Œä¸Šå±‚æœåŠ¡ï¼ˆOSSï¼‰å¯ä»¥å¯ä»¥ä½¿ç”¨ç±»ä¼¼é”®å€¼çš„æ˜ å°„æ¥æ›´æ–°æ•°æ®ï¼Œå¹¶ä½¿ç”¨åƒåœ¾æ”¶é›†æœºåˆ¶æ¥å‹ç¼©å†å²æ•°æ®ã€‚FlatLogFileä¸ºå­˜å‚¨æœåŠ¡æä¾›ç®€å•ã€ç»Ÿä¸€çš„æ¥å£æ“ä½œæ•°æ®ã€‚ç›˜å¤çš„å¼€å‘è€…å¿…é¡»ä¿è¯æ•°æ®æ“ä½œéƒ½æ˜¯é€šè¿‡FlatLogFileï¼Œå°¤å…¶æ˜¯å†™å…¥æ“ä½œï¼Œå¯ä»¥é«˜æ•ˆå¹¶å¯é çš„åœ¨å­˜å‚¨ä»‹è´¨ä¸Šæ‰§è¡Œã€‚å› æ­¤ï¼Œå­˜å‚¨æœåŠ¡çš„ä»»ä½•å‡çº§å’Œæ”¹å˜å¯¹äºå¼€å‘è€…è€Œè¨€éƒ½æ˜¯é€æ˜çš„ï¼Œç®€åŒ–äº†å¼€å‘å’Œç®¡ç†ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨åº•å±‚ï¼Œå›¢é˜Ÿè§‚å¯Ÿåˆ°SSDç”±äºå…¶è‡ªèº«çš„å­˜å‚¨å•å…ƒå’Œé—ªå­˜äº‹åŠ¡å±‚çš„ç‰¹æ€§ï¼Œå¯ä»¥åœ¨é¡ºåºæ“ä½œä¸Šè·å¾—è¾ƒé«˜çš„ååé‡å’ŒIOPSã€‚ä¸ºäº†ä¿è¯é€šè¿‡FlatLogFileè¿›è¡Œçš„æ•°æ®æ“ä½œèƒ½å¤Ÿåœ¨SSDä¸Šé«˜æ•ˆåœ°æ‰§è¡Œï¼Œæˆ‘ä»¬å°†FlatLogFileä¸Šçš„é¡ºåºæ“ä½œå¯¹é½ä»¥å®ç°é«˜æ€§èƒ½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;heavy-weight-client&#34;&gt;Heavy weight Client&lt;/h3&gt;
&lt;p&gt;è„æ´»ç´¯æ´»éƒ½æ˜¯Clientæ¥å¹²ã€‚Clientè´Ÿè´£ä¸chunkserversä¸€èµ·è¿›è¡Œæ•°æ®æ“ä½œï¼Œä¸masterä¸€èµ·è¿›è¡Œå…ƒæ•°æ®ä¿¡æ¯çš„æ£€ç´¢å’Œæ›´æ–°ã€‚åœ¨ä»mastersè·å–chunkä¿¡æ¯åï¼Œä¸€ä¸ªç›˜å¤Clientå°†è´Ÿè´£ç›¸åº”çš„å¤åˆ¶åè®®å’ŒECåè®®ã€‚Clientæœ‰é‡è¯•æœºåˆ¶ï¼ˆå¤‡ä»½è¯»å–Â¥3.3ï¼‰æ¥å¤„ç†æ„å¤–çš„æ€§èƒ½æŠ–åŠ¨ï¼ˆä¸¢åŒ…ï¼‰æ¥ä¿éšœI/O SLAã€‚&lt;/p&gt;
&lt;p&gt;Clientè¿˜æœ‰æ¢æµ‹æœºåˆ¶ï¼Œå®šæœŸä»mastersè·å–æœ€æ–°çš„ chunkserver çŠ¶æ€ï¼Œå¹¶è¯„ä¼° chunkserver çš„æœåŠ¡è´¨é‡ã€‚ç±»ä¼¼äºFacebook Tectonic FSçš„clientï¼Œç›˜å¤çš„Clientå¯ä»¥é€‰æ‹©åˆé€‚çš„è¯»å†™å‚æ•°æ¥å¤„ç†å…·ä½“çš„å­˜å‚¨æœåŠ¡æŒ‡ä»¤ï¼ˆEBS/OSSï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;append-only-chunk-management&#34;&gt;Append-Only Chunk Management&lt;/h3&gt;
&lt;p&gt;ä¼ ç»Ÿçš„æ–‡ä»¶ç³»ç»Ÿåœ¨å†™å…¥æ–‡ä»¶æ—¶ï¼ŒåŒæ—¶åˆ†ç¦»å†™å…¥æ–‡ä»¶çš„å…ƒæ•°æ®ï¼Œäº§ç”Ÿä¸¤æ¬¡SSDçš„å†™æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†é™ä½å»¶è¿Ÿå’Œå»¶é•¿SSDå¯¿å‘½ï¼Œç›˜å¤åŸºäºFlatLogFileçš„append-onlyè¯­ä¹‰ï¼Œé€‰æ‹©ä»¥chunkä¸ºå•ä½å­˜å‚¨æ–‡ä»¶ï¼Œè€Œéblockï¼Œchunkå­˜å‚¨åœ¨chunkseverä¸­ï¼Œå¹¶æœ‰ç‹¬ç«‹çš„å¸ƒå±€ï¼Œæ¯ä¸ªchunkéƒ½ä¿å­˜äº†è‡ªå·±çš„æ•°æ®å’Œå…ƒæ•°æ®ä¿¡æ¯ã€‚&lt;/p&gt;
&lt;p&gt;chunkåªéœ€è¦ä¸€æ¬¡æ“ä½œå°±å¯ä»¥è¢«å†™å…¥åˆ°å­˜å‚¨ä»‹è´¨ä¸­ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘å†™å…¥å»¶è¿Ÿå’Œå­˜å‚¨ä»‹è´¨çš„å¯¿å‘½ã€‚&lt;/p&gt;
&lt;p&gt;Figure 3æ˜¯chunkçš„å¸ƒå±€ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.ipandai.club/img/image-20230304141646186.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20230304141646186&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªchunkåŒ…å«å¤šä¸ªéƒ¨åˆ†ï¼Œæ¯ä¸ªéƒ¨åˆ†åŒ…å«ä¸‰ä¸ªå…ƒç´ ï¼šdataã€paddingã€footerã€‚&lt;/p&gt;
&lt;p&gt;footerä¿å­˜äº†chunkçš„å…ƒæ•°æ®ï¼Œä¾‹å¦‚chunk IDã€chunk é•¿åº¦ã€CRCæ ¡éªŒå’Œã€‚&lt;/p&gt;
&lt;p&gt;ç‹¬ç«‹çš„chunkå¸ƒå±€ä¹Ÿä½¿å¾—chunkserverå¯ä»¥æ‰§è¡Œè¿›è¡Œçº é”™æ¢å¤ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªclientè¿ç»­å†™å…¥chunkåˆ°å­˜å‚¨è®¾å¤‡æ—¶ï¼Œchunkserveråœ¨å†…å­˜ä¸­å­˜å‚¨è¿™äº›chunkçš„å…ƒæ•°æ®ï¼Œå¹¶ä¸”å‘¨æœŸæ€§åœ°å°†è¿™äº›ä¿¡æ¯çš„æ£€æŸ¥ç‚¹ä¼ é€’ç»™å­˜å‚¨è®¾å¤‡ã€‚å½“å‘ç”Ÿé”™è¯¯å¯¼è‡´ä¸€äº›ä¸èƒ½å®Œæˆçš„å†™å…¥æ“ä½œæ—¶ï¼Œchunkserverä¼šåŠ è½½æ£€æŸ¥ç‚¹ä¸­çš„å…ƒæ•°æ®å¹¶ä¸”å’Œchunkä¸­çš„å…ƒæ•°æ®è¿›è¡Œæ¯”è¾ƒï¼Œå¦‚æœäºŒè€…ä¸åŒï¼Œchunkserverä¼šæ£€æŸ¥Chunkçš„CRCæ¥è¿›è¡Œæ¢å¤ã€‚&lt;/p&gt;
&lt;h3 id=&#34;metadata-operation-optimization-å…ƒæ•°æ®æ“ä½œä¼˜åŒ–&#34;&gt;Metadata Operation Optimization å…ƒæ•°æ®æ“ä½œä¼˜åŒ–&lt;/h3&gt;
&lt;p&gt;ç›˜å¤çš„Masteræä¾›ä¸¤ç§å…ƒæ•°æ®æœåŠ¡ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;namespaceï¼šè´Ÿè´£ç›®å½•æ ‘å’Œæ–‡ä»¶ç®¡ç†&lt;/li&gt;
&lt;li&gt;Streamï¼šè´Ÿè´£chunkä¿¡æ¯çš„ç»´æŠ¤&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Streamå†…åŒ…å«ä¸€ç»„chunkï¼ŒåŒä¸€ä¸ªStreamä¸­çš„chunkä¿å­˜åœ¨ä¸€ä¸ªæ–‡ä»¶ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;è¿™ä¸¤ä¸ªæœåŠ¡éƒ½æ˜¯ç”¨äº†åˆ†å¸ƒå¼æ¶æ„æ¥ä¿è¯æ›´å¥½çš„ä¼¸ç¼©æ€§ã€‚&lt;/p&gt;
&lt;p&gt;ä»–ä»¬æ ¹æ®å…ƒæ•°æ®å±€éƒ¨æ€§å’Œè´Ÿè½½å‡è¡¡å¯¹å…ƒæ•°æ®è¿›è¡Œåˆ’åˆ†ï¼ˆå…ˆæ ¹æ®ç›®å½•æ ‘åˆ’åˆ†ï¼Œå†è¿›è¡Œå“ˆå¸Œï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;åŒæ—¶è¿˜ç”¨å¤šç§æœºåˆ¶æ¥ä¼˜åŒ–å…ƒæ•°æ®æ“ä½œçš„é«˜æ•ˆæ€§ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å¹¶è¡Œçš„å…ƒæ•°æ®å¤„ç†&#34;&gt;å¹¶è¡Œçš„å…ƒæ•°æ®å¤„ç†&lt;/h4&gt;
&lt;p&gt;namespaceå’Œstreaméƒ½ä½¿ç”¨å¹¶è¡Œå¤„ç†ï¼ˆInfiniFSï¼‰æ¥å®ç°å…ƒæ•°æ®çš„ä½å»¶è¿Ÿè®¿é—®ã€‚&lt;/p&gt;
&lt;p&gt;ç›˜å¤ä½¿ç”¨å“ˆå¸Œç®—æ³•æ¥æ˜ å°„å…³è”æ€§å¼ºçš„å…ƒæ•°æ®åˆ°ä¸åŒçš„å…ƒæ•°æ®æœåŠ¡å™¨ä¸­ã€‚ä½¿ç”¨ä¸€ç§æ–°çš„æ•°æ®ç»“æ„ï¼Œæ”¯æŒå¯é¢„æµ‹çš„ç›®å½•IDï¼Œå¹¶å…è®¸Clienté«˜æ•ˆåœ°å¹³è¡Œæ‰§è¡Œè·¯å¾„è§£æã€‚åŒæ—¶è¿˜å¼•å…¥äº†å‡ ç§åŠ é€ŸClientä»StreamæœåŠ¡ä¸­æ£€ç´¢chunkä¿¡æ¯çš„æŠ€æœ¯ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å¯å˜é•¿åº¦çš„chunk&#34;&gt;å¯å˜é•¿åº¦çš„chunk&lt;/h4&gt;
&lt;p&gt;ç›˜å¤2.0é‡‡ç”¨å¤§chunkï¼Œæœ‰ä¸‰ä¸ªå¥½å¤„ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å‡å°‘äº†å…ƒæ•°æ®çš„æ•°é‡&lt;/li&gt;
&lt;li&gt;é¿å…äº†Clienté¢‘ç¹è¯·æ±‚chunkäº§ç”Ÿçš„I/Oå»¶è¿Ÿ&lt;/li&gt;
&lt;li&gt;æé«˜äº†SSDçš„å¯¿å‘½&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;å¦‚æœä»…ä»…æé«˜chunk sizeä¼šæœ‰ç¢ç‰‡çš„é£é™©ï¼Œå› æ­¤é‡‡ç”¨äº†å¯å˜é•¿åº¦çš„chunkï¼ˆä»1MBåˆ°2GBï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚EBSæœåŠ¡çš„chunk sizeçš„95%åˆ†ä½æ•°ä¸º64MBï¼Œ99%åˆ†ä½æ•°ä¸º286.4MBã€‚&lt;/p&gt;
&lt;h4 id=&#34;åœ¨clientä¸­ç¼“å­˜chunkä¿¡æ¯&#34;&gt;åœ¨Clientä¸­ç¼“å­˜chunkä¿¡æ¯&lt;/h4&gt;
&lt;p&gt;æ¯ä¸ªclientç»´æŠ¤äº†ä¸€ä¸ªæœ¬åœ°çš„å…ƒæ•°æ®ç¼“å­˜æ± ï¼Œæ¥å‡å°‘å…ƒæ•°æ®çš„è¯·æ±‚æ¬¡æ•°ã€‚ç¼“å­˜æ± é€šè¿‡LRUè¿›è¡Œç»´æŠ¤ã€‚&lt;/p&gt;
&lt;p&gt;å½“ä¸€ä¸ªç¨‹åºæƒ³è®¿é—®æ•°æ®æ—¶ï¼Œclienté¦–å…ˆè®¿é—®å…ƒæ•°æ®ç¼“å­˜ï¼Œå½“ç¼“å­˜æ²¡æœ‰å‘½ä¸­æ—¶å°†å‘èµ·å¯¹masterçš„è¯·æ±‚ï¼Œå½“ç¼“å­˜å‘½ä¸­æ—¶ï¼Œå“åº”è¯·æ±‚æ—¶ï¼Œå¯¹åº”çš„chunkserverä¼šé€šçŸ¥clientå…¶å…ƒæ•°æ®å·²ç»è¿‡æœŸï¼ˆç”±äºå‰¯æœ¬è¿ç§»ï¼‰ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ‰¹å¤„ç†chunkä¿¡æ¯è¯·æ±‚&#34;&gt;æ‰¹å¤„ç†chunkä¿¡æ¯è¯·æ±‚&lt;/h4&gt;
&lt;p&gt;æ¯ä¸ªclientåœ¨çŸ­æ—¶é—´å†…æ±‡æ€»å¤šä¸ªchunkè¯·æ±‚ï¼Œå¹¶å°†å…¶æ‰¹é‡å‘é€ç»™masterï¼Œæ¥æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚ä¸»ç«™å¹¶è¡Œå¤„ç†æˆæ‰¹çš„è¯·æ±‚ï¼Œæ±‡æ€»ç»“æœå¹¶å°†å…¶å‘å›ç»™clientã€‚clientå¯¹ç»“æœè¿›è¡Œåˆ†è§£ï¼Œå¹¶å°†å…¶åˆ†é…ç»™ç›¸åº”çš„åº”ç”¨ç¨‹åºã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ¨æµ‹chunkä¿¡æ¯è¿›è¡Œé¢„å–&#34;&gt;æ¨æµ‹chunkä¿¡æ¯è¿›è¡Œé¢„å–&lt;/h4&gt;
&lt;p&gt;è®¾è®¡äº†ä¸€ä¸ªåŸºäºè´ªå¿ƒå’Œç»Ÿè®¡å­¦çš„é¢„å–æœºåˆ¶æ¥å‡å°‘chunkä¿¡æ¯çš„è¯·æ±‚ã€‚&lt;/p&gt;
&lt;p&gt;å½“masterèŠ‚ç‚¹æ”¶åˆ°äº†æ¥è‡ªclientçš„è¯»è¯·æ±‚æ—¶ï¼Œmasterå°†è¿”å›æœ‰å…³çš„chunkå…ƒæ•°æ®å’Œå…¶ä»–chunkçš„å…ƒæ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;å½“masteræ”¶åˆ°å†™å…¥è¯·æ±‚æ—¶ï¼Œmasterå°†è¿”å›å¤šä¸ªchunkï¼Œè¶…å‡ºclientçš„è¯·æ±‚æ•°é‡ã€‚&lt;/p&gt;
&lt;p&gt;clientå› æ­¤å¯ä»¥åœ¨ä¸è¯·æ±‚å—çš„æƒ…å†µä¸‹åˆ‡æ¢å—ã€‚&lt;/p&gt;
&lt;h4 id=&#34;æ•°æ®æå¸¦å‡å°‘å¾€è¿”æ—¶å»¶&#34;&gt;æ•°æ®æå¸¦å‡å°‘å¾€è¿”æ—¶å»¶&lt;/h4&gt;
&lt;p&gt;å—åˆ°äº†QUICå’ŒHTTP3çš„å¯å‘ï¼Œä½¿ç”¨æ•°æ®æå¸¦æ¥æ”¹å–„å†™å…¥å»¶è¿Ÿï¼Œåœ¨clientä»masteræ£€ç´¢åˆ°chunkåœ°å€åï¼Œä»–å°†chunkåˆ›å»ºè¯·æ±‚å’Œæ•°æ®å†™å…¥è¯·æ±‚åˆå¹¶ä¸ºä¸€ä¸ªè¯·æ±‚ï¼Œç„¶åå‘é€ç»™chunkserverã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤å¯ä»¥å‡å°‘ä¸€ä¸ªRTTã€‚ï¼ˆä½†æ˜¯å½“ä¸ªRTTé•¿äº†ï¼Œæ•°æ®åŒ…å¤§å°é—®é¢˜ï¼Ÿï¼‰&lt;/p&gt;
&lt;h2 id=&#34;chunkserver-ussos&#34;&gt;ChunkServer USSOS&lt;/h2&gt;
&lt;p&gt;chunkserverè´Ÿè´£æ‰§è¡Œæ‰€æœ‰çš„æ•°æ®æ“ä½œã€‚å› æ­¤ï¼Œç²¾å¿ƒè®¾è®¡è¿è¡Œæ—¶æ“ä½œç³»ç»Ÿä»¥ç¡®ä¿æ•°æ®æ“ä½œèƒ½ä»¥&lt;strong&gt;ä½å»¶è¿Ÿ&lt;/strong&gt;å’Œ&lt;strong&gt;é«˜ååé‡&lt;/strong&gt;å®Œæˆæ˜¯éå¸¸é‡è¦çš„ã€‚åœ¨æ–°å…´çš„é«˜é€Ÿç½‘ç»œæŠ€æœ¯å’Œå­˜å‚¨é¢†åŸŸï¼ŒåšæŒé€šè¿‡å†…æ ¸ç©ºé—´è¿›è¡Œæ•°æ®æ“ä½œçš„ä¼ ç»Ÿè®¾è®¡æ˜¯ä½æ•ˆçš„ã€‚è¿™ä¸ä»…ä¼šå¯¼è‡´é¢‘ç¹çš„ç³»ç»Ÿä¸­æ–­ï¼Œä»è€Œæ¶ˆè€—CPUèµ„æºï¼Œè€Œä¸”è¿˜ä¼šå¯¼è‡´ç”¨æˆ·ç©ºé—´å’Œå†…æ ¸ç©ºé—´ä¹‹é—´ä¸å¿…è¦çš„æ•°æ®é‡å¤ã€‚
ä¸ºäº†è§£å†³è¿™äº›é—®é¢˜ï¼Œç›˜å¤é‡‡ç”¨äº†kernel-bypassç»•è¿‡å†…æ ¸çš„è®¾è®¡ï¼Œä¸ºchunkserverå¼€å‘äº†ä¸€ä¸ªé«˜æ€§èƒ½çš„ç”¨æˆ·ç©ºé—´å­˜å‚¨æ“ä½œç³»ç»Ÿï¼Œå®ƒæä¾›äº†ä¸€ä¸ªç»Ÿä¸€çš„ç”¨æˆ·ç©ºé—´å­˜å‚¨è½¯ä»¶å¹³å°ã€‚é™¤äº†åœ¨USSOSä¸­å®ç°è®¾å¤‡ç®¡ç†å’ŒRTCè¿è¡Œåˆ°å®Œæˆçš„çº¿ç¨‹æ¨¡å‹ï¼Œç›˜å¤è¿˜å®ç°äº†ç”¨æˆ·çº§çš„å†…å­˜ç®¡ç†ï¼Œè½»é‡çº§çš„ç”¨æˆ·ç©ºé—´è°ƒåº¦ç­–ç•¥ï¼Œè¿˜ä¸ºSSDå®šåˆ¶äº†é«˜æ€§èƒ½append-onlyçš„ç”¨æˆ·ç©ºé—´å­˜å‚¨æ–‡ä»¶ç³»ç»Ÿï¼ˆUSSFSï¼‰ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ç”¨æˆ·çº§åˆ«å†…å­˜ç®¡ç†&#34;&gt;ç”¨æˆ·çº§åˆ«å†…å­˜ç®¡ç†&lt;/h3&gt;
&lt;p&gt;chunkserverçš„USSOSåŸºäºç°æœ‰çš„ç”¨æˆ·ç©ºé—´æŠ€æœ¯ï¼Œå¦‚ç½‘ç»œæ ˆä¸­çš„RDMAï¼Œå­˜å‚¨æ ˆä¸­çš„DPDKå’ŒSPDKã€‚ç›˜å¤å¯¹ç½‘ç»œæ ˆå’Œå­˜å‚¨æ ˆè¿›è¡Œäº†æ•´åˆï¼Œä»¥å‡å°‘å»¶è¿Ÿå¹¶å®ç°é«˜æ€§èƒ½çš„æ•°æ®æ“ä½œã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä½¿ç”¨RTCçº¿ç¨‹æ¨¡å‹ï¼Œåœ¨ä¼ ç»Ÿçš„æµæ°´çº¿pipelineçº¿ç¨‹æ¨¡å‹ä¸­ï¼Œä¸€ä¸ªè¯·æ±‚è¢«åˆ†è§£æˆå¤šä¸ªé˜¶æ®µï¼Œæ¯ä¸ªé˜¶æ®µè¿è¡Œåœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ã€‚ç›¸åï¼ŒUSSOSä¸­ä¸€ä¸ªè¯·æ±‚è‡ªå§‹è‡³ç»ˆéƒ½å¤„äºä¸€ä¸ªçº¿ç¨‹é‡Œï¼Œå‡å°‘äº†ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œçº¿ç¨‹é—´é€šä¿¡çš„å¼€é”€ã€‚&lt;/li&gt;
&lt;li&gt;çº¿ç¨‹è¯·æ±‚ä¸€ä¸ªå¤§é¡µå†…å­˜ç©ºé—´ç”¨ä½œç½‘ç»œæ ˆå’Œå­˜å‚¨æ ˆçš„å…±äº«å†…å­˜ã€‚ä»ç½‘ç»œä¸­æ¥å—çš„æ•°æ®å¯ä»¥é€šè¿‡RDMAå­˜å‚¨åœ¨å¤§é¡µå†…å­˜ç©ºé—´ä¸­ã€‚å‘é€å¤§é¡µå†…å­˜çš„å…ƒæ•°æ®ä¹‹åï¼ˆåœ°å€å’Œå¤§å°ï¼‰ï¼Œæ•°æ®å¯ä»¥ç›´æ¥é€šè¿‡SPDKä»å¤§é¡µå†…å­˜å†™å…¥åˆ°å­˜å‚¨è®¾å¤‡ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id=&#34;ç”¨æˆ·ç©ºé—´çš„è°ƒåº¦æœºåˆ¶&#34;&gt;ç”¨æˆ·ç©ºé—´çš„è°ƒåº¦æœºåˆ¶&lt;/h3&gt;
&lt;h4 id=&#34;é€šè¿‡é˜»å¡åç»­è¯·æ±‚é˜»æ­¢ä»»åŠ¡&#34;&gt;é€šè¿‡é˜»å¡åç»­è¯·æ±‚é˜»æ­¢ä»»åŠ¡&lt;/h4&gt;
&lt;p&gt;æ¯ä¸ªchunkserveréƒ½æœ‰å›ºå®šæ•°é‡çš„çº¿ç¨‹ã€‚&lt;/p&gt;
&lt;p&gt;ä¸€ä¸ªæ–°çš„è¯·æ±‚é€šè¿‡å“ˆå¸Œæ˜ å°„è¢«ä¸‹å‘ç»™ä¸€ä¸ªworkingçº¿ç¨‹ã€‚è¢«å‘é€åˆ°åŒä¸€ä¸ªçº¿ç¨‹çš„è¯·æ±‚åŸºäºå…ˆåˆ°å…ˆæ‰§è¡ŒFIFSçš„æœºåˆ¶æ‰§è¡Œã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªè¯·æ±‚å ç”¨äº†å¤ªå¤šçš„æ—¶é—´ç‰‡ï¼ˆè¡¨æŸ¥è¯¢æœç´¢ï¼Œå†…å­˜ç”³è¯·ï¼‰ï¼Œå°†ä¼šé˜»å¡å…¶ä»–ä»»åŠ¡ã€‚&lt;/p&gt;
&lt;p&gt;é’ˆå¯¹ä¸åŒåœºæ™¯ä½¿ç”¨ä¸åŒçš„è°ƒåº¦ç­–ç•¥ï¼š&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;å¯¹äºè´Ÿè½½è¾ƒé«˜çš„ä»»åŠ¡ï¼Œä½¿ç”¨å¿ƒè·³æœºåˆ¶æ¥ç›‘æ§ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ï¼Œå¹¶è®¾ç½®å‘Šè­¦ã€‚å¦‚æœä»»åŠ¡è¶…å‡ºäº†è§„å®šæ—¶é—´ç‰‡ï¼Œä¼šå°†å…¶ä¸‹å‘åˆ°åå°çº¿ç¨‹è¿›è¡Œæ‰§è¡Œã€‚&lt;/li&gt;
&lt;li&gt;å¯¹äºç³»ç»Ÿäº§ç”Ÿçš„è´Ÿè½½ï¼Œç›˜å¤ä½¿ç”¨TCMallocï¼ˆThread Cached Mallocï¼‰ç¼“å­˜æ¥å…è®¸åœ¨ç¼“å­˜ä¸­æ‰§è¡Œé«˜é¢‘ç‡çš„æ“ä½œã€‚&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&#34;ä¼˜å…ˆçº§è°ƒåº¦ä¿éšœé«˜qos&#34;&gt;ä¼˜å…ˆçº§è°ƒåº¦ä¿éšœé«˜QoS&lt;/h4&gt;
&lt;p&gt;ç›˜å¤å¯¹ä¸åŒè¯·æ±‚æ ‡æ³¨ä¸åŒçš„QoSæ ‡ç­¾ï¼ˆç”¨æˆ·è¯·æ±‚é«˜ä¼˜å…ˆçº§ï¼ŒGCè¯·æ±‚ä½ä¼˜å…ˆçº§ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;USSOSåˆ›å»ºäº†ä¸€ä¸ª&lt;strong&gt;ä¼˜å…ˆé˜Ÿåˆ—&lt;/strong&gt;ï¼Œé˜Ÿåˆ—ä¸­çš„ä»»åŠ¡æ ¹æ®QoSç›®æ ‡æ¥è¿›è¡Œè°ƒåº¦ã€‚ä»¥æ­¤æ¥é˜²æ­¢ä½QoSä»»åŠ¡è¿‡å¤šå¯¼è‡´é«˜QoSä¸èƒ½è¢«æŒ‰æ—¶å®Œæˆã€‚&lt;/p&gt;
&lt;h4 id=&#34;è½®è¯¢å’Œäº‹ä»¶é©±åŠ¨çš„åˆ‡æ¢napi&#34;&gt;è½®è¯¢å’Œäº‹ä»¶é©±åŠ¨çš„åˆ‡æ¢ï¼ˆNAPIï¼‰&lt;/h4&gt;
&lt;p&gt;ä¸ºäº†é˜²æ­¢é¢‘ç¹å‘èµ·ä¸­æ–­å¯¼è‡´é«˜CPUåˆ©ç”¨ç‡ï¼ŒUSSOSä½¿ç”¨åˆ‡æ¢æœºåˆ¶ã€‚&lt;/p&gt;
&lt;p&gt;NICï¼ˆNetwork Interface Controllerï¼Œç½‘å¡ï¼‰æä¾›äº†&lt;strong&gt;æ–‡ä»¶æè¿°ç¬¦fd&lt;/strong&gt;çš„ç›‘æ§ï¼ŒåŸºäºç›‘å¬æ•°æ®è¾¾åˆ°åçš„fdäº‹ä»¶ã€‚&lt;/p&gt;
&lt;p&gt;ç¨‹åºé»˜è®¤ä½¿ç”¨&lt;strong&gt;äº‹ä»¶é©±åŠ¨&lt;/strong&gt;ï¼Œå½“ç¨‹åºæ”¶åˆ°äº†NICçš„é€šçŸ¥ï¼Œå°†åˆ‡æ¢ä¸ºè½®è¯¢æ¨¡å¼ã€‚å¦‚æœç¨‹åºä¸€æ®µæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ä»»ä½•I/Oè¯·æ±‚ï¼Œå°†ä¼šåˆ‡æ¢ä¼šäº‹ä»¶é©±åŠ¨æ¨¡å¼å¹¶å‘ŠçŸ¥NICã€‚&lt;/p&gt;
&lt;h3 id=&#34;append-only-ussos&#34;&gt;Append Only USSOS&lt;/h3&gt;
&lt;p&gt;USSFSä½¿ç”¨ä¸€ç³»åˆ—åŸºäºchunkçš„æŒ‡ä»¤ï¼ˆopenï¼Œcloseï¼Œsealï¼Œformatç­‰ï¼‰ï¼Œæ”¯æŒappend-only writeã€‚&lt;/p&gt;
&lt;p&gt;æ”¯æŒappend-onlyçš„é¡ºåºå†™å…¥ï¼Œå……åˆ†åˆ©ç”¨äº†SSDçš„é¡ºåºå†™å’Œéšæœºè¯»ç‰¹æ€§ã€‚&lt;/p&gt;
&lt;p&gt;é€šè¿‡å¤šç§æœºåˆ¶æœ€å¤§åŒ–SSDæ€§èƒ½ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å……åˆ†åˆ©ç”¨ç‹¬ç«‹chunkå¸ƒå±€ï¼Œæå¤§çš„å‡å°‘äº†æ•°æ®æ“ä½œçš„æ¬¡æ•°ï¼Œè€Œä¸éœ€è¦ä½¿ç”¨page cacheå’Œæ—¥å¿—ç­‰æœºåˆ¶ã€‚&lt;/li&gt;
&lt;li&gt;ä¸éœ€è¦å»ºç«‹åˆ†çº§çš„ç´¢å¼•æœºåˆ¶ï¼ˆä¾‹å¦‚ext4çš„inodeå’Œæ–‡ä»¶ç›®å½•dentriesï¼‰ã€‚æ‰€æœ‰çš„æ“ä½œä¼šé€šè¿‡æ—¥å¿—è¿›è¡Œè®°å½•ï¼Œè¯¥æ—¥å¿—å¯ä»¥ç”¨æ¥åœ¨æŒ‚è½½æ–‡ä»¶ç³»ç»Ÿæ—¶é‡å»ºå…ƒæ•°æ®ä¿¡æ¯ã€‚&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨è½®è¯¢æœºåˆ¶å‡å°‘ä¸­æ–­ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;å•ä¸ªSSDçš„å®¹é‡ä¸€èˆ¬å¾ˆå¤§ï¼Œå¹¶ä¸”ä¸€ä¸ªchunkçš„å¤§å°é€šå¸¸æ˜¯64MBï¼Œè®¾å®šUSSFSçš„æœ€å°ç©ºé—´åˆ†é…ç²’åº¦ä¸º1MBï¼Œä¸»è¦è€ƒè™‘ä½¿ç”¨çš„å†…å­˜å¤§å°å’ŒSSDçš„ç©ºé—´åˆ©ç”¨ç‡ã€‚&lt;/p&gt;
&lt;h2 id=&#34;é«˜æ€§èƒ½slaä¿éšœ&#34;&gt;é«˜æ€§èƒ½SLAä¿éšœ&lt;/h2&gt;
&lt;h3 id=&#34;chasing&#34;&gt;Chasing&lt;/h3&gt;
&lt;p&gt;å‡å°‘ç³»ç»ŸæŠ–åŠ¨åœ¨å†™å»¶è¿Ÿä¸Šçš„å½±å“ã€‚&lt;/p&gt;
&lt;p&gt;å½“$MaxCopy$ä¸ªå‰¯æœ¬ä¸­çš„$MinCopy$ä¸ªåœ¨chunkserverä¸­æˆåŠŸå†™å…¥æ—¶ï¼Œå…è®¸clientå‘åº”ç”¨è¿”å›successã€‚&lt;/p&gt;
&lt;p&gt;è§„å®š $2\times MinCopy\textgreater\ MaxCopy$ã€‚&lt;/p&gt;
&lt;p&gt;ä¸‹å›¾Figure 4å±•ç¤ºäº†Chasingåœ¨ $MaxCopy=3\and MinCopy=2$æƒ…å†µä¸‹çš„å·¥ä½œæƒ…å†µï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.ipandai.club/img/image-20230308133528640.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20230308133528640&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;åº”ç”¨ç¨‹åºè¯·æ±‚Clientå†™å…¥æ•°æ®$[1,2,3]$åˆ°3ä¸ªå‰¯æœ¬chunkserverä¸­ï¼Œåœ¨æ—¶é—´$T$æ—¶ï¼Œchunkserver1å’Œ2å·²ç»å‘clientè¿”å›äº†å†™æ“ä½œsuccessï¼Œä½†æ˜¯chunkserver3è¿˜æ²¡æœ‰å›å¤ã€‚æ­¤æ—¶Clientå°†å‘åº”ç”¨ç¨‹åºå›å¤successã€‚&lt;/p&gt;
&lt;p&gt;åœ¨Clientä¸­è¿˜éœ€è¦åœ¨å†…å­˜ä¸­ä¿ç•™å†™å…¥çš„æ•°æ®ï¼Œå¹¶ç­‰å¾…ä¸€ä¸ªæ—¶é—´æ®µ$t$ï¼ˆmsçº§åˆ«ï¼‰ï¼Œå¦‚æœchunkserver 3åœ¨$T+t$æ—¶é—´ä»¥å‰å›å¤äº†successï¼ŒClientå°±ä¼šåœ¨å†…å­˜ä¸­åˆ é™¤é‡Šæ”¾è¦å†™å…¥çš„æ•°æ®ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœchunkserver 3æ²¡æœ‰å®Œæˆå†™å…¥æ“ä½œï¼Œä¸”æ²¡æœ‰å®Œæˆçš„éƒ¨åˆ†å°äºé˜ˆå€¼$k$ï¼ŒClientå°†åœ¨chunkserver 3ä¸­å‘èµ·é‡è¯•æ“ä½œï¼›è‹¥æ²¡æœ‰å®Œæˆçš„éƒ¨åˆ†å¤§äº$k$ï¼ŒClientå°†ä¼šåœ¨chunkserver 3ä¸­å°å­˜è¿™ä¸ªchunkï¼Œä¿è¯ä¸ä¼šæ”¶åˆ°åç»­è¿½åŠ å†™å…¥çš„å½±å“ï¼ŒClienté€šçŸ¥masterï¼Œmasterå°†ä»chunkserver 1æˆ–è€…2å¤åˆ¶ä¸€ä¸ªä¸åŒçš„chunkæ¥ä¿è¯æ€»å…±å­˜åœ¨3ä¸ªå‰¯æœ¬ï¼Œ&lt;strong&gt;Clientçš„å†…å­˜ä¸­è¿˜æœ‰ä¸€ä¸ªå‰¯æœ¬ï¼Ÿ&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;é‚£ä¹ˆchunkserver 3ä¸­å°å­˜è¿‡çš„chunkæ€ä¹ˆå¤„ç†ï¼Ÿ&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;è¿™ç§Early- Write- Acknowledgmentæœºåˆ¶ï¼Œå‡å°‘äº†å†™å…¥æ“ä½œçš„å°¾å»¶è¿Ÿï¼Œåœ¨ç›˜å¤ä¸Šéƒ¨ç½²äº†åå¤šå¹´ï¼Œæ²¡å‘ç”Ÿè¿‡æ•°æ®ä¸¢å¤±ã€‚&lt;/p&gt;
&lt;h3 id=&#34;non-stop-write-ä¸åœå†™&#34;&gt;Non-stop write ä¸åœå†™&lt;/h3&gt;
&lt;p&gt;å‡å°‘å½“ä¸€ä¸ªchunkå†™å…¥å¤±è´¥å¯¼è‡´çš„å†™å…¥å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;å½“å†™å…¥å¤±è´¥æ—¶ï¼ŒClientğŸå°å­˜chunkå¹¶ä¸”æ±‡æŠ¥masterå½“å‰å·²ç»æˆåŠŸå†™å…¥çš„æ•°æ®é•¿åº¦ï¼Œmasterä½¿ç”¨ä¸€ä¸ªæ–°çš„chunkæ¥ç»§ç»­å†™å…¥æ•°æ®ã€‚å¦‚æœå†™å…¥åˆ°å°å­˜çš„chunkä¸­çš„æ•°æ®æŸåï¼Œä¼šåœ¨åå°ä½¿ç”¨å…¶ä»–å·²ç»æˆåŠŸå†™å…¥çš„å‰¯æœ¬å¤åˆ¶åˆ°ä¸€ä¸ªæ–°çš„chunkä¸­ã€‚å¦‚æœæ²¡æœ‰å¯ç”¨å‰¯æœ¬ï¼ŒClientå°†å†æ¬¡å†™å…¥æ•°æ®åˆ°ä¸€ä¸ªæ–°çš„chunkã€‚&lt;/p&gt;
&lt;h3 id=&#34;backup-read&#34;&gt;Backup read&lt;/h3&gt;
&lt;p&gt;å‡å°‘åŠ¨æ€ç¯å¢ƒä¸‹è¯»å»¶è¿Ÿã€‚åœ¨æ”¶åˆ°è¯»è¯·æ±‚çš„responseå‰ï¼ŒClientå‘å…¶ä»–Chunkserverå‘é€é¢å¤–çš„è¯»è¯·æ±‚ä½œä¸ºå¤‡ä»½ã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æœºåˆ¶æ¶‰åŠä¸¤ä¸ªå‚æ•°ï¼Œå‘é€è¯·æ±‚çš„æ•°é‡å’Œç­‰å¾…æ—¶é—´ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºæ­¤ï¼Œç›˜å¤è®¡ç®—äº†ä¸åŒç¡¬ç›˜ç±»å‹å’ŒI/Oå¤§å°çš„å»¶è¿Ÿï¼Œå¹¶ä½¿ç”¨è¿™äº›ä¿¡æ¯åŠ¨æ€è°ƒæ•´å‘é€å¤‡ä»½è¯»å–è¯·æ±‚çš„æ—¶é—´ã€‚å®ƒè¿˜é™åˆ¶äº†å¤‡ä»½è¯»å–è¯·æ±‚çš„æ•°é‡ï¼Œä»¥æ§åˆ¶ç³»ç»Ÿçš„è´Ÿè½½ã€‚&lt;/p&gt;
&lt;h3 id=&#34;blacklisting&#34;&gt;Blacklisting&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†é¿å…å‘æœåŠ¡è´¨é‡å·®çš„chunkserverå‘é€I/Oè¯·æ±‚ï¼Œç›˜å¤ä½¿ç”¨ä¸¤ä¸ªé»‘åå•ï¼Œ&lt;strong&gt;ç¡®å®šé»‘åå•&lt;/strong&gt;å’Œ&lt;strong&gt;éç¡®å®šé»‘åå•&lt;/strong&gt;ã€‚&lt;/p&gt;
&lt;p&gt;å½“ç›˜å¤ç¡®å®šä¸€ä¸ªchunkserverå·²ç»æ— æ³•æä¾›æœåŠ¡ï¼ˆchunkserverçš„SSDæŸåï¼‰ï¼Œè¿™ä¸ªæœåŠ¡å™¨å°†è¢«åŠ å…¥ç¡®å®šé»‘åå•ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä¸€ä¸ªchunkserverå¯ä»¥æä¾›æœåŠ¡ï¼Œä½†æ˜¯å»¶è¿Ÿè¶…è¿‡ä¸Šé™ï¼Œå°†ä¼šè¢«åŠ å…¥éç¡®å®šé»‘åå•ï¼Œå¹¶è®¾ç½®å…¶æœåŠ¡å»¶è¿Ÿå¢åŠ çš„å¯èƒ½æ€§ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœchunkserverçš„å»¶è¿Ÿè¶…è¿‡äº†æ‰€æœ‰serverå»¶è¿Ÿçš„ä¸­ä½æ•°ï¼Œä¼šå°†å®ƒç›´æ¥åŠ å…¥éç¡®å®šæ€§é»‘åå•ä¸­ï¼Œå¯èƒ½æ€§ä¸º1.&lt;/p&gt;
&lt;p&gt;Clienté˜¶æ®µæ€§çš„å‘chunkserverå‘é€I/Oæ¢æµ‹ï¼Œä»¥ä¾¿ç»´æŠ¤éç¡®å®šæ€§é»‘åå•ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœåœ¨ç¡®å®šæ€§é»‘åå•ä¸­çš„æœåŠ¡å™¨æˆåŠŸè¿”å›äº†responseï¼Œä¼šå°†å…¶åœ¨é»‘åå•ä¸­ç§»é™¤ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹äºåœ¨éç¡®å®šæ€§é»‘åå•ä¸­çš„æœåŠ¡å™¨ï¼Œå°†ä¼šåŸºäºresponseçš„å“åº”æ—¶é—´æ¥åˆ¤æ–­ã€‚&lt;/p&gt;
&lt;p&gt;ç›˜å¤åŒæ—¶é™åˆ¶é»‘åå•ä¸­çš„æœåŠ¡æ•°é‡æ¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚å¯¹äºæ¯ä¸ªæœåŠ¡å™¨è€Œè¨€ï¼Œè¿™å¼•å…¥äº†å®½é™æœŸæ¥ç»´æŠ¤é»‘åå•ä¿è¯ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚&lt;/p&gt;
&lt;p&gt;ç›˜å¤ä¸ºRDMAå’ŒTCPä¸¤ç§é“¾æ¥åˆ†åˆ«ç»´æŠ¤äº†é»‘åå•ã€‚&lt;/p&gt;
&lt;h2 id=&#34;è¯„ä¼°&#34;&gt;è¯„ä¼°&lt;/h2&gt;
&lt;p&gt;Figure 5ä¸º2018å¹´åŒåä¸€æœŸé—´çš„å³°å€¼å»¶è¿Ÿï¼Œåœ¨éœ€è¦è¿›è¡Œå¤§é‡äº‹ç‰©å¤„ç†çš„æƒ…å†µä¸‹ï¼Œç›˜å¤2.0å»¶è¿Ÿä½äº280usã€‚&lt;/p&gt;
&lt;p&gt;Figure 6ä¸ºOTSæœåŠ¡çš„å»¶è¿Ÿï¼Œåœ¨ç›¸åŒçš„è¯·æ±‚è´Ÿè½½ä¸‹ï¼Œç›˜å¤2.0çš„æŸ¥è¯¢å»¶è¿Ÿæ¥è¿‘é™ä½äº†ä¸€ä¸ªæ•°é‡çº§ã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.ipandai.club/img/image-20230309135723278.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20230309135723278&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;Figure 7ã€8åˆ†åˆ«ä¸ºEBSã€åœ¨çº¿æœç´¢æœåŠ¡çš„å¹³å‡çš„å°¾å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;p&gt;EBSæœåŠ¡å†™å…¥è¾ƒå¤šï¼ŒP999å°¾å»¶è¿Ÿä½äº1msã€‚&lt;/p&gt;
&lt;p&gt;åœ¨çº¿æœç´¢æœåŠ¡è¯»å–è¾ƒå¤šï¼ŒP999å°¾å»¶è¿Ÿä½äº5msã€‚&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.ipandai.club/img/image-20230309135656800.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20230309135656800&#34;
	
	
&gt;&lt;/p&gt;
&lt;h1 id=&#34;0x03-phase-two-adapting-to-performance-oriented-business-model-é€‚é…é¢ç›¸æ€§èƒ½çš„å•†ä¸šæ¨¡å‹&#34;&gt;0x03 Phase Two: Adapting to Performance-Oriented Business Model é€‚é…é¢ç›¸æ€§èƒ½çš„å•†ä¸šæ¨¡å‹&lt;/h1&gt;
&lt;h2 id=&#34;ç½‘ç»œç“¶é¢ˆ&#34;&gt;ç½‘ç»œç“¶é¢ˆ&lt;/h2&gt;
&lt;h3 id=&#34;æ‰©å¤§å¸¦å®½&#34;&gt;æ‰©å¤§å¸¦å®½&lt;/h3&gt;
&lt;p&gt;ä¸ºäº†åŒ¹é…SSDçš„ååé‡ï¼Œå°†ç½‘ç»œå¸¦å®½ä»25Gbpså‡çº§åˆ°100Gbpsã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç¡¬ä»¶ä¼˜åŒ–&lt;/strong&gt;ï¼šé‡‡ç”¨é«˜æ€§èƒ½çš„NIC/RNCIç½‘å¡ã€å…‰æ¨¡å—ï¼ˆQSFP28 DACï¼ŒQSFP28 AOCï¼ŒQSFP28ï¼‰ã€å•æ¨¡/å¤šæ¨¡å…‰çº¤ã€é«˜æ€§èƒ½äº¤æ¢æœºã€‚&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;ç½‘ç»œè½¯ä»¶å±‚&lt;/strong&gt;ï¼šé‡‡ç”¨æœ‰æŸRDMAï¼Œä¸ä½¿ç”¨æš‚åœå¸§ã€‚&lt;/p&gt;
&lt;p&gt;å¦‚æœä½¿ç”¨æ— æŸRDMAï¼Œå½“RDMAç½‘ç»œä¸­æš‚åœå¸§è¿‡å¤šæ—¶ï¼Œè¦åœ¨ä¸€æ®µæ—¶é—´å†…å…³é—­NICç«¯å£æˆ–ä¸´æ—¶åˆ‡æ¢RDMAä¸ºTCPï¼Œè¿™ç§åŸºäºæµé‡çš„æ§åˆ¶ä¸èƒ½è§£å†³ç”±æš‚åœå¸§å¼•å‘çš„å…¶ä»–é—®é¢˜ï¼ˆæ­»é”ã€å¤´é˜»å¡ï¼‰ã€‚å› æ­¤ç›˜å¤ä½¿ç”¨æœ‰æŸRDMAã€‚&lt;/p&gt;
&lt;h3 id=&#34;æµé‡ä¼˜åŒ–&#34;&gt;æµé‡ä¼˜åŒ–&lt;/h3&gt;
&lt;p&gt;å‡å°‘æµé‡æ”¾å¤§ç‡ã€‚&lt;/p&gt;
&lt;p&gt;æµé‡æ”¾å¤§ç‡ä¸ºç³»ç»Ÿä¸­æ‰€æœ‰çš„æµé‡ä¼ è¾“é‡é™¤ä»¥çœŸå®çš„æ–‡ä»¶å¤§å°ï¼Œå¦‚Figure 9ï¼š&lt;/p&gt;
&lt;p&gt;ä»¥EBSæœåŠ¡ä¸ºä¾‹&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;EBS Clientå‘é€æ–‡ä»¶ï¼ˆ1xï¼‰åˆ°ç›˜å¤Client&lt;/li&gt;
&lt;li&gt;ç›˜å¤Clientå°†æ–‡ä»¶ä¼ è¾“åˆ°3ä¸ªå­˜å‚¨èŠ‚ç‚¹ï¼Œå¹¶å†™å…¥ä¸‰ä¸ªå‰¯æœ¬ï¼ˆ3xï¼‰&lt;/li&gt;
&lt;li&gt;GC Workerè¯»å–æ–‡ä»¶ï¼ˆ1xï¼‰å¹¶è¿›è¡ŒGC&lt;/li&gt;
&lt;li&gt;æœ€ç»ˆæ–‡ä»¶ä»¥EC(8,3)(1.375x)çš„å½¢å¼å†™å›å­˜å‚¨èŠ‚ç‚¹ï¼Œä¿è¯è‡³å°‘ä¸3ä¸ªå‰¯æœ¬åŒç­‰çº§åˆ«çš„å®¹é”™ï¼Œå¹¶èŠ‚çœäº†ç©ºé—´ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.ipandai.club/img/image-20230309151419443.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20230309151419443&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;è¿‡ç¨‹ä¸­çš„æµé‡æ”¾å¤§ç‡ä¸º6.375x(1x+3x+1x+1.375x)ã€‚&lt;/p&gt;
&lt;p&gt;å› æ­¤æå‡ºäº†ä¸‰ä¸ªä¼˜åŒ–ï¼š&lt;/p&gt;
&lt;h4 id=&#34;ä½¿ç”¨ecæ›¿æ¢3ä¸ªå‰¯æœ¬&#34;&gt;ä½¿ç”¨ECæ›¿æ¢3ä¸ªå‰¯æœ¬&lt;/h4&gt;
&lt;p&gt;åœ¨ä¿è¯è‰¯å¥½å®¹é”™æ€§çš„æƒ…å†µä¸‹ï¼Œæœ‰æ•ˆé™ä½æµé‡ã€‚ä½¿ç”¨b1ä¸­çš„EC(4,2)ï¼Œå¯ä»¥å°†æµé‡é™ä½ä¸º4.875xã€‚è¯¥æ–¹æ³•å­˜åœ¨ä¸¤ä¸ªé—®é¢˜ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;å¯¹äºå°æ–‡ä»¶çš„ECå­˜å‚¨å¼€é”€è¾ƒå¤§ï¼Œéœ€è¦å¡«å……å¤§é‡çš„0è¾¾åˆ°è§„å®šé•¿åº¦ã€‚ä½¿ç”¨å¤šç§æœºåˆ¶å‡å°‘ç©ºé—´æµªè´¹ã€‚å¯ä»¥å¯¹å°çš„å†™è¯·æ±‚è¿›è¡Œèšåˆï¼Œå¹¶åŠ¨æ€åˆ‡æ¢å­˜å‚¨ç­–ç•¥ï¼ˆECã€3ä¸ªå‰¯æœ¬ï¼‰&lt;/li&gt;
&lt;li&gt;è®¡ç®—ECå¼•å…¥äº†é¢å¤–å»¶è¿Ÿï¼Œç›˜å¤é‡‡ç”¨&lt;a class=&#34;link&#34; href=&#34;https://github.com/intel/isa-l&#34;  target=&#34;_blank&#34; rel=&#34;noopener&#34;
    &gt;Intel ISA-L&lt;/a&gt;ï¼Œå°†ECè®¡ç®—çš„å»¶è¿Ÿç›¸è¾ƒäºJerasureé™ä½äº†2.5-3å€&lt;/li&gt;
&lt;/ol&gt;
&lt;h4 id=&#34;å‹ç¼©flatlogfile&#34;&gt;å‹ç¼©FlatLogFile&lt;/h4&gt;
&lt;p&gt;FlatLogFileå­˜åœ¨é«˜åº¦å†—ä½™ã€‚ç›˜å¤Clientå’ŒGC Workeråœ¨è¿›è¡Œä¸‹ä¸€æ­¥å†™å…¥æ—¶å‹ç¼©FlatLogFileï¼Œæ¥å‡å°‘æµé‡ã€‚&lt;/p&gt;
&lt;p&gt;ç›˜å¤ä½¿ç”¨LZ4ç®—æ³•æ¥å®ç°é«˜æ•ˆçš„å‹ç¼©/è§£å‹ç¼©ã€‚&lt;/p&gt;
&lt;h4 id=&#34;å‰åå°æµé‡çš„åŠ¨æ€å¸¦å®½è°ƒèŠ‚&#34;&gt;å‰åå°æµé‡çš„åŠ¨æ€å¸¦å®½è°ƒèŠ‚&lt;/h4&gt;
&lt;p&gt;åŠ¨æ€è°ƒæ•´åå°æµé‡ï¼ˆGCç­‰ï¼‰çš„ç½‘ç»œå¸¦å®½ã€‚&lt;/p&gt;
&lt;p&gt;å½“å­˜å‚¨é›†ç¾¤ä¸­æµé‡ç©ºé—²æ—¶ï¼Œå‡å°‘åå°æµé‡çš„é™é¢ï¼Œä½¿å‰å°åº”ç”¨ä½¿ç”¨æ›´å¤šçš„å¸¦å®½ã€‚&lt;/p&gt;
&lt;h2 id=&#34;å†…å­˜ç“¶é¢ˆ&#34;&gt;å†…å­˜ç“¶é¢ˆ&lt;/h2&gt;
&lt;p&gt;å†…å­˜ç“¶é¢ˆæ¥è‡ªå†…å­˜å¸¦å®½å’Œç½‘å¡ï¼ˆNIC æ‰§è¡ŒDMAï¼‰çš„ç«äº‰ï¼Œä»¥åŠæ¥å—ç«¯çš„åº”ç”¨å¤„ç†ï¼ˆæ•°æ®æ‹·è´ï¼Œå¤åˆ¶ï¼Œgcï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;NICæ— æ³•è·å¾—è¶³å¤Ÿçš„å†…å­˜å¸¦å®½ï¼Œä½¿å¾—PCIeçš„å¸¦å®½è¶…å‡ºNICçš„å¤„ç†èƒ½åŠ›ï¼ŒNIC bufferä¸­éƒ½æ˜¯åœ¨é€”æ•°æ®åŒ…ï¼Œå¯¼è‡´ä¸¢åŒ…ã€‚&lt;/p&gt;
&lt;p&gt;å› æ‹¥å¡æ§åˆ¶å¯¼è‡´çš„æ€§èƒ½æŸå¤±ä¼šé™ä½30%çš„ç½‘ç»œååé‡ï¼Œ10%çš„å»¶è¿Ÿã€‚&lt;/p&gt;
&lt;h3 id=&#34;åŠ å†…å­˜&#34;&gt;åŠ å†…å­˜&lt;/h3&gt;
&lt;p&gt;å¢åŠ äº†å¾ˆå¤šå°å®¹é‡çš„DRAMï¼ˆ16GBï¼‰ï¼Œæœ€å¤§åŒ–Memory Channelçš„åˆ©ç”¨ç‡ï¼Œæé«˜æ¯ä¸ªæœåŠ¡å™¨å¯ç”¨çš„å†…å­˜å¸¦å®½ã€‚&lt;/p&gt;
&lt;p&gt;ä½¿ç”¨NUMAæ¥é¿å…è·¨Socketså†…å­˜è®¿é—®ã€‚&lt;/p&gt;
&lt;h3 id=&#34;tcp-to-rdma&#34;&gt;TCP to RDMA&lt;/h3&gt;
&lt;p&gt;TCPä½¿ç”¨æ›´å¤šçš„å†…å­˜æ‹·è´ï¼Œä½¿ç”¨RDMAåï¼Œåå°æµé‡çš„å†…å­˜å¸¦å®½å‡å°‘äº†75%ã€‚&lt;/p&gt;
&lt;p&gt;ä¸ºäº†ä¿è¯å‰ç«¯æµé‡çš„QoSï¼Œç›˜å¤è®¾è®¡äº†ç±»ä¼¼Linux tcé¢‘ç‡æ§åˆ¶æœºåˆ¶ï¼Œæ¥æ§åˆ¶åå°æµé‡å‘é€åˆ°ç½‘ç»œä¸­çš„é€Ÿç‡ã€‚&lt;/p&gt;
&lt;h3 id=&#34;rdca&#34;&gt;RDCA&lt;/h3&gt;
&lt;p&gt;ä½¿å¾—å‘é€ç«¯ç»•è¿‡æ¥æ”¶ç«¯çš„å†…å­˜å¹¶ç›´æ¥è®¿é—®æ¥æ”¶ç«¯çš„cacheã€‚&lt;/p&gt;
&lt;p&gt;è¯¥æ± ä½¿ç”¨å…±äº«æ¥æ”¶å™¨é˜Ÿåˆ—ï¼ˆSRQï¼‰æ¥æ¥æ”¶å°æ¶ˆæ¯ï¼Œ&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;ç¼“å­˜é©»ç•™ç¼“å†²æ± ï¼šä½¿ç”¨å…±äº«æ¥å—é˜Ÿåˆ—æ¥æ¥å—å°ä¿¡æ¯ï¼Œå¹¶ä½¿ç”¨åŸºäºçª—å£ï¼ˆç±»ä¼¼TCPæ»‘åŠ¨çª—å£ï¼Ÿï¼‰çš„é€Ÿç‡æ§åˆ¶æœºåˆ¶çš„READç¼“å†²åŒºæ¥æ¥æ”¶å¤§æ¶ˆæ¯ï¼Œå› æ­¤RDMAæ“ä½œæ‰€éœ€çš„å†…å­˜ç¼“å†²åŒºå¯ä»¥æ”¾å…¥ç¼“å­˜ä¸­&lt;/li&gt;
&lt;li&gt;å¿«é€Ÿç¼“å­˜å›æ”¶ï¼šä¸ºäº†åœ¨å°‘é‡LLCäºŒçº§Cacheä¸‹è¾¾åˆ°100Gbps NICçº¿æ€§é€Ÿç‡æ“ä½œï¼Œè®¾è®¡ä¸¤ç§æœºåˆ¶å‡å°‘æ•°æ®é€šè¿‡NICçš„æ—¶é—´è·¨åº¦ï¼š
&lt;ol&gt;
&lt;li&gt;åœ¨ä¸€ä¸ªæµæ°´çº¿ä¸‹å¹³è¡Œå¤„ç†æ•°æ®&lt;/li&gt;
&lt;li&gt;é€šè¿‡ç¡¬ä»¶å¸è½½å’Œè½»é‡åŒ–çš„åºåˆ—åŒ–/ååºåˆ—åŒ– ä¼˜åŒ–æ•°æ®å¤„ç†&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;li&gt;ç¼“å­˜å‹åŠ›æ„ŸçŸ¥çš„é€ƒé€¸æœºåˆ¶ï¼šè§£å†³æ€§èƒ½æŠ–åŠ¨ï¼Œé€ƒé€¸æœºåˆ¶ç›‘æ§LLCçš„ä½¿ç”¨å¹¶æ‰§è¡Œå“åº”çš„ç­–ç•¥
&lt;ol&gt;
&lt;li&gt;é€šè¿‡å‘ç¼“å­˜é©»ç•™ç¼“å†²æ± æ·»åŠ ä¸€ä¸ªæ–°çš„ç¼“å†²åŒºæ¥æ›¿æ¢æ‰é˜Ÿæ•°æ®çš„ç¼“å­˜ç¼“å†²åŒºï¼Œè¿™æ ·RDCAä¸­ç”¨äºé€‚åº”æ–°åˆ°è¾¾çš„è¯·æ±‚çš„å¯ç”¨ç¼“å­˜çš„å¤§å°ä¿æŒä¸å˜&lt;/li&gt;
&lt;li&gt;å¦‚æœå‘ç”Ÿå¤ªå¤šæ›¿æ¢ï¼Œåˆ™ä¸»åŠ¨å°†è¿è¡Œç¼“æ…¢çš„åº”ç”¨ç¨‹åºçš„æ•°æ®å¤åˆ¶åˆ°å†…å­˜ä¸­ï¼Œè¿™æ ·å…¶ä»–åº”ç”¨ç¨‹åºå¯ä»¥ä½¿ç”¨RDCAç¼“å†²æ± ï¼Œå¹¶ä¸”è¯¥æ± ä¸ä¼šå ç”¨å¤ªå¤šç¼“å­˜&lt;/li&gt;
&lt;li&gt;è®©NICåœ¨&lt;strong&gt;æ‹¥å¡é€šçŸ¥åŒ…&lt;/strong&gt;ä¸­æ ‡è®°æ˜¾å¼&lt;strong&gt;æ‹¥å¡é€šçŸ¥&lt;/strong&gt;ï¼ˆECNï¼‰ï¼Œå¦‚æœå¤åˆ¶åˆ°å†…å­˜å¤±è´¥æˆ–ä¸è¶³ä»¥é‡Šæ”¾ç¼“å­˜å‹åŠ›ï¼Œåˆ™æŒ‡ç¤ºæ‹¥å¡&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id=&#34;cpuç“¶é¢ˆ&#34;&gt;CPUç“¶é¢ˆ&lt;/h2&gt;
&lt;p&gt;æ•°æ®çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€æ•°æ®å‹ç¼©ã€æ•°æ®CRCæ ¡éªŒäº§ç”Ÿäº†å¤§é‡çš„CPUå¼€é”€&lt;/p&gt;
&lt;h3 id=&#34;æ··åˆrpc&#34;&gt;æ··åˆRPC&lt;/h3&gt;
&lt;p&gt;ç›˜å¤é€šè¿‡Protobufï¼ˆGoogle gRPCï¼‰å‘é€RPCè¯·æ±‚ï¼Œè¯¥æ¡†æ¶éœ€è¦å¯¹æ•°æ®è¿›è¡Œåºåˆ—åŒ–/ååºåˆ—åŒ–ï¼Œäº§ç”Ÿäº†30%çš„CPUå¼€é”€ã€‚&lt;/p&gt;
&lt;p&gt;ç›˜å¤å†…éƒ¨çš„æ•°æ®é€šè·¯åªæœ‰å°‘é‡ä¸ºRPCï¼Œå› æ­¤ï¼Œä¸ºäº†ä¸éœ€è¦åºåˆ—åŒ–å³å¯å‘é€æ•°æ®ï¼Œç›˜å¤ä½¿ç”¨ä¸€ç§ç±»ä¼¼FlatBufferçš„åŸç”Ÿç»“æ„å–ä»£æ•°æ®é€šè·¯æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;å¾—ç›ŠäºProtobufçµæ´»æ€§ï¼Œç›˜å¤ç»§ç»­ä½¿ç”¨Protobufæ¥è¿›è¡Œæ§åˆ¶æ“ä½œã€‚&lt;/p&gt;
&lt;p&gt;æ¯ä¸ªCPUæ ¸å¿ƒçš„ç½‘ç»œååé‡å¢åŠ äº†59%ã€‚&lt;/p&gt;
&lt;h3 id=&#34;ä½¿ç”¨cpu-waitæ”¯æŒè¶…çº¿ç¨‹&#34;&gt;ä½¿ç”¨CPU waitæ”¯æŒè¶…çº¿ç¨‹&lt;/h3&gt;
&lt;p&gt;hyper-threadingï¼ˆHTï¼‰è¶…çº¿ç¨‹æŠ€æœ¯æœ‰ä¸¤ä¸ªä¸»è¦é—®é¢˜&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ä¸¤ä¸ªHTåœ¨ä¸€ä¸ªæ— åŠ›æ ¸å¿ƒä¸Šæ‰§è¡Œéœ€è¦ä¸Šä¸‹æ–‡åˆ‡æ¢&lt;/li&gt;
&lt;li&gt;ä¸€ä¸ªHTå½±å“å…¶ä»–HTçš„æ‰§è¡Œï¼Œä¼šä½¿æ•´ä½“çš„å»¶è¿Ÿå‡é«˜&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;ç›˜å¤æå‡ºäº†CPU waitæŒ‡ä»¤ï¼ŒåŒ…æ‹¬&lt;strong&gt;monitor&lt;/strong&gt;å’Œ&lt;strong&gt;mwait&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;ä¾‹å¦‚ï¼šç½‘ç»œç©ºé—²è½®è¯¢çº¿ç¨‹å°†ç›‘æ§çš„å†…å­˜åœ°å€ï¼Œæ‰§è¡Œmwaitï¼Œç›´åˆ°å†…å­˜åœ°å€è¢«å…¶ä»–çº¿ç¨‹ä¿®æ”¹æ—¶æ‰è¢«å”¤é†’ã€‚&lt;/p&gt;
&lt;p&gt;åœ¨mwaitè¿‡ç¨‹ä¸­ï¼Œå®ƒè¿è¡Œçš„HTè¿›å…¥&lt;strong&gt;ç©ºé—²ç¡çœ çŠ¶æ€&lt;/strong&gt;ï¼ˆC-Statesä¸­çš„é™¤C0ä¹‹å¤–çš„ä¸€ä¸ªçŠ¶æ€ï¼‰ï¼Œå› æ­¤ä¸ä¼šå¹²æ‰°å…¶ä»–HTã€‚&lt;/p&gt;
&lt;p&gt;æ‰§è¡ŒCPU waitçš„æ—¶é—´å¼€é”€å°äº5msï¼Œå”¤é†’ä¸€ä¸ªHTçš„å¼€é”€ä¹Ÿæ˜¯msçº§åˆ«ã€‚&lt;/p&gt;
&lt;p&gt;å¯¹æ¯”æ²¡æœ‰CPU waitï¼Œç½‘ç»œååé‡æé«˜äº†31.6%ã€‚&lt;/p&gt;
&lt;h3 id=&#34;è½¯ç¡¬ä»¶co-desgin&#34;&gt;è½¯ç¡¬ä»¶Co-Desgin&lt;/h3&gt;
&lt;p&gt;å°†ä¸€äº›ä»»åŠ¡å¸è½½åˆ°å¯ç¼–ç¨‹ç¡¬ä»¶ã€‚&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;&lt;strong&gt;æ•°æ®å‹ç¼©&lt;/strong&gt;ï¼šå¸è½½åˆ°åŸºäºFPGAçš„å¯è®¡ç®—å­˜å‚¨ï¼Œè¾¾åˆ°3GB/sçš„ååé‡ï¼Œå¯ä»¥èŠ‚çœ10ä¸ªç‰©ç†æ ¸å¿ƒã€‚&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;CRCè®¡ç®—&lt;/strong&gt;ï¼šå¸è½½åˆ°RDMA-æ€»çº¿ NICç½‘å¡ï¼Œä¸ºæ¯ä¸ªæ•°æ®å—è®¡ç®—CRCï¼ŒCPUä¼šæ±‡æ€»è¿™äº›CRCå¹¶æ‰§è¡Œè½»é‡åŒ–çš„æ£€æŸ¥ï¼Œä¿è¯äº†CPUçš„ä½è´Ÿè½½å’Œä¸Šå±‚åº”ç”¨çš„æ•°æ®é›†æˆã€‚èŠ‚çœäº†30%çš„CPUå¼€é”€ã€‚&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&#34;è¯„ä¼°-1&#34;&gt;è¯„ä¼°&lt;/h2&gt;
&lt;p&gt;æ ‡å‡†åŒ–çš„æœ‰æ•ˆååé‡ï¼š&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://blog.ipandai.club/img/image-20230311205320296.png&#34;
	
	
	
	loading=&#34;lazy&#34;
	
		alt=&#34;image-20230311205320296&#34;
	
	
&gt;&lt;/p&gt;
&lt;p&gt;ä»å·¦åˆ°å³ï¼š&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;ç›˜å¤ä½¿ç”¨2*25GBpsç½‘ç»œå¸¦å®½å’Œ4TB-SDD&lt;/li&gt;
&lt;li&gt;SSDå¢åŠ åˆ°æ›´é«˜æ€§èƒ½çš„8TBï¼Œä½¿ç”¨100Gbpsç½‘ç»œï¼ˆPCIe gen3ï¼‰&lt;/li&gt;
&lt;li&gt;ä¼˜åŒ–äº†å†…å­˜å¸¦å®½&lt;/li&gt;
&lt;li&gt;ä½¿ç”¨PCIe gen4ï¼Œç½‘ç»œå¸¦å®½å¢åŠ åˆ°2*100Gbpsï¼Œå­˜åœ¨æµé‡æ”¾å¤§é—®é¢˜ã€‚&lt;/li&gt;
&lt;li&gt;Clienté‡‡å–EC(4,2)ï¼Œæ•°æ®å‹ç¼©ç­‰ä¼˜åŒ–ç¼“è§£äº†æµé‡æ”¾å¤§é—®é¢˜&lt;/li&gt;
&lt;li&gt;å¸è½½æ•°æ®å‹ç¼©å’ŒCRCåˆ°å¤–ç½®ç¡¬ä»¶&lt;/li&gt;
&lt;/ol&gt;
&lt;h1 id=&#34;0x04-operation-experiences&#34;&gt;0x04 Operation Experiences&lt;/h1&gt;
&lt;p&gt;ä»‹ç»äº†åœ¨å¼€å‘è¿è¥è¿‡ç¨‹ä¸­é‡åˆ°çš„ä¸€äº›æ¡ˆä¾‹ç ”ç©¶&lt;/p&gt;
&lt;h1 id=&#34;0x05-lessons&#34;&gt;0x05 Lessons&lt;/h1&gt;
&lt;ul&gt;
&lt;li&gt;user-space systemï¼š
&lt;ul&gt;
&lt;li&gt;åœ¨user spaceå¼€å‘èŠ‚çœäººåŠ›å¹¶ä¸”å®¹æ˜“ç›‘æ§å’Œè°ƒæ•´å‚æ•°&lt;/li&gt;
&lt;li&gt;user spaceå¼€å‘éœ€è¦å­¦ä¹ kernel spaceå¼€å‘&lt;/li&gt;
&lt;li&gt;ç‹¬ç«‹chunkå¸ƒå±€è¿˜ä¼˜åŒ–äº†HDDçš„å†™å…¥æ•ˆç‡&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;tradeoffï¼šæˆæœ¬å’Œæ€§èƒ½çš„å¹³è¡¡ï¼Œæé«˜èµ„æºåˆ©ç”¨ç‡&lt;/li&gt;
&lt;li&gt;PMemï¼šIntelæ”¾å¼ƒäº†PMemçš„ä¸šåŠ¡&lt;/li&gt;
&lt;li&gt;hardware offloadingï¼šä»˜å‡ºäº†å¤§é‡æˆæœ¬è§£å†³è¿™ä¸€é—®é¢˜ï¼Œæ”¶ç›Šæ˜æ˜¾&lt;/li&gt;
&lt;/ul&gt;
&lt;h1 id=&#34;0x06-conclusion&#34;&gt;0x06 Conclusion&lt;/h1&gt;
&lt;p&gt;æ–‡ç« ä»‹ç»äº†ç›˜å¤ä»1.0ç‰ˆæœ¬åˆ°2.0ç‰ˆæœ¬çš„æ•´ä½“æ¼”è¿›è¿‡ç¨‹ï¼Œæœ‰éå¸¸å¤§çš„å®æˆ˜ç»éªŒï¼Œç»™å‡ºäº†å¯¹äºåˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€é¢å‘æ€§èƒ½çš„æœåŠ¡æ¨¡å¼ã€CPUç“¶é¢ˆã€å†…å­˜å¸¦å®½çš„å®ç°æ–¹æ¡ˆã€‚æ–‡ç« ä¸ªåˆ«åœ°æ–¹æ²¡æœ‰å¾ˆè¯¦ç»†çš„æè¿°ï¼Œé˜¿é‡Œäº‘å›¢é˜Ÿä¹Ÿå‘è¡¨è¿‡å¤šç¯‡å­¦æœ¯è®ºæ–‡ï¼Œæœ¬æ–‡è¿˜æ˜¯æ€»ç»“ä¸ºä¸»ã€‚&lt;/p&gt;
</description>
        </item>
        
    </channel>
</rss>
