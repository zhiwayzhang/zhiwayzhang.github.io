<!DOCTYPE html>
<html lang="en-us" dir="ltr">
    <head><meta charset='utf-8'>
<meta name='viewport' content='width=device-width, initial-scale=1'><meta name='description' content='Êú¨ÊñáÂ∞Ü‰ªéÊìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏Â±ÇÈù¢Âéª‰ªãÁªçLinux I/O Ê†à ==Ê∂âÂèäLinuxÂÜÖÊ†∏ÁöÑÈÉ®ÂàÜ‰∏ªË¶Å‰∏∫Linux 2.6== Linux I/O Ê†àÊ¶ÇËø∞ Linux I/O Ê†àÁöÑÁÆÄÂõæÂ¶Ç‰∏ã ‰∏ãÈù¢ÂàÜÂà´ÁÆÄËø∞ÂêÑ‰∏™Â±ÇÊ¨°ÁöÑÂäü'><title>Linux Block I/O StackÁÆÄ‰ªã</title>

<link rel='canonical' href='https://blog.ipandai.club/p/linux-block-i/o-stack%E7%AE%80%E4%BB%8B/'>

<link rel="stylesheet" href="/scss/style.min.b37b59a00b9f88b0e52d2ce1b15620b35b8e67131689b1bbdf480ce548f8b94a.css"><meta property='og:title' content='Linux Block I/O StackÁÆÄ‰ªã'>
<meta property='og:description' content='Êú¨ÊñáÂ∞Ü‰ªéÊìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏Â±ÇÈù¢Âéª‰ªãÁªçLinux I/O Ê†à ==Ê∂âÂèäLinuxÂÜÖÊ†∏ÁöÑÈÉ®ÂàÜ‰∏ªË¶Å‰∏∫Linux 2.6== Linux I/O Ê†àÊ¶ÇËø∞ Linux I/O Ê†àÁöÑÁÆÄÂõæÂ¶Ç‰∏ã ‰∏ãÈù¢ÂàÜÂà´ÁÆÄËø∞ÂêÑ‰∏™Â±ÇÊ¨°ÁöÑÂäü'>
<meta property='og:url' content='https://blog.ipandai.club/p/linux-block-i/o-stack%E7%AE%80%E4%BB%8B/'>
<meta property='og:site_name' content='Coding_Panda&#39;s Blog'>
<meta property='og:type' content='article'><meta property='article:section' content='Post' /><meta property='article:tag' content='Linux' /><meta property='article:tag' content='I/O' /><meta property='article:tag' content='NVMe' /><meta property='article:tag' content='SSD' /><meta property='article:tag' content='File System' /><meta property='article:published_time' content='2022-10-09T13:44:18&#43;08:00'/><meta property='article:modified_time' content='2022-10-09T13:44:18&#43;08:00'/>
<meta name="twitter:title" content="Linux Block I/O StackÁÆÄ‰ªã">
<meta name="twitter:description" content="Êú¨ÊñáÂ∞Ü‰ªéÊìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏Â±ÇÈù¢Âéª‰ªãÁªçLinux I/O Ê†à ==Ê∂âÂèäLinuxÂÜÖÊ†∏ÁöÑÈÉ®ÂàÜ‰∏ªË¶Å‰∏∫Linux 2.6== Linux I/O Ê†àÊ¶ÇËø∞ Linux I/O Ê†àÁöÑÁÆÄÂõæÂ¶Ç‰∏ã ‰∏ãÈù¢ÂàÜÂà´ÁÆÄËø∞ÂêÑ‰∏™Â±ÇÊ¨°ÁöÑÂäü">
    </head>
    <body class="
    article-page
    ">
    <script>
        (function() {
            const colorSchemeKey = 'StackColorScheme';
            if(!localStorage.getItem(colorSchemeKey)){
                localStorage.setItem(colorSchemeKey, "auto");
            }
        })();
    </script><script>
    (function() {
        const colorSchemeKey = 'StackColorScheme';
        const colorSchemeItem = localStorage.getItem(colorSchemeKey);
        const supportDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches === true;

        if (colorSchemeItem == 'dark' || colorSchemeItem === 'auto' && supportDarkMode) {
            

            document.documentElement.dataset.scheme = 'dark';
        } else {
            document.documentElement.dataset.scheme = 'light';
        }
    })();
</script>
<div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky ">
    <button class="hamburger hamburger--spin" type="button" id="toggle-menu" aria-label="Toggle Menu">
        <span class="hamburger-box">
            <span class="hamburger-inner"></span>
        </span>
    </button>

    <header>
        
            
            <figure class="site-avatar">
                <a href="/">
                
                    
                    
                    
                        
                        <img src="/img/avatar_hu8a3d9192938a940b103f152e82f8d0c1_176069_300x0_resize_box_3.png" width="300"
                            height="300" class="site-logo" loading="lazy" alt="Avatar">
                    
                
                </a>
                
                    <span class="emoji">üêº</span>
                
            </figure>
            
        
        
        <div class="site-meta">
            <h1 class="site-name"><a href="/">Coding_Panda&#39;s Blog</a></h1>
            <h2 class="site-description">Coding Panda.</h2>
        </div>
    </header><ol class="social-menu">
            
                <li>
                    <a 
                        href='https://space.bilibili.com/38920489'
                        target="_blank"
                        title="Bilibili"
                    >
                        
                        
                            <?xml version="1.0" standalone="no"?><!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd"><svg t="1664723478952" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2240" xmlns:xlink="http://www.w3.org/1999/xlink" width="200" height="200"><path d="M306.005333 117.632L444.330667 256h135.296l138.368-138.325333a42.666667 42.666667 0 0 1 60.373333 60.373333L700.330667 256H789.333333A149.333333 149.333333 0 0 1 938.666667 405.333333v341.333334a149.333333 149.333333 0 0 1-149.333334 149.333333h-554.666666A149.333333 149.333333 0 0 1 85.333333 746.666667v-341.333334A149.333333 149.333333 0 0 1 234.666667 256h88.96L245.632 177.962667a42.666667 42.666667 0 0 1 60.373333-60.373334zM789.333333 341.333333h-554.666666a64 64 0 0 0-63.701334 57.856L170.666667 405.333333v341.333334a64 64 0 0 0 57.856 63.701333L234.666667 810.666667h554.666666a64 64 0 0 0 63.701334-57.856L853.333333 746.666667v-341.333334A64 64 0 0 0 789.333333 341.333333zM341.333333 469.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666666-42.666667z m341.333334 0a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667z" p-id="2241" fill="#BFBFBF"></path></svg>
                        
                    </a>
                </li>
            
                <li>
                    <a 
                        href='https://github.com/zhiwayzhang'
                        target="_blank"
                        title="GitHub"
                    >
                        
                        
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-brand-github" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
  <path d="M9 19c-4.3 1.4 -4.3 -2.5 -6 -3m12 5v-3.5c0 -1 .1 -1.4 -.5 -2c2.8 -.3 5.5 -1.4 5.5 -6a4.6 4.6 0 0 0 -1.3 -3.2a4.2 4.2 0 0 0 -.1 -3.2s-1.1 -.3 -3.5 1.3a12.3 12.3 0 0 0 -6.2 0c-2.4 -1.6 -3.5 -1.3 -3.5 -1.3a4.2 4.2 0 0 0 -.1 3.2a4.6 4.6 0 0 0 -1.3 3.2c0 4.6 2.7 5.7 5.5 6c-.6 .6 -.6 1.2 -.5 2v3.5" />
</svg>



                        
                    </a>
                </li>
            
        </ol><ol class="menu" id="main-menu">
        
        
        

        <li >
            <a href='/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <polyline points="5 12 3 12 12 3 21 12 19 12" />
  <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7" />
  <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6" />
</svg>



                
                <span>Home</span>
            </a>
        </li>
        
        

        <li >
            <a href='/about/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-user" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="7" r="4" />
  <path d="M6 21v-2a4 4 0 0 1 4 -4h4a4 4 0 0 1 4 4v2" />
</svg>



                
                <span>About</span>
            </a>
        </li>
        
        

        <li >
            <a href='/archives/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-archive" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <rect x="3" y="4" width="18" height="4" rx="2" />
  <path d="M5 8v10a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-10" />
  <line x1="10" y1="12" x2="14" y2="12" />
</svg>



                
                <span>Archives</span>
            </a>
        </li>
        
        

        <li >
            <a href='/categories/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



                
                <span>Categories</span>
            </a>
        </li>
        
        

        <li >
            <a href='/search/' >
                
                
                
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="10" cy="10" r="7" />
  <line x1="21" y1="21" x2="15" y2="15" />
</svg>



                
                <span>Search</span>
            </a>
        </li>
        

        <div class="menu-bottom-section">
            
            
                <li id="dark-mode-toggle">
                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="8" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="16" cy="12" r="2" />
  <rect x="2" y="6" width="20" height="12" rx="6" />
</svg>



                    <span>Dark Mode</span>
                </li>
            
        </div>
    </ol>
</aside>
<main class="main full-width">
    <article class="main-article">
    <header class="article-header">

    <div class="article-details">
    
    <header class="article-category">
        
            <a href="/categories/storage/" >
                Storage
            </a>
        
            <a href="/categories/notes/" >
                Notes
            </a>
        
    </header>
    

    <div class="article-title-wrapper">
        <h2 class="article-title">
            <a href="/p/linux-block-i/o-stack%E7%AE%80%E4%BB%8B/">Linux Block I/O StackÁÆÄ‰ªã</a>
        </h2>
    
        
    </div>

    
    <footer class="article-time">
        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-calendar-time" width="56" height="56" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <path d="M11.795 21h-6.795a2 2 0 0 1 -2 -2v-12a2 2 0 0 1 2 -2h12a2 2 0 0 1 2 2v4" />
  <circle cx="18" cy="18" r="4" />
  <path d="M15 3v4" />
  <path d="M7 3v4" />
  <path d="M3 11h16" />
  <path d="M18 16.496v1.504l1 1" />
</svg>
                <time class="article-time--published">Oct 09, 2022</time>
            </div>
        

        
            <div>
                <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <polyline points="12 7 12 12 15 15" />
</svg>



                <time class="article-time--reading">
                    33 minute read
                </time>
            </div>
        
        
        

    </footer>
    

    
</div>
</header>

    <section class="article-content">
    
    
    <p>Êú¨ÊñáÂ∞Ü‰ªéÊìç‰ΩúÁ≥ªÁªüÂÜÖÊ†∏Â±ÇÈù¢Âéª‰ªãÁªçLinux I/O Ê†à</p>
<p>==Ê∂âÂèäLinuxÂÜÖÊ†∏ÁöÑÈÉ®ÂàÜ‰∏ªË¶Å‰∏∫Linux 2.6==</p>
<h1 id="linux-io-Ê†àÊ¶ÇËø∞">Linux I/O Ê†àÊ¶ÇËø∞</h1>
<p>Linux I/O Ê†àÁöÑÁÆÄÂõæÂ¶Ç‰∏ã</p>
<img src="/img/image-20221106012036118.png" alt="image-20221106012036118" style="zoom:50%;" />
<p>‰∏ãÈù¢ÂàÜÂà´ÁÆÄËø∞ÂêÑ‰∏™Â±ÇÊ¨°ÁöÑÂäüËÉΩ</p>
<h2 id="Â∫îÁî®Á®ãÂ∫èÂ±Ç">Â∫îÁî®Á®ãÂ∫èÂ±Ç</h2>
<p>Â∫îÁî®Á®ãÂ∫èÂ±ÇÈÄöËøáÁ≥ªÁªüË∞ÉÁî®ÂêëVFSÂèëËµ∑I/OËØ∑Ê±Ç</p>
<h2 id="vfsÂ±Ç">VFSÂ±Ç</h2>
<p>VFS‰∏ªË¶ÅÂêëÁî®Êà∑Á©∫Èó¥Êèê‰æõÊñá‰ª∂Á≥ªÁªüÂ±ÇÈù¢ÁöÑÊé•Âè£ÔºåÂêåÊó∂Âêë‰∏çÂêåÁöÑÊñá‰ª∂Á≥ªÁªüÂÆûÁé∞Êèê‰æõÊäΩË±°Ôºå‰Ωø‰ªñ‰ª¨ÂèØ‰ª•ÂÖ±Â≠ò„ÄÇVFSÂ∞ÜÊñá‰ª∂Á≥ªÁªüÂú®Áî®Êà∑Â±ÇÈù¢ËøõË°åÊäΩË±°Ôºå‰æø‰∫éÁî®Êà∑ÂØπÊñá‰ª∂ËøõË°åÊìç‰Ωú„ÄÇ</p>
<p>Êù•Ëá™Â∫îÁî®Á®ãÂ∫èÁöÑËØ∑Ê±ÇÂà∞ËææVFSÂêéÔºåVFS‰ºöÂàõÂª∫ÂåÖÂê´I/OËØ∑Ê±Ç‰ø°ÊÅØÁöÑÁªìÊûÑ‰ΩìÊèê‰∫§ÁªôÂùóI/OÂ±Ç„ÄÇ</p>
<p>LinuxÂú®Êñá‰ª∂Á≥ªÁªüÂ±ÇÊèê‰æõ‰∏âÁßçIOËÆøÈóÆÁöÑÂΩ¢ÂºèÔºöBuffered IO„ÄÅMMap „ÄÅDirect I/O„ÄÇ</p>
<ul>
<li>
<p>Buffered I/OÔºöËøôÁßçËÆøÈóÆÊÉÖÂÜµ‰∏ãÊñá‰ª∂Êï∞ÊçÆÈúÄË¶ÅÁªèËøáËÆæÂ§á„ÄÅPage Cache„ÄÅÁî®Êà∑ÊÄÅÁºìÂ≠òÔºåÈúÄË¶ÅËøõË°å‰∏§Ê¨°ÁöÑÊã∑Ë¥ùÂä®‰Ωú„ÄÇ</p>
</li>
<li>
<p>MMapÔºöÂÜÖÂ≠òÊò†Â∞ÑÊäÄÊúØÔºåÂ∞ÜÂÜÖÂ≠ò‰∏≠ÁöÑ‰∏ÄÈÉ®ÂàÜÁ©∫Èó¥‰∏éËÆæÂ§áËøõË°åÊò†Â∞ÑÔºå‰ΩøÂæóÂ∫îÁî®Á®ãÂ∫èËÉΩÂ§üÂêëËÆøÈóÆÊôÆÈÄöÂÜÖÂ≠ò‰∏ÄÊ†∑ÂØπÊñá‰ª∂ËøõË°åËÆøÈóÆ„ÄÇ‰ΩøÊñá‰ª∂Êï∞ÊçÆ‰ªÖÁªèËøáËÆæÂ§á„ÄÅPage CacheÂç≥ÂèØÁõ¥Êé•‰º†ÈÄíÂà∞Â∫îÁî®Á®ãÂ∫è„ÄÇ</p>
</li>
<li>
<p>Direct I/OÔºöÈááÁî®Direct IOÁöÑÊñπÂºèÂèØ‰ª•ËÆ©Áî®Êà∑ÊÄÅÁõ¥Êé•‰∏éÂùóËÆæÂ§áËøõË°åÂØπÊé•ÔºåË∑≥Ëøá‰∫ÜPage CacheÔºå‰ªéÁ°¨ÁõòÂíåÁî®Êà∑ÊÄÅ‰∏≠Êã∑Ë¥ùÊï∞ÊçÆÔºåÊèêÈ´òÊñá‰ª∂Á¨¨‰∏ÄÊ¨°ËØªÂÜôÁöÑÊïàÁéáÔºåËã•‰πãÂêéÈúÄË¶ÅÈáçÂ§çËÆøÈóÆÂêå‰∏ÄÊï∞ÊçÆÔºåÈúÄË¶ÅÊ∂àËÄóÊØîÂà©Áî®Page CacheÊõ¥Â§öÁöÑÊó∂Èó¥Ôºå‰∏ÄËà¨Áî®‰∫éÊï∞ÊçÆÂ∫ìÁ≥ªÁªü„ÄÇ</p>
</li>
</ul>
<h2 id="ÂùóioÂ±Ç">ÂùóI/OÂ±Ç</h2>
<p>Á≥ªÁªüËÉΩÂ§üÈöèÊú∫ËÆøÈóÆÂõ∫ÂÆöÂ§ßÂ∞èÁöÑÊï∞ÊçÆÁâáÁöÑËÆæÂ§áË¢´Áß∞‰∏∫ÂùóËÆæÂ§áÔºåÊúÄÂ∏∏ËßÅÁöÑÂùóËÆæÂ§á‰∏∫Á°¨ÁõòÔºàÊú∫Ê¢∞Á°¨ÁõòÔºåÂõ∫ÊÄÅÁõòÔºâÔºåÂØπÂùóËÆæÂ§áÁöÑËÆøÈóÆÈÄöÂ∏∏ÊòØÂú®ÂÖ∂ÂÜÖÈÉ®ÂÆâË£ÖÊñá‰ª∂Á≥ªÁªü„ÄÇÊìç‰ΩúÁ≥ªÁªü‰∏∫‰∫ÜÂØπÂÖ∂ËÆøÈóÆÂíå‰øùËØÅÊÄßËÉΩÔºåÈúÄË¶Å‰∏Ä‰∏™Â≠êÁ≥ªÁªüÊù•ÂØπÂùóËÆæÂ§áÂíåÂØπÂùóËÆæÂ§áÁöÑËØ∑Ê±ÇËøõË°åÁÆ°ÁêÜ„ÄÇ</p>
<h2 id="scsiÂ∫ïÂ±Ç--ËÆæÂ§áÈ©±Âä®Â±Ç">SCSIÂ∫ïÂ±Ç &amp;&amp; ËÆæÂ§áÈ©±Âä®Â±Ç</h2>
<p>ÂùóI/OÂ±ÇÂ∞ÜËØ∑Ê±ÇÂèëÂæÄSCSIÂ±ÇÔºåSCSIÂ∞±ÂºÄÂßãÁúüÂÆûÂ§ÑÁêÜËøô‰∫õIOËØ∑Ê±ÇÔºå‰ΩÜÊòØSCSIÂ±ÇÂèàÂØπÂÖ∂ÂÜÖÈÉ®ÊåâÁÖßÂäüËÉΩÂàíÂàÜ‰∫Ü‰∏çÂêåÂ±ÇÊ¨°Ôºö</p>
<ul>
<li>
<p>SCSIÈ´òÂ±ÇÔºöÈ´òÂ±ÇÈ©±Âä®Ë¥üË¥£ÁÆ°ÁêÜdiskÔºåÊé•Êî∂ÂùóI/OÂ±ÇÂèëÂá∫ÁöÑIOËØ∑Ê±ÇÔºåÊâìÂåÖÊàêSCSIÂ±ÇÂèØËØÜÂà´ÁöÑÂëΩ‰ª§Ê†ºÂºèÔºåÁªßÁª≠ÂæÄ‰∏ãÂèë</p>
</li>
<li>
<p>SCSI‰∏≠Â±ÇÔºö‰∏≠Â±ÇË¥üË¥£ÈÄöÁî®ÂäüËÉΩÔºåÂ¶ÇÈîôËØØÂ§ÑÁêÜÔºåË∂ÖÊó∂ÈáçËØïÁ≠â</p>
</li>
<li>
<p>SCSI‰ΩéÂ±ÇÔºöÂ∫ïÂ±ÇË¥üË¥£ËØÜÂà´Áâ©ÁêÜËÆæÂ§áÔºåÂ∞ÜÂÖ∂ÊäΩË±°Êèê‰æõÁªôÈ´òÂ±ÇÔºåÂêåÊó∂Êé•Êî∂È´òÂ±ÇÊ¥æÂèëÁöÑSCSIÂëΩ‰ª§Ôºå‰∫§ÁªôÁâ©ÁêÜËÆæÂ§áÂ§ÑÁêÜ</p>
</li>
</ul>
<p>Êõ¥Ê≠£ÔºöÂØπ‰∫é‰º†ÁªüÁöÑÂùóËÆæÂ§áËÄåË®ÄÔºåÊúçÂä°Âô®ÈÄöËøáSCSIÂçèËÆÆ„ÄÅSASÊé•Âè£ËøûÊé•Ôºå‰∏™‰∫∫ÁîµËÑëÈÄöËøáAHCIÂçèËÆÆ/SATAÊé•Âè£ËøûÊé•ÔºåÁõÆÂâç‰∏ªÊµÅÁöÑÂèëÂ±ïÊñπÂêë‰∏∫NVMeÂçèËÆÆ/M.2Êé•Âè£„ÄÇ</p>
<h2 id="Áâ©ÁêÜÂ§ñËÆæÂ±Ç">Áâ©ÁêÜÂ§ñËÆæÂ±Ç</h2>
<p>Âú®I/O‰∏≠‰∏ÄËà¨‰∏∫Á£ÅÁõò„ÄÅÂõ∫ÊÄÅÁ°¨ÁõòÁ≠âÂ≠òÂÇ®ËÆæÂ§á</p>
<h1 id="vfsÁÆÄ‰ªã">VFSÁÆÄ‰ªã</h1>
<h2 id="intro">Intro</h2>
<p>VFS‰∏ªË¶ÅÂêëÁî®Êà∑Á©∫Èó¥Êèê‰æõÊñá‰ª∂Á≥ªÁªüÂ±ÇÈù¢ÁöÑÊé•Âè£ÔºåÂêåÊó∂Âêë‰∏çÂêåÁöÑÊñá‰ª∂Á≥ªÁªüÂÆûÁé∞Êèê‰æõÊäΩË±°Ôºå‰Ωø‰ªñ‰ª¨ÂèØ‰ª•ÂÖ±Â≠ò„ÄÇ</p>
<p>VFSÂ∞ÜÊñá‰ª∂Á≥ªÁªüÂú®Áî®Êà∑Â±ÇÈù¢ËøõË°åÊäΩË±°Ôºå‰æø‰∫éÁî®Êà∑ÂØπÊñá‰ª∂ËøõË°åÊìç‰Ωú„ÄÇ</p>
<p>VFS‰∏≠ÊúâÂõõ‰∏™ÊúÄÈáçË¶ÅÁöÑÊï∞ÊçÆÁªìÊûÑÔºåÂàÜÂà´ÊòØdentry„ÄÅfile„ÄÅinode„ÄÅsuperblockÔºå‰∏ãÊñáÂØπ‰ªñ‰ª¨ÂàÜÂà´ËøõË°å‰ªãÁªç„ÄÇ</p>
<h2 id="directory-entry-cache-dcache">Directory Entry Cache (dcache)</h2>
<p>VFSÊèê‰æõ‰∫ÜopenÔºåstatÔºåchmodÁ≠âÁ≥ªÁªüË∞ÉÁî®ÔºåÈúÄË¶ÅÂêë‰ªñ‰ª¨Êèê‰æõÊñá‰ª∂ÁöÑË∑ØÂæÑÂêçÔºåVFS‰ºöÂú®dcache‰∏≠ÂéªÊü•ËØ¢„ÄÇ</p>
<p>dcacheÊèê‰æõ‰∫ÜÈùûÂ∏∏Âø´ÁöÑÊü•ÊâæÊú∫Âà∂Â∞ÜË∑ØÂæÑÂêçËΩ¨Êç¢Âà∞‰∏Ä‰∏™ÂÖ∑‰ΩìÁöÑdentryÁõÆÂΩïÈ°πÔºåÁºìÂ≠òÁöÑÁõÆÂΩïÈ°πÂ≠òÂÇ®Âú®RAM‰∏≠Âπ∂‰∏î‰∏ç‰ºöÊåÅ‰πÖÂåñÂà∞Á°¨Áõò„ÄÇ</p>
<p>Âú®Ê≤°ÊúâÂëΩ‰∏≠ÁºìÂ≠òÊó∂ÔºåVFS‰ºöÈÄöËøáÊü•ÊâæÂíåÂä†ËΩΩinodeÊù•ÂàõÂª∫dentryÁºìÂ≠òÔºåÊúÄÁªàÂÆûÁé∞ÂèØ‰ª•ÈÄöËøápath nameÊü•ÊâæÂà∞ÂØπÂ∫îÁöÑdentryÁõÆÂΩïÈ°π„ÄÇ</p>
<h2 id="the-inode-object">The Inode Object</h2>
<p>ÊØè‰∏™Áã¨Á´ãÁöÑdentryÈÉΩÊúâ‰∏Ä‰∏™ÊåáÂêë‰∏Ä‰∏™inodeÁöÑÊåáÈíàÔºåinode‰∏ÄËà¨‰øùÂ≠òÂú®discÔºàÂùóËÆæÂ§áÊñá‰ª∂Á≥ªÁªüÔºâ‰∏≠ÊàñËÄÖÂÜÖÂ≠ò‰∏≠ÔºàËôöÊãüÊñá‰ª∂Á≥ªÁªüÔºâ„ÄÇdisc‰∏≠ÁöÑinodeÂú®Ë¢´ËØ∑Ê±ÇÊàñ‰øÆÊîπÊó∂‰ºöÂ§çÂà∂Âà∞ÂÜÖÂ≠ò‰∏≠ÔºåÂπ∂Âú®‰øÆÊîπÂêéÂõûÂÜôÂà∞disc„ÄÇÂ§ö‰∏™dentryÂèØ‰ª•ÊåáÂêëÂêå‰∏Ä‰∏™inodeÔºàÁ°¨ÈìæÊé•Ôºâ</p>
<p>ÂØπ‰∫éÊü•ÊâæinodeÁöÑËØ∑Ê±ÇÔºåVFSÂú®Áà∂ÁõÆÂΩïÁöÑinodeË∞ÉÁî®lookupÂáΩÊï∞„ÄÇ</p>
<h2 id="the-file-object">The File Object</h2>
<p>Âú®ÊâìÂºÄ‰∏Ä‰∏™Êñá‰ª∂Êó∂ÔºåÈúÄË¶ÅÂàÜÈÖç‰∏Ä‰∏™Êñá‰ª∂ÁªìÊûÑ‰ΩìÔºàÂÜÖÊ†∏Â±ÇÈù¢ÂØπfile descriptorÁöÑÂÆûÁé∞ÔºâÔºåÁªìÊûÑ‰ΩìÂÜÖÂÆπÁöÑÂàõÂª∫ÈÄöËøádentryÊåáÈíàÊù•Ëé∑ÂèñÔºåÊñá‰ª∂ÁªìÊûÑ‰ΩìÂ≠òÂÇ®Âú®ËøõÁ®ãÁöÑÊñá‰ª∂ÊèèËø∞Á¨¶Ë°®‰∏≠„ÄÇ</p>
<p>ÂØπÊñá‰ª∂ÁöÑËØªÂÜô„ÄÅÂÖ≥Èó≠ÈÄöËøáÁî®Êà∑Á©∫Èó¥ÁöÑfdÊù•Êìç‰ΩúÊ≠£Á°ÆÁöÑÊñá‰ª∂ÁªìÊûÑ„ÄÇ</p>
<p>Âè™Ë¶ÅÊñá‰ª∂ÊâìÂºÄÔºåÂÆÉÂ∞±‰ºö‰øùÊåÅÂØπdentryÁöÑ‰ΩøÁî®Áä∂ÊÄÅÔºåËøôÂêåÊó∂ÊÑèÂë≥ÁùÄinode‰ªçÂú®‰ΩøÁî®„ÄÇ</p>
<h2 id="the-dentry-object">The Dentry Object</h2>
<p>ÁõÆÂΩïÈ°πÁ∫™ÂΩïÂ≠êÊñá‰ª∂ÂíåÂ≠êÁõÆÂΩïÁöÑÂêçÁß∞</p>
<p>ÊØè‰∏™ÁõÆÂΩïÈ°πÁöÑÁªìÊûÑ</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Á±ªÂûã</th>
<th>Â§ßÂ∞è</th>
<th>Â≠óÊÆµ</th>
<th>ÊèèËø∞</th>
</tr>
</thead>
<tbody>
<tr>
<td>__le32</td>
<td>4bytes</td>
<td>Inode</td>
<td>inodeÁºñÂè∑</td>
</tr>
<tr>
<td>__le16</td>
<td>2bytes</td>
<td>Rec_len</td>
<td>ÁõÆÂΩïÈ°πÁöÑÈïøÂ∫¶</td>
</tr>
<tr>
<td>__u8</td>
<td>2bytes</td>
<td>Name_len</td>
<td>Êñá‰ª∂ÂêçÈïøÂ∫¶</td>
</tr>
<tr>
<td>__u8</td>
<td>2bytes</td>
<td>File_type</td>
<td>Êñá‰ª∂Á±ªÂûã</td>
</tr>
<tr>
<td>char[EXT2_NAME_LEN]</td>
<td>ÊúÄÂ§ß255‰∏™Â≠óÁ¨¶</td>
<td>Name</td>
<td>Êñá‰ª∂Âêç</td>
</tr>
</tbody>
</table></div>
<p>ÊâÄÊúâÁõÆÂΩïÈÉΩÂåÖÂê´ÁöÑÁõÆÂΩïÈ°πÂåÖÊã¨ÂΩìÂâçÁõÆÂΩïÂíå‰∏äÁ∫ßÁõÆÂΩï:<code>.</code>,<code>..</code></p>
<p>Ë¶ÅÂØπÊñá‰ª∂ÂêçËøõË°å4Â≠óËäÇÂØπÈΩêÔºåÂêéÈù¢Ë°•<code>\0</code></p>
<p>ÊâÄÊúâÁõÆÂΩïÈ°πÈ°∫Â∫èÊãºÊé•ÁªÑÊàêÁõÆÂΩï‰ø°ÊÅØÔºåÂú®ËøõË°åÊü•ËØ¢Êó∂ÂèØ‰ª•‰ΩøÁî®rec_lenÊù•ËÆ°ÁÆóÂÅèÁßªÈáèÔºå‰æø‰∫éÊü•ÊâæÁõÆÂΩï‰∏≠ÁöÑÊñá‰ª∂ÔºàÈ°∫Â∫èÈÅçÂéÜÔºâ</p>
<h2 id="the-superblock-object">The SuperBlock Object</h2>
<p>superblockÂØπË±°Ë°®Á§∫‰∏Ä‰∏™ÊåÇËΩΩÁöÑÊñá‰ª∂Á≥ªÁªüÔºåÂ≠òÂÇ®ÊúâÂÖ≥Êñá‰ª∂Á≥ªÁªüÁöÑÁõ∏ÂÖ≥‰ø°ÊÅØ</p>
<h3 id="Ê≥®ÂÜåÂíåÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü">Ê≥®ÂÜåÂíåÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü</h3>
<p>‰ΩøÁî®Â¶Ç‰∏ãÁöÑAPI</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="cp">#include</span> <span class="cpf">&lt;linux/fs.h&gt;</span><span class="cp">
</span></span></span><span class="line"><span class="cl"><span class="cp"></span>
</span></span><span class="line"><span class="cl"><span class="k">extern</span> <span class="kt">int</span> <span class="nf">register_filesystem</span><span class="p">(</span><span class="k">struct</span> <span class="n">file_system_type</span> <span class="o">*</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="k">extern</span> <span class="kt">int</span> <span class="nf">unregister_filesystem</span><span class="p">(</span><span class="k">struct</span> <span class="n">file_system_type</span> <span class="o">*</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Êñá‰ª∂Á≥ªÁªüÁöÑÊåÇËΩΩÂèØ‰ª•ÈÄöËøá<code>-&gt;mount()</code>ÊñπÊ≥ïÂ∞ÜÊñ∞ÁöÑÊñá‰ª∂Á≥ªÁªüÊåÇËΩΩÂà∞ÊåÇËΩΩÁÇπÔºåÂΩìpathnameËß£ÊûêËß£ÊûêÂà∞ÊåÇËΩΩÁÇπÊó∂Ôºå‰ºöË∑≥ËΩ¨Âà∞Ë¢´ÊåÇÂú®Êñá‰ª∂Á≥ªÁªüÁöÑroot„ÄÇ</p>
<p>ÂÜÖÊ†∏ÊâÄÊ≥®ÂÜåÁöÑÊñá‰ª∂Á≥ªÁªüÂú®<code>/proc/filesystems</code>Êñá‰ª∂‰∏≠</p>
<p><code>file_system_type</code>ÁªìÊûÑÁöÑÂÆö‰πâÂ¶Ç‰∏ã</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">file_system_type</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="kt">int</span> <span class="n">fs_flags</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">struct</span> <span class="n">dentry</span> <span class="o">*</span><span class="p">(</span><span class="o">*</span><span class="n">mount</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">file_system_type</span> <span class="o">*</span><span class="p">,</span> <span class="kt">int</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                 <span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="p">,</span> <span class="kt">void</span> <span class="o">*</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">kill_sb</span><span class="p">)</span> <span class="p">(</span><span class="k">struct</span> <span class="n">super_block</span> <span class="o">*</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">struct</span> <span class="n">module</span> <span class="o">*</span><span class="n">owner</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">struct</span> <span class="n">file_system_type</span> <span class="o">*</span> <span class="n">next</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">struct</span> <span class="n">list_head</span> <span class="n">fs_supers</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">struct</span> <span class="n">lock_class_key</span> <span class="n">s_lock_key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="k">struct</span> <span class="n">lock_class_key</span> <span class="n">s_umount_key</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="p">};</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><code>mount()</code>ÊñπÊ≥ïÊúâ‰ª•‰∏ãÂá†‰∏™ÂèÇÊï∞</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-c" data-lang="c"><span class="line"><span class="cl"><span class="k">struct</span> <span class="n">file_system_type</span> <span class="o">*</span><span class="n">fs_type</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">flags</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="k">const</span> <span class="kt">char</span> <span class="o">*</span><span class="n">dev_name</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="kt">void</span> <span class="o">*</span><span class="n">data</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h1 id="page-cache">Page Cache</h1>
<p>‚Äã	È°µÈ´òÈÄüÁºìÂ≠ò(Page Cache)ÊòØLinuxÂÜÖÊ†∏ÊâÄ‰ΩøÁî®ÁöÑ‰∏ªË¶ÅÁ°¨ÁõòÈ´òÈÄüÁºìÂ≠ò„ÄÇÂú®ÁªùÂ§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåÂÜÖÊ†∏Âú®ËØªÂÜôÁ°¨ÁõòÊó∂ÈÉΩÂºïÁî®È°µÈ´òÈÄüÁºìÂ≠ò„ÄÇÊñ∞È°µË¢´ËøΩÂä†Âà∞È°µÈ´òÈÄüÁºìÂ≠ò‰ª•Êª°Ë∂≥Áî®Êà∑ÊÄÅËøõÁ®ãÁöÑËØªËØ∑Ê±Ç„ÄÇÂ¶ÇÊûúÈ°µ‰∏çÂú®È´òÈÄüÁºìÂ≠ò‰∏≠ÔºåÊñ∞È°µÂ∞±Ë¢´Âä†Âà∞È´òÈÄüÁºìÂ≠ò‰∏≠ÔºåÁÑ∂ÂêéÁî®‰ªéÁ°¨ÁõòËØªÂá∫ÁöÑÊï∞ÊçÆÂ°´ÂÖÖÂÆÉ „ÄÇ Â¶Ç ÊûúÂÜÖÂ≠òÊúâË∂≥Â§üÁöÑÁ©∫Èó≤Á©∫Èó¥ ÔºåÂ∞±ËÆ©ËØ•È°µÂú®È´òÈÄüÁºìÂ≠ò‰∏≠ÈïøÊúü‰øùÁïô Ôºå‰ΩøÂÖ∂‰ªñËøõÁ®ãÂÜç‰ΩøÁî®ËØ•È°µÊó∂‰∏çÂÜçËÆøÈóÆÁ°¨Áõò„ÄÇ</p>
<p>‚Äã	ÂêåÊó∂Ôºå Âú®Êää‰∏ÄÈ°µÊï∞ÊçÆÂÜôÂà∞ÂùóËÆæÂ§á‰πãÂâçÔºåÂÜÖÊ†∏È¶ñÂÖàÊ£ÄÊü•ÂØπÂ∫îÁöÑÈ°µÊòØÂê¶Â∑≤ÁªèÂú®È´òÈÄüÁºìÂ≠ò‰∏≠Ôºå Â¶ÇÊûú‰∏çÂú®ÔºåÂ∞±Ë¶ÅÂÖàÂú®ÂÖ∂‰∏≠Â¢ûÂä† ‰∏Ä‰∏™Êñ∞È°πÔºåÂπ∂Áî®Ë¶ÅÂÜôÂà∞Á°¨Áõò‰∏≠ÁöÑÊï∞ÊçÆÂ°´ÂÖÖËØ•È°π„ÄÇI/OÊï∞ÊçÆÁöÑ‰º†ÈÄÅÂπ∂‰∏çÊòØÈ©¨ ‰∏äÂºÄÂßãÔºåËÄåÊòØË¶ÅÂª∂ËøüÂá†Áßí‰πãÂêéÊâçÂØπÁ°¨ÁõòËøõË°åÊõ¥Êñ∞Ôºå‰ªéËÄå‰ΩøËøõÁ®ãÊúâÊú∫‰ºöÂØπË¶ÅÂÜô‰∫∫Á°¨ÁõòÁöÑÊï∞ÊçÆÂÅöËøõ ‰∏ÄÊ≠•ÁöÑ‰øÆÊîπ (ÂÜÖÊ†∏ÊâßË°åÂª∂ËøüÁöÑÂÜôÊìç‰Ωú)„ÄÇ</p>
<p>‚Äã	Âá†‰πéÊâÄÊúâÁöÑËØªÂÜôÈÉΩ‰æùËµñPage CacheÔºåÈô§ÈùûÊåáÂÆö‰∫ÜO_DIRECTÊ†áÂøó‰ΩçÔºåÊ≠§Êó∂I/OÂ∞Ü‰ΩøÁî®ËøõÁ®ãÁî®Êà∑ÊÄÅÂú∞ÂùÄÁ©∫Èó¥ÁöÑÁºìÂÜ≤Âå∫Ôºå‰∏ÄËà¨Êï∞ÊçÆÂ∫ìÂ∫îÁî®‰ºö‰ΩøÁî®Ê≠§ÊñπÂºè„ÄÇ</p>
<p>‚Äã	ÂØπPage Cache‰∏≠È°µÁöÑËØÜÂà´ÈÄöËøáÁ¥¢ÂºïËäÇÁÇπÂíåÂú®Áõ∏Â∫îÊñá‰ª∂‰∏≠ÁöÑÂÅèÁßªÈáèÊù•ÂÆûÁé∞„ÄÇ</p>
<h2 id="‰∏ªË¶ÅÊï∞ÊçÆÁªìÊûÑ">‰∏ªË¶ÅÊï∞ÊçÆÁªìÊûÑ</h2>
<p>‚Äã	Page Cache‰∏≠ÁöÑÊ†∏ÂøÉÊï∞ÊçÆÁªìÊûÑÊòØ<code>address_space</code>ÔºåËØ•ÂØπË±°Âú®È°µÈù¢ÊâÄÂ±ûÁöÑinode‰∏≠ÔºåÁî±‰∫éÂ§ö‰∏™È°µÈù¢ÂèØËÉΩÂ±û‰∫éÂêå‰∏Ä‰∏™ÊâÄÊúâËÄÖÔºåÂõ†Ê≠§Â§ö‰∏™È°µÈù¢ÂèØËÉΩË¢´ËøûÊé•Âà∞Âêå‰∏Ä‰∏™address spaceÔºåËØ•ÂØπË±°ÂêåÊó∂ËøòÂ∞ÜÊâÄÊúâËÄÖÁöÑÈ°µÈù¢ÂíåÂØπÈ°µÈù¢ÁöÑÊìç‰ΩúÂª∫Á´ãËøûÊé•„ÄÇ</p>
<p>ÊúâÂÖ≥È°µÈù¢ÁöÑÊìç‰Ωú‰∏ªË¶ÅÊúâ‰ª•‰∏ãÂá†‰∏™Ôºö</p>
<ul>
<li>==writepage== ÂÜôÊìç‰ΩúÔºåÂ∞ÜÈ°µÂÜôÂÖ•Âà∞Á°¨ÁõòÊò†ÂÉè</li>
<li>==readpage== ËØªÊìç‰ΩúÔºåÂ∞ÜÊï∞ÊçÆ‰ªéÁ°¨ÁõòÊò†ÂÉèÂä†ËΩΩÂà∞È°µ</li>
<li>sync_page Âú®ÊâÄÊúâËÄÖÁöÑÈ°µÈù¢Â∑≤ÁªèÂáÜÂ§áÂ∞±Áª™ÂêéÔºåÂêØÂä®I/OÊï∞ÊçÆÁöÑ‰º†Ëæì</li>
<li>wirtepages ÊääÊåáÂÆöÊï∞ÈáèÁöÑÊâÄÊúâËÄÖËÑèÈ°µÂÜôÂõûÁ°¨Áõò</li>
<li>==prepare_write== ‰∏∫ÂÜôÊìç‰ΩúÂÅöÂáÜÂ§áÔºàÁ°¨ÁõòÊñá‰ª∂Á≥ªÁªü‰ΩøÁî®Ôºâ</li>
<li>==commit_write== ÂÆåÊàêÂÜôÊìç‰ΩúÔºàÁ°¨ÁõòÊñá‰ª∂Á≥ªÁªü‰ΩøÁî®Ôºâ</li>
<li>&hellip;</li>
</ul>
<h2 id="Âü∫Êï∞Ê†ë-radix-tree">Âü∫Êï∞Ê†ë Radix Tree</h2>
<p>Âü∫Êï∞Ê†ëÁ±ª‰ºº‰∫éÂ≠óÂÖ∏Ê†ëÔºåÈÄöËøáË¶ÅÊü•ÊâæÁöÑIDÁöÑ‰∫åËøõÂà∂Â∫èÂàóÔºåÊù•‰∏ÄÁ∫ß‰∏ÄÁ∫ßÁöÑËøõË°åÊü•ÊâæÔºå‰∏∫‰∫ÜÂáèÂ∞ëÊ†ëÁöÑÈ´òÂ∫¶ÂíåÂè∂Â≠êÈùûÁªìÁÇπ‰∏™Ê†ëÔºåÂèØ‰ª•‰ΩøÁî®2 bitÊàñËÄÖ4 bit‰Ωú‰∏∫Ê†ëÁöÑÁªìÁÇπ„ÄÇ</p>
<p>Âú®ÂÜÖÊ†∏‰∏≠ÔºåRadix TreeÁöÑÂè∂Â≠êÁªìÁÇπ‰øùÂ≠ò‰∫ÜÊåáÂêëÊâÄÊúâËÄÖÈ°µÊèèËø∞Á¨¶ÁöÑÊåáÈíà„ÄÇ</p>
<p>Page Cache ‰∏≠ÁöÑÊØè‰∏™Êñá‰ª∂ÈÉΩÊòØ‰∏ÄÊ£µÂü∫Êï∞Ê†ëÔºàradix treeÔºåÊú¨Ë¥®‰∏äÊòØÂ§öÂèâÊêúÁ¥¢Ê†ëÔºâÔºåÊ†ëÁöÑÊØè‰∏™ËäÇÁÇπÈÉΩÊòØ‰∏Ä‰∏™È°µ„ÄÇ</p>
<p>ÂÜÖÊ†∏ÈÄöËøáÊääÈ°µÁ¥¢ÂºïËΩ¨Êç¢‰∏∫Radix Tree‰∏≠ÁöÑË∑ØÂæÑÔºå‰ΩøÁî®Radix TreeÊù•Âø´ÈÄüÊêúÁ¥¢È°µÊèèËø∞Á¨¶ÊâÄÂú®ÁöÑ‰ΩçÁΩÆ„ÄÇÂÜÖÊ†∏ÈÄöËøáÈ°µÊèèËø∞Á¨¶ÂèØ‰ª•Á°ÆÂÆöÈ°µÈù¢ÊòØÂê¶‰∏∫Á≠âÂæÖÂà∑Êñ∞Âà∞Á°¨ÁõòÁöÑËÑèÈ°µÊàñÂÖ∂‰∏≠Êï∞ÊçÆÁöÑI/O‰º†ËæìÊòØÂê¶Ê≠£Âú®ËøõË°å„ÄÇ</p>
<p>Radix Tree‰∏≠ÁöÑÊØè‰∏Ä‰∏™Âè∂Â≠êËäÇÁÇπÊåáÂêëÊñá‰ª∂ÂÜÖÁõ∏Â∫îÂÅèÁßªÊâÄÂØπÂ∫îÁöÑCacheÈ°π</p>
<img src="/img/image-20221101143123364.png" alt="image-20221101143123364" style="zoom:50%;" />
<h2 id="page-cacheÂ§ÑÁêÜÂáΩÊï∞">Page CacheÂ§ÑÁêÜÂáΩÊï∞</h2>
<h3 id="find_get_page">find_get_page()</h3>
<p>‰º†ÂÖ• address spaceÂØπË±°ÊåáÈíàÂíå‰æøÂÆú‰∫ÜÔºåËé∑ÂèñËá™ÊóãÈîÅÔºåÂú®Radix Tree‰∏≠ÊêúÁ¥¢ÂÖ∑ÊúâÊåáÂÆöÂÅèÁßªÈáèÁöÑÂè∂Â≠êÁªìÁÇπÔºåËã•ÊàêÂäüÊâæÂà∞Ôºå‰ºöÂ¢ûÂä†È°µÈù¢‰ΩøÁî®ËÆ°Êï∞Âô®ÔºåÈáäÊîæËá™ÊóãÈîÅÔºåÂπ∂ËøîÂõûÈ°µÊèèËø∞Á¨¶ÁöÑÊåáÈíàÔºåÂê¶ÂàôÂ∞ÜÈáäÊîæËá™ÊóãÈîÅÂπ∂ËøîÂõûNULL„ÄÇ</p>
<h3 id="add_to_page_cache">add_to_page_cache()</h3>
<p>‰º†ÂÖ•È°µÊèèËø∞Á¨¶Âú∞ÂùÄÔºåaddress spaceÂØπË±°ÁöÑaddress mappingÂ≠óÊÆµÔºåÈ°µÁ¥¢ÂºïÂú®Âú∞ÂùÄÁ©∫Èó¥ÁöÑÂÅèÁßªÈáèÔºå‰∏∫Radix TreeÂàÜÈÖçÊñ∞ËäÇÁÇπÊâÄ‰ΩøÁî®ÁöÑÂÜÖÂ≠òÂàÜÈÖçÊ†áÂøógfp_maskÔºåÊèíÂÖ•ÊàêÂäüÂàôËøîÂõû0</p>
<h3 id="remove_from_page_cache">remove_from_page_cache()</h3>
<p>Ëé∑ÂèñËá™ÊóãÈîÅ„ÄÅÂÖ≥Èó≠‰∏≠Êñ≠ÂêéÂú®Radix Tree‰∏≠Âà†Èô§ËäÇÁÇπÔºåËøîÂõûÂà†Èô§È°µÁöÑÊèèËø∞Á¨¶ÊåáÈíàÔºåpage-&gt;mappingÂ≠óÊÆµËÆæÁΩÆ‰∏∫NULLÔºåÂ∞ÜÊâÄÁºìÂ≠òÈ°µÁöÑpage-&gt;mapping-&gt;nrpagesËÆ°Êï∞Âô®ÂÄºÂáè1ÔºåÊúÄÂêéÈáäÊîæËá™ÊóãÈîÅÔºåÊâìÂºÄ‰∏≠Êñ≠„ÄÇ</p>
<h3 id="read_cache_page">read_cache_page()</h3>
<p>Á°Æ‰øùPage Cache‰∏≠ÂåÖÊã¨ÊåáÂÆöÈ°µÁöÑÊúÄÊñ∞ÁâàÊú¨ÔºåÈ¶ñÂÖàÊ£ÄÊü•È°µÈù¢ÊòØÂê¶Â≠òÂú®ÔºåËã•‰∏çÂ≠òÂú®ÂàôÊñ∞Áî≥ËØ∑ÂàÜÈÖçÁ©∫Èó¥ÔºåË∞ÉÁî®add_to_page_cacheÊèíÂÖ•Áõ∏Â∫îÁöÑÈ°µÊèèËø∞Á¨¶ÔºåË∞ÉÁî®lru cache addÊèíÂÖ•Âà∞ËØ•Âú∞ÂùÄÁ©∫Èó¥ÁöÑÈùûÊ¥ªË∑ÉLRUÈìæË°®‰∏≠„ÄÇ</p>
<p>Âú®‰øùËØÅÈ°µÈù¢Â≠òÂú®‰∫éPage CacheÂêéÔºå‰ΩøÁî®mark page accessedËÆ∞ÂΩïÈ°µÈù¢Â∑≤ÁªèË¢´ËÆøÈóÆËøáÔºåËã•PG_uptodateÊ†áÂøó‰Ωç0ÔºåÂàôÈ°µÈù¢‰∏çÊòØÊúÄÊñ∞ÁöÑÔºåÈúÄË¶Å‰ªéÁ°¨ÁõòÈáçÊñ∞ËØªÂèñËØ•È°µ</p>
<h2 id="buffer-cache">Buffer Cache</h2>
<p>Âú®LinuxÂÜÖÊ†∏2.4ÁâàÊú¨‰πãÂâçÔºåBuffer CacheÂíåPage CacheÊòØÁã¨Á´ãÁöÑÔºåÂõ†‰∏∫Êìç‰ΩúÁ≥ªÁªüÂØπÁ°¨ÁõòÁ≠âÂùóËÆæÂ§áÁöÑËØªÂÜôÊòØÂü∫‰∫éÂùóÁöÑÔºåËÄåÈùûÈ°µÔºåÊñá‰ª∂ÁöÑÊï∞ÊçÆÂú®Page Cache‰∏≠ÁºìÂ≠òÔºåÁ°¨ÁõòÁöÑÂùóÊï∞ÊçÆÂú®Buffer Cache‰∏≠ÁºìÂ≠ò„ÄÇ‰ΩÜÊòØËøôÁßçË°®Á§∫ÊñπÂºèÊïàÁéáÈùûÂ∏∏‰ΩéÔºåËá™2.4ÁâàÊú¨ÁöÑÂÜÖÊ†∏ÂºÄÂßãÔºå‰∫åËÄÖÂºÄÂßãÁªü‰∏ÄË°®Á§∫„ÄÇ</p>
<p>Âõ†‰∏∫VFSÂíåÊñá‰ª∂Á≥ªÁªüÈÉΩÊòØÈÄöËøáÂùóBlockÊù•ÁªÑÁªáÁ°¨Áõò‰∏äÁöÑÊï∞ÊçÆÔºåÂõ†Ê≠§Buffer CacheÂøÖÈ°ªÂ≠òÂú®ÔºåÁõÆÂâçÂÆÉ‰Ωú‰∏∫Buffer PageÂ≠òÂÇ®Âú®ÁâπÂÆöÁöÑÈ°µ‰∏≠„ÄÇ</p>
<p>ÂØπ‰∫éÊñá‰ª∂ËøôÁßçÈÄöËøáPage CacheÊù•Ë°®Á§∫ÁöÑÊï∞ÊçÆÔºåÈÄöËøáPage CacheÊù•Ë°®Á§∫Buffer CacheÔºåËÄåÂØπ‰∫éÊñá‰ª∂ÁöÑmetadataÔºåÁõ¥Êé•‰ΩøÁî®Buffer CacheÊù•Ë°®Á§∫„ÄÇ</p>
<h2 id="ËÑèÈ°µÁöÑÂ§ÑÁêÜ">ËÑèÈ°µÁöÑÂ§ÑÁêÜ</h2>
<p>Âú®ËøõÁ®ã‰øÆÊîπ‰∫ÜÈ°µÈù¢Êï∞ÊçÆÂêéÔºåËØ•È°µÈù¢Â∞±Êàê‰∏∫‰∫ÜËÑèÈ°µÔºåÂπ∂Â∞ÜËÑèÈ°µÂà∑Êñ∞Âà∞ÂùóËÆæÂ§á‰∏äÁöÑÊìç‰ΩúÂª∂ËøüÔºåËøôÊ†∑ÂèØ‰ª•ÊòæËëóÊèêÈ´òÁ≥ªÁªüÁöÑÊÄßËÉΩ„ÄÇ</p>
<p>‰∏∫‰∫ÜÈò≤Ê≠¢Á°¨‰ª∂ÈîôËØØ„ÄÅÊéâÁîµÁ≠âÊÉÖÂÜµÂØºËá¥RAMÂÜÖÂÆπÁöÑ‰∏¢Â§±Ôºå‰ª•ÂèäRAMÂÆπÈáèËøáÂ§ßÁöÑÈúÄÊ±ÇÔºåÂú®‰ª•‰∏ãÊÉÖÂÜµ‰∏ªÂä®Âà∑Êñ∞ËÑèÈ°µÂà∞Á°¨Áõò‰∏≠Ôºö</p>
<ul>
<li>Page CacheÂ§™Êª°ÔºåÊàñËÑèÈ°µÊï∞ÈáèÂ§™Â§ö</li>
<li>ËÑèÈ°µÂ∑≤ÁªèÂ≠òÂú®‰∫ÜËæÉÈïøÁöÑÊó∂Èó¥</li>
<li>ËøõÁ®ãËØ∑Ê±ÇÂØπÂùóËÆæÂ§áÊàñÊñá‰ª∂ÁöÑÂèòÂåñËøõË°åÂà∑Êñ∞Ôºàsync„ÄÅfsyncÂíåfdatasyncÁ≥ªÁªüË∞ÉÁî®Ôºâ</li>
</ul>
<h1 id="Êñá‰ª∂ÁöÑËÆøÈóÆ">Êñá‰ª∂ÁöÑËÆøÈóÆ</h1>
<p>Êñá‰ª∂ÁöÑËÆøÈóÆ‰∏ÄËà¨Êúâ‰∫îÁßçÊ®°ÂºèÔºö</p>
<ul>
<li>==ËßÑËåÉÊ®°Âºè==ÔºöÁî±Á≥ªÁªüË∞ÉÁî®readÂíåwriteÊù•ËØªÂÜôÔºåreadÂ∞ÜÈòªÂ°ûË∞ÉÁî®ËøõÁ®ãÔºåÁõ¥Âà∞Êï∞ÊçÆË¢´Êã∑Ë¥ùÂà∞Áî®Êà∑Âú∞ÂùÄÁ©∫Èó¥ÔºåwriteÂàôÂú®Êï∞ÊçÆÊã∑Ë¥ùÂà∞Page CacheÂêéÁ´ãÂç≥ÁªìÊùü</li>
<li>==ÂêåÊ≠•Ê®°Âºè==Ôºö<code>O_SYNC</code>Ê†áÂøó‰∏∫1ÔºåÂΩ±ÂìçÂÜôÊìç‰ΩúÔºàËØªÊìç‰ΩúÊÄªÊòØÈòªÂ°ûÁöÑÔºâÔºåÂ∞ÜÈòªÂ°ûÂÜôÊìç‰ΩúÔºåÁõ¥Âà∞Êï∞ÊçÆË¢´ÊúâÊïàÁöÑÂÜôÂÖ•Á°¨Áõò„ÄÇ</li>
<li>==ÂÜÖÂ≠òÊò†Â∞ÑÊ®°Âºè==ÔºöÊñá‰ª∂ÊâìÂºÄÂêéÔºåÈÄöËøáÁ≥ªÁªüË∞ÉÁî®<code>mmap</code>Â∞ÜÊñá‰ª∂Êò†Â∞ÑÂà∞ÂÜÖÂ≠ò‰∏≠ÔºåÊ≠§ÂêéÊñá‰ª∂Êàê‰∏∫ÂÆåÂÖ®‰øùÂ≠òÂú®RAM‰∏≠ÁöÑÂ≠óËäÇÊï∞ÁªÑ„ÄÇ</li>
<li>==Áõ¥Êé•I/OÊ®°Âºè==ÔºöO_DIRECTÊ†áÂøó‰∏∫1Ôºå‰ªª‰ΩïËØªÂÜôÊìç‰ΩúÈÉΩÂú®Áî®Êà∑Âú∞ÂùÄÁ©∫Èó¥ÂíåÁ°¨ÁõòÈó¥ËøõË°å‰º†ËæìÔºåÁõ¥Êé•Ë∑≥ËøáPage Cache„ÄÇ</li>
<li>==ÂºÇÊ≠•Ê®°Âºè==ÔºöËØ•Ê®°Âºè‰∏ãÔºåÊñá‰ª∂ÂèØ‰ª•ÈÄöËøá‰∏ÄÁªÑPOSIX APIÊàñËÄÖLinuxÁ≥ªÁªüË∞ÉÁî®Êù•ËøõË°åËÆøÈóÆÔºåÂºÇÊ≠•Ê®°Âºè‰∏ãÊï∞ÊçÆ‰º†ËæìËØ∑Ê±Ç‰∏çÈòªÂ°ûË∞ÉÁî®ÁöÑËøõÁ®ãÔºåËÄåÊòØÂú®ÂêéÂè∞ÊâßË°å„ÄÇ</li>
</ul>
<h2 id="ËØªÊñá‰ª∂">ËØªÊñá‰ª∂</h2>
<p>ÂÜÖÊ†∏ÂÆûÁé∞‰∫Ü<code>read()</code>Á≥ªÁªüË∞ÉÁî®‰∏∫ËøõÁ®ãÊèê‰æõÊñá‰ª∂ÁöÑËØªÂèñÂäüËÉΩÔºåÂÖ•Âè£‰∏∫<code>sys_read()</code>ÈúÄË¶ÅÊèê‰æõ‰∏â‰∏™ÂèÇÊï∞</p>
<ul>
<li>Êñá‰ª∂ÊèèËø∞Á¨¶</li>
<li>‰øùÂ≠òÊï∞ÊçÆÁöÑÁºìÂÜ≤Âå∫</li>
<li>ËØªÂèñÂ≠óÁ¨¶Êï∞ÁõÆÁöÑÈïøÂ∫¶</li>
</ul>
<p>ÂØπ‰∫éVFSËÄåË®ÄÔºåÈ¶ñÂÖàÊ†πÊçÆÊñá‰ª∂ÊèèËø∞Á¨¶ÁºñÂè∑ÔºåÂÜÖÊ†∏(‰ΩøÁî®<code>fs/file_table.c</code>‰∏≠ÁöÑ<code>fget_light()</code>ÂáΩÊï∞)‰ªéËøõÁ®ãÁöÑ <code>task_struct</code>‰∏≠ÊâæÂà∞‰∏é‰πãÁõ∏ÂÖ≥ÁöÑÊñá‰ª∂ÂÆû‰æãÔºå<code>file_pos_read()</code>ÂáΩÊï∞Á°ÆÂÆöËØªÂèñÂΩìÂâçÊñá‰ª∂ÁöÑ‰ΩçÁΩÆÔºåÂπ∂ËøîÂõû‰∏Ä‰∏™ÂèÇÊï∞<code>file-&gt;file_pos</code>ÔºåÂÆûÈôÖÁöÑËØªÂèñÊìç‰ΩúÈÄöËøá<code>vfs_read()</code>ÂáΩÊï∞Êù•ÊâßË°åÔºåËØ•ÂáΩÊï∞‰ºöÂà§Êñ≠Êñá‰ª∂ÊòØÂê¶Êúâ<code>file-&gt;f_op-&gt;read</code>ÊñπÊ≥ïÔºå‰ªéËÄåÁ°ÆÂÆöÂêéÁª≠‰ΩøÁî®ÁöÑÂáΩÊï∞ÔºåËã•‰∏çÂ≠òÂú®Âàô‰ºöË∞ÉÁî®<code>do_sync_read</code>ÂáΩÊï∞„ÄÇÊúÄÂêéÈÄöËøá<code>file_pos_write</code>ÂáΩÊï∞Êù•ËÆ∞ÂΩïÊñá‰ª∂Êñ∞ÁöÑËØªÂÜô‰ΩçÁΩÆÔºåÈÄöËøá‰øÆÊîπ<code>file_ops</code>ÁöÑÂÄºÊù•ÂÆûÁé∞„ÄÇ</p>
<p><img src="/img/image-20221022151840698.png"
	
	
	
	loading="lazy"
	
		alt="image-20221022151840698"
	
	
></p>
<p>‰∏∫‰∫ÜÊèêÈ´òÂú®Êñá‰ª∂ËØªÂèñÊó∂ÁöÑÊÄßËÉΩÔºåLinux kernelÊèê‰æõ‰∫ÜÁºìÂÜ≤Âå∫ÂíåÁºìÂÜ≤Á≥ªÁªü„ÄÇ</p>
<p>LinuxÂØπÊñá‰ª∂ÁöÑËØªÊòØÂü∫‰∫éÈ°µÁöÑÔºåÂÜÖÊ†∏ÊÄªÊòØ‰∏ÄÊ¨°‰º†ÈÄÅÂá†‰∏™ÂÆåÊï¥ÁöÑÊï∞ÊçÆÈ°µ„ÄÇËã•ÂèëËµ∑readË∞ÉÁî®Êó∂Êï∞ÊçÆ‰∏çÂú®RAM‰∏≠ÔºåÂÜÖÊ†∏ÂàôÂàÜÈÖç‰∏Ä‰∏™Êñ∞ÁöÑpage frameÔºåÂπ∂Ë∞ÉÂèñÊñá‰ª∂ÁöÑÁõ∏Â∫îÈÉ®ÂàÜÂ°´ÂÖ•ÂÖ∂‰∏≠ÔºåÂ∞ÜÂÖ∂Âä†ÂÖ•Âà∞Page Cache‰∏≠ÔºåÊúÄÂêéÊääËØ∑Ê±ÇÁöÑÊï∞ÊçÆÊã∑Ë¥ùÂà∞ËøõÁ®ãÁöÑÂú∞ÂùÄÁ©∫Èó¥„ÄÇ</p>
<p>Â§ßÂ§öÊï∞Á°¨ÁõòÊñá‰ª∂Á≥ªÁªüÔºå‰ΩøÁî®ÈÄöÁî®ÂáΩÊï∞generic_file_readÊù•ÂÆûÁé∞readÁ≥ªÁªüË∞ÉÁî®„ÄÇ</p>
<h3 id="generic_file_read">generic_file_read()</h3>
<p>ËØ•ÂáΩÊï∞ÊúâÂ¶Ç‰∏ãÂá†‰∏™ÂèÇÊï∞Ôºö</p>
<ul>
<li>filp Êñá‰ª∂ÂØπË±°ÁöÑÂú∞ÂùÄ</li>
<li>buf Áî®Êà∑ÊÄÅÂÜÖÂ≠òÂå∫ÂüüÁöÑÁ∫øÊÄßÂú∞ÂùÄÔºåÁî®‰∫éÂ≠òÊîæËØªÂèñÂá∫ÁöÑÊñá‰ª∂Êï∞ÊçÆ</li>
<li>count ËØªÂèñÂ≠óÁ¨¶ÁöÑ‰∏™Êï∞</li>
<li>ppos Â≠òÊîæËØªÊìç‰ΩúÂºÄÂßãÂ§ÑÁöÑÊñá‰ª∂ÂÅèÁßªÈáèÔºå‰∏ÄËà¨‰∏∫<code>filp-&gt;f_pos</code></li>
</ul>
<p>È¶ñÂÖàÔºåÂáΩÊï∞ÂàùÂßãÂåñ‰∏§‰∏™ÊèèËø∞Á¨¶Ôºö</p>
<ul>
<li>Â±ÄÈÉ®ÂèòÈáèiovecÁ±ªÂûãÁöÑlocal_iovÔºåÂåÖÂê´bufÂíåcountÂ≠óÊÆµ</li>
<li>Â±ÄÈÉ®ÂèòÈáèkiocbÁ±ªÂûãÁöÑkiocbÔºåË∑üË∏™Ê≠£Âú®ËøõË°åÁöÑÂêåÊ≠•ÂíåÂºÇÊ≠•I/OÊìç‰ΩúÁöÑÂÆåÊàêÁä∂ÊÄÅ</li>
</ul>
<p>ÁÑ∂ÂêéË∞ÉÁî®<code>__generic_file_aio_read()</code>Ëé∑Âèñ‰∏äÈù¢‰∏§‰∏™ÊèèËø∞Á¨¶ÁöÑÂú∞ÂùÄÔºåËøîÂõûÂÄºÊó∂Êñá‰ª∂ÊúâÊïàËØªÂÖ•ÁöÑÂ≠óËäÇÊï∞ÔºåÂú®ËØ•ÂáΩÊï∞ËøîÂõûÂêéÔºå<code>generic_file_read()</code>‰πüÂ∞ÜÁªàÊ≠¢„ÄÇ</p>
<h3 id="__generic_file_aio_read">__generic_file_aio_read()</h3>
<p>Êé•Êî∂Âõõ‰∏™ÂèÇÊï∞Ôºö</p>
<ul>
<li>kiocbÊèèËø∞Á¨¶Âú∞ÂùÄÔºöiocb</li>
<li>iovecÊèèËø∞Á¨¶Êï∞ÁªÑÁöÑÂú∞ÂùÄÔºöiovÔºàÊèèËø∞Á≠âÂæÖÊé•Êî∂Êï∞ÊçÆÁöÑÁî®Êà∑ÊÄÅÁºìÂÜ≤Âå∫Ôºâ</li>
<li>iovecÊèèËø∞Á¨¶Êï∞ÁªÑÁöÑÈïøÂ∫¶</li>
<li>Â≠òÊîæÊñá‰ª∂ÂΩìÂâçÊåáÈíàÁöÑÂèòÈáèÂú∞ÂùÄÔºöppos</li>
</ul>
<p>ËØ•ÂáΩÊï∞Âú®ÂØπPage CachËß¶ÂèëreadÊó∂ÁöÑÊâßË°åËøáÁ®ãÔºö</p>
<ol>
<li>Ë∞ÉÁî®access_ok()Êù•Ê£ÄÊü•iovecÊèèËø∞ÁöÑÁî®Êà∑ÊÄÅÁºìÂÜ≤Âå∫ÊòØÂê¶ÂêàÊ≥ï</li>
<li>Âª∫Á´ãËØªÊìç‰ΩúÊèèËø∞Á¨¶ÔºåÂ≠òÊîæ‰∏éÁî®Êà∑ÁºìÂÜ≤Âå∫ÊúâÂÖ≥ÁöÑ„ÄÅÊ≠£Âú®ËøõË°åÁöÑÊñá‰ª∂Êìç‰ΩúÁöÑÁä∂ÊÄÅ</li>
<li>Ë∞ÉÁî®<code>do_generic_file_read()</code>ÔºåÁªôÂÆöÂèÇÊï∞Êñá‰ª∂ÂØπË±°ÊåáÈíàfilpÔºåÊñá‰ª∂ÂÅèÁßªÈáèÊåáÈíàpposÔºåËØªÊìç‰ΩúÊèèËø∞Á¨¶Âú∞ÂùÄ„ÄÅÂáΩÊï∞file_read_actor()ÁöÑÂú∞ÂùÄ</li>
<li>ËøîÂõûÊã∑Ë¥ùÂà∞Áî®Êà∑ÊÄÅÁºìÂÜ≤Âå∫ÁöÑÂ≠óËäÇÊï∞ÔºåÂØπÂ∫îËØªÊìç‰ΩúÊèèËø∞Á¨¶ÁöÑwrittenÂ≠óÊÆµ</li>
</ol>
<p>do_generic_file_read()</p>
<h2 id="ÂÜôÊµÅÁ®ã">ÂÜôÊµÅÁ®ã</h2>
<p>‚Äã	ÂæàÂ§öÁ°¨ÁõòÊñá‰ª∂Á≥ªÁªüÈÄöËøáÈÄöÁî®ÂáΩÊï∞generic_file_writeÂÆûÁé∞writeÊñπÊ≥ï„ÄÇwriteÁ≥ªÁªüË∞ÉÁî®Ë¥üË¥£Â∞ÜÁî®Êà∑Âú∞ÂùÄÁ©∫Èó¥‰∏≠ÁöÑÊï∞ÊçÆÁßªÂä®Âà∞ÂÜÖÊ†∏Êï∞ÊçÆÁªìÊûÑ‰∏≠ÔºåÁÑ∂ÂêéÂ∞ÜÊï∞ÊçÆÊã∑Ë¥ùÂà∞Page Cache‰∏≠ÔºåÂ∞ÜËøô‰∫õÈ°µÊ†áËÆ∞‰∏∫ËÑèÔºåÁÑ∂ÂêéÊåÅ‰πÖÂåñÂà∞Á°¨Áõò‰∏≠„ÄÇ</p>
<p>‚Äã	writeÁ≥ªÁªüË∞ÉÁî®ÁöÑÁªìÊûÑ‰∏éreadÂêåÊ†∑ÁÆÄÂçï„ÄÇÈô§‰∫ÜÁî®f_op-&gt;writeÂíådo_sync_writeÊõøÊç¢‰∫Üread‰∏≠ÂØπÂ∫îÁöÑ‰æãÁ®ã‰πãÂ§ñÔºå‰∫åËÄÖÁöÑ‰ª£Á†ÅÊµÅÁ®ãÂõæÂá†‰πéÂÆåÂÖ®Áõ∏Âêå„ÄÇ</p>
<p>‚Äã	‰ªéÂΩ¢Âºè‰∏äÁúãÊù•Ôºåsys_write‰∏ésys_readÁöÑÂèÇÊï∞Áõ∏Âêå:‰∏Ä‰∏™Êñá‰ª∂ÊèèËø∞Á¨¶„ÄÅ‰∏Ä‰∏™ÊåáÈíàÂèòÈáè„ÄÅ‰∏Ä‰∏™ÈïøÂ∫¶ÊåáÁ§∫(Ë°®Á§∫‰∏∫Êï¥Êï∞)„ÄÇÊòæÁÑ∂ÔºåÂÖ∂ËØ≠‰πâÁ®çÊúâ‰∏çÂêå„ÄÇÊåáÈíàÂπ∂ÈùûÊåáÂêëÂ≠òÂÇ®ËØªÂèñÊï∞ÊçÆÁöÑÁºìÂÜ≤Âå∫ÔºåËÄåÊòØÊåáÂêëÈúÄË¶Å ÂÜôÂÖ•Êñá‰ª∂ÁöÑÊï∞ÊçÆ„ÄÇÈïøÂ∫¶ÂèÇÊï∞ÊåáÂÆö‰∫ÜÊï∞ÊçÆÁöÑÂ≠óËäÇÈïøÂ∫¶„ÄÇ</p>
<h2 id="È¢ÑÂèñÊú∫Âà∂">È¢ÑÂèñÊú∫Âà∂</h2>
<p>‚Äã	ÂæàÂ§öÁ°¨ÁõòÁöÑËÆøÈóÆÈÉΩÊòØÈ°∫Â∫èÁöÑ„ÄÇÊôÆÈÄöÊñá‰ª∂‰ª•Áõ∏ÈÇªÊâáÂå∫ÊàêÁªÑÂ≠òÊîæÂú®Á°¨Áõò‰∏äÔºåÂõ†Ê≠§ÂæàÂ∞ëÁßªÂä®Á£ÅÂ§¥Â∞±ÂèØ‰ª•Âø´ÈÄüÊ£ÄÁ¥¢Âà∞Êñá‰ª∂„ÄÇÂΩìÁ®ãÂ∫èËØªÊàñÊã∑Ë¥ù‰∏Ä‰∏™Êñá‰ª∂Êó∂ÔºåÂÆÉÈÄöÂ∏∏‰ªéÁ¨¨‰∏Ä‰∏™Â≠óËäÇÂà∞ÊúÄÂêé‰∏Ä‰∏™Â≠óËäÇÈ°∫Â∫èÂú∞ËÆøÈóÆÊñá‰ª∂„ÄÇÂõ†Ê≠§ÔºåÂú®Â§ÑÁêÜËøõÁ®ãÂØπÂêå‰∏ÄÊñá‰ª∂ÁöÑ‰∏ÄÁ≥ªÂàóËØªËØ∑Ê±ÇÊó∂ÔºåÂèØ‰ª•‰ªéÁ°¨Áõò‰∏äÂæàÂ§öÁõ∏ÈÇªÁöÑÊâáÂå∫ËØªÂèñ„ÄÇ</p>
<p>‚Äã	È¢ÑËØª(Read-ahead)ÊòØ‰∏ÄÁßçÊäÄÊúØÔºåËøôÁßçÊäÄÊúØÂú®‰∫éÂú®ÂÆûÈôÖËØ∑Ê±ÇÂâçËØªÊôÆÈÄöÊñá‰ª∂ÊàñÂùóËÆæÂ§áÊñá‰ª∂ÁöÑÂá†‰∏™Áõ∏ÈÇªÁöÑÊï∞ÊçÆÈ°µ„ÄÇÂú®Â§ßÂ§öÊï∞ÊÉÖÂÜµ‰∏ãÔºåÈ¢ÑËØªËÉΩÊûÅÂ§ßÂú∞ÊèêÈ´òÁ°¨ÁõòÁöÑÊÄßËÉΩÔºåÂõ†‰∏∫È¢ÑËØª‰ΩøÁ°¨ÁõòÊéßÂà∂Âô®Â§ÑÁêÜËæÉÂ∞ëÁöÑÂëΩ‰ª§ÔºåÂÖ∂‰∏≠ÁöÑÊØèÊù°ÂëΩ‰ª§ÈÉΩÊ∂âÂèä‰∏ÄÂ§ßÁªÑÁõ∏ÈÇªÁöÑÊâáÂå∫„ÄÇÊ≠§Â§ñÔºåÈ¢ÑËØªËøòËÉΩÊèêÈ´òÁ≥ªÁªüÁöÑÊôåÂ∫îËÉΩÂäõ„ÄÇÈ°∫Â∫èËØªÂèñÊñá‰ª∂ÁöÑËøõÁ®ãÈÄöÂ∏∏‰∏çÈúÄË¶ÅÁ≠âÂæÖËØ∑Ê±ÇÁöÑÊï∞ÊçÆÔºåÂõ†‰∏∫ËØ∑Ê±ÇÁöÑÊï∞ÊçÆÂ∑≤ÁªèÂú®RAM‰∏≠‰∫Ü„ÄÇ</p>
<h2 id="ÁºìÂ≠òÂõûÂÜôÊú∫Âà∂">ÁºìÂ≠òÂõûÂÜôÊú∫Âà∂</h2>
<p>ÁºìÂ≠òÂõûÂÜôÊú∫Âà∂‰πüÂ∞±ÊòØPage CacheÂØπËÑèÈ°µËøõË°åÂõûÂÜôÔºåÂ∞ÜÂØπÊñá‰ª∂ÁöÑI/O‰øÆÊîπÊ∞∏‰πÖÊåÅ‰πÖÂåñÂà∞Á°¨Áõò‰∏äÁöÑËøáÁ®ãÔºåÊ≠§Â§Ñ‰∏çÂÜçËµòËø∞„ÄÇÂêéÁª≠ËÆ°ÂàíÊ∑±ÂÖ•‰∫ÜËß£LinuxÂÜÖÊ†∏ÂØπÂõûÂÜôÁöÑÊéßÂà∂„ÄÇ</p>
<h1 id="Êñá‰ª∂Á≥ªÁªü">Êñá‰ª∂Á≥ªÁªü</h1>
<p>Êñá‰ª∂Á≥ªÁªü‰Ωú‰∏∫Êìç‰ΩúÁ≥ªÁªü‰∏≠‰∏Ä‰∏™‰∏çÂèØÊàñÁº∫ÁöÑÈÉ®ÂàÜÔºåË¥üË¥£Âú®Â≠òÂÇ®ËÆæÂ§á‰∏äÁÆ°ÁêÜ„ÄÅÂ≠òÂÇ®„ÄÅËé∑ÂèñÊï∞ÊçÆ„ÄÅÁª¥Êä§‰ø°ÊÅØ„ÄÇ</p>
<p>Âú®Linux‰∏≠ÔºåÂÜÖÊ†∏ÈÄöËøáVFSËôöÊãüÊñá‰ª∂Á≥ªÁªüÂêëÁî®Êà∑Êèê‰æõÈÄöÁî®ÁöÑÊé•Âè£ÔºåÂêë‰∏ãÂØπÊé•ÂêÑÁßç‰∏çÂêåÁöÑÊñá‰ª∂Á≥ªÁªüÔºåÂèØ‰ª•ÊúâÊïàÈÅøÂÖç‰∏çÂêåÊñá‰ª∂Á≥ªÁªüÁöÑÂÆûÁé∞Â∑ÆÂºÇÂØπ‰∏äÂ±ÇÂ∏¶Êù•ÂΩ±Âìç„ÄÇ</p>
<h2 id="ext4">ext4</h2>
<p>Êú¨ÈÉ®ÂàÜÂ§ßÈáèÂÜÖÂÆπÊù•Ëá™kernel.orgÁöÑÊñáÊ°£</p>
<p><a class="link" href="https://www.kernel.org/doc/html/latest/filesystems/ext4/index.html"  target="_blank" rel="noopener"
    >ext4 Data Structures and Algorithms ‚Äî The Linux Kernel documentation</a></p>
<h3 id="ext-Êñá‰ª∂Á≥ªÁªüÂèëÂ±ïÂéÜÂè≤">ext Êñá‰ª∂Á≥ªÁªüÂèëÂ±ïÂéÜÂè≤</h3>
<h4 id="ext1">ext1</h4>
<p>Extended file systemÔºåÊâ©Â±ïÊñá‰ª∂Á≥ªÁªü„ÄÇ</p>
<p>LinuxÊúÄÊó©‰ΩøÁî®ÁöÑÊñá‰ª∂Á≥ªÁªü‰∏∫MinixÁöÑÊñá‰ª∂Á≥ªÁªüÔºå‰ΩÜÊòØËØ•Á≥ªÁªüÂ≠òÂú®Êñá‰ª∂Â§ßÂ∞èÈôêÂà∂ÁöÑÈóÆÈ¢òÔºåÂêåÊó∂ÊÄßËÉΩ‰∏ç‰Ω≥„ÄÇÂú®1992Âπ¥4ÊúàÔºåR√©my CardÂºÄÂèë‰∫ÜÊâ©Â±ïÊñá‰ª∂Á≥ªÁªüÔºåÈ¶ñ‰∏™ÁâàÊú¨‰Ωú‰∏∫Linux‰∏≠ÁöÑÊñá‰ª∂Á≥ªÁªü‰∏ÄËµ∑ÂèëË°åÔºåÊúÄÂ§ßÊîØÊåÅ2GBÁ©∫Èó¥ÔºåÂêåÊó∂ÂÆÉËøòÊòØLinux‰∏≠Á¨¨‰∏Ä‰∏™‰ΩøÁî®VFSÂÆûÁé∞Âá∫ÁöÑÊñá‰ª∂Á≥ªÁªü„ÄÇ</p>
<h4 id="ext2">ext2</h4>
<p>Âú®È¶ñ‰∏™extÊñá‰ª∂Á≥ªÁªü‰∏≠ÔºåÊñá‰ª∂ËÆøÈóÆ„ÄÅÂ≠òÂú®inode‰øÆÊîπ‰ª•ÂèäÊñá‰ª∂ÂÜÖÂÆπ‰øÆÊîπÊ≤°Êúâ‰ΩøÁî®Áã¨Á´ãÊó∂Èó¥Êà≥ÁöÑÈóÆÈ¢òÔºåÂêåÊó∂ÊúÄÂ§ß‰ªÖÊîØÊåÅ255‰∏™Â≠óÁ¨¶ÁöÑÊñá‰ª∂Âêç‰ª•Âèä2GBÁöÑÁ©∫Èó¥Ôºåext2Á≥ªÁªüÈô§‰∫Ü‰øÆÂ§ç‰∫ÜËøô‰∏™ÈóÆÈ¢òÂ§ñÔºåËøòÂú®Á°¨ÁõòÂ≠òÂÇ®Êï∞ÊçÆÁªìÊûÑ‰∏≠È¢ÑÁïô‰∫ÜÂæàÂ§öÁ©∫Èó¥‰æõÊú™Êù•ÂºÄÂèë‰ΩøÁî®ÔºåÂÖ∑ÊúâËâØÂ•ΩÁöÑÂèØÊãìÂ±ïÊÄß„ÄÇ</p>
<p>Áî±‰∫éÂùóÈ©±Âä®ÁöÑÈôêÂà∂Ôºåext2Êñá‰ª∂Á≥ªÁªüÊúÄÂ§ßÊîØÊåÅ2TBÁöÑÂçï‰∏™Êñá‰ª∂„ÄÇ</p>
<h4 id="ext3">ext3</h4>
<p>ext3Âú®ÂΩìÊó∂ÊÄßËÉΩ‰∏çÊòØÂæàÂá∫‰ºóÔºå‰ΩÜÊòØÊîØÊåÅ‰ªéÂΩìÊó∂ÊúÄÊµÅË°åÁöÑext2Êñá‰ª∂Á≥ªÁªüÂçáÁ∫ßÔºåÊó†ÈúÄÂ§á‰ªΩÂíåÊï∞ÊçÆÊÅ¢Â§çÔºåÂêåÊó∂ÊúâËæÉÂ∞ëÁöÑËµÑÊ∫êÂç†Áî®ÔºàCPUÂºÄÈîÄÔºâ„ÄÇ</p>
<p>ext3Áõ∏ËæÉ‰∫éext2Â¢ûÂä†‰∫Ü</p>
<ul>
<li>Êó•ÂøóÊîØÊåÅ</li>
<li>Êñá‰ª∂Á≥ªÁªüÂú®Á∫øÂ¢ûÈïø</li>
<li>ÂØπÂ§ßÁõÆÂΩïÊèê‰æõHTreeÂìàÂ∏åÊ†ëÁ¥¢Âºï</li>
</ul>
<p>ext3Êèê‰æõ‰∫Ü‰∏â‰∏™Êó•ÂøóÁ∫ßÂà´Ôºö</p>
<ul>
<li>Êó•ÂøóÔºàÊúÄ‰ΩéÈ£éÈô©ÔºâÔºömetadataÂíåÊñá‰ª∂ÂÜÖÂÆπ‰∏ÄËµ∑ÂÜôÂÖ•Êó•Âøó‰∏≠ÔºåÁî±‰∫éËøòË¶ÅÂÜôÂÖ•Êñá‰ª∂Á≥ªÁªüÔºåÂõ†Ê≠§Â∏¶Êù•È¢ùÂ§ñÁöÑÊÄßËÉΩÂºÄÈîÄ„ÄÇ</li>
<li>ÊúâÂ∫èÔºà‰∏≠Á≠âÈ£éÈô©ÔºâÔºöÂè™Â∞ÜmetadataÂÜôÂÖ•Êó•ÂøóÔºå‰ΩÜÊòØ‰øùËØÅmetadataÊèê‰∫§ÂâçÔºåÊñá‰ª∂ÂÜÖÂÆπ‰ºöË¢´ÂÜôÂÖ•„ÄÇÂ§ßÈÉ®‰ªΩÂèëË°åÁâàÈªòËÆ§ÁöÑÊñπÂºè„ÄÇÂÜôÂÖ•ËøáÁ®ã‰∏≠Â¥©Ê∫ÉÊó∂ÔºåÊñá‰ª∂Á≥ªÁªü‰ºöÊ∏ÖÈô§ËøòÊ≤°ÊúâË¢´Êèê‰∫§ÁöÑÊñá‰ª∂‰øÆÊîπ/ÂàõÂª∫Ôºå‰ΩÜÊòØÂØπ‰∫éÊñá‰ª∂ÁöÑË¶ÜÁõñÂÜôÂÖ•ÔºåÂèØËÉΩ‰ºöÂØºËá¥Êñá‰ª∂Â§Ñ‰∫éÊñ∞ÊóßÊñá‰ª∂ÁöÑ‰∏≠Èó¥ÊÄÅ„ÄÇ</li>
<li>ÂõûÂÜôÔºàÊúÄÈ´òÈ£éÈô©ÔºâÔºöÂè™ËÆ∞ÂΩïmetadataÂà∞Êó•ÂøóÔºåÊñá‰ª∂ÂÜÖÂÆπÂú®Êó•ÂøóÊèê‰∫§ÂâçÊàñËÄÖÊèê‰∫§ÂêéÂÜôÂÖ•„ÄÇÂ¶ÇÊûúÂú®Êó•ÂøóÊèê‰∫§ÂâçÂÜôÂÖ•Â§±Ë¥•Ôºå‰ºöÂØºËá¥Á°¨ÁõòÂá∫Áé∞ÂûÉÂúæ„ÄÇ</li>
</ul>
<p>ext3Â≠òÂú®ÁöÑ‰∏Ä‰∫õÁº∫Èô∑Ôºö</p>
<ul>
<li>Ê≤°ÊúâÂú®Á∫øÁöÑÁ¢éÁâáÊï¥ÁêÜÂ∑•ÂÖ∑</li>
<li>ÂÆòÊñπÁº∫Â∞ëÂéãÁº©Â∑•ÂÖ∑</li>
<li>‰∏çÊîØÊåÅÊÅ¢Â§çÂ∑≤ÁªèÂà†Èô§ÁöÑÊñá‰ª∂</li>
<li>Áº∫Â∞ëÂø´ÁÖßÊîØÊåÅ</li>
<li>Êó•Âøó‰∏≠‰∏çÊîØÊåÅÊ†°È™åÂíå</li>
<li>‰ΩøÁî®Âõõ‰∏™Â≠óËäÇÂ≠òÂÇ®UnixÊó∂Èó¥ÔºåÂõ†Ê≠§Âú®2038Âπ¥1Êúà18Êó•‰πãÂêéÂ∞ÜÊó†Ê≥ïÁªßÁª≠Â§ÑÁêÜÊñá‰ª∂</li>
</ul>
<h4 id="ext4-1">ext4</h4>
<p>ext4Âú®Linux 2.6.28‰∏≠‰Ωú‰∏∫ÂäüËÉΩÂÆåÊï¥Á®≥ÂÆöÁöÑÊñá‰ª∂Á≥ªÁªüÂèëÂ∏ÉÔºåext4Êñá‰ª∂Á≥ªÁªüÈ¶ñÂÖàÂÖºÂÆπ‰∫ÜÂéüÊúâÁöÑext3Á≥ªÁªüÔºåÊèê‰æõÂÆâÂÖ®ÂèØÈù†ÁöÑÂø´ÈÄüËøÅÁßª„ÄÇÂêåÊó∂ËøòÊúâÂ¶Ç‰∏ãÁâπÁÇπÔºö</p>
<ul>
<li>
<p>ÊîØÊåÅÊõ¥Â§ßÁöÑÊñá‰ª∂Á≥ªÁªüÂíåÊñá‰ª∂Â§ßÂ∞è</p>
<p>‰ª•4KBÂùóÔºåÁõÆÂâçÊîØÊåÅÊúÄÂ§ß<code>1EiB(1024*1024*1024GB)</code>ÁöÑÊñá‰ª∂Á≥ªÁªüÂ§ßÂ∞èÂíå16TiBÁöÑÊñá‰ª∂Â§ßÂ∞èÔºå‰ΩøÁî®48bitÊù•ÁºñÂùÄÔºåÊú™Êù•‰ºöÊîØÊåÅ64bit</p>
</li>
<li>
<p>Â≠êÁõÆÂΩïÂèØÊâ©Â±ïÊÄß</p>
<p>ext4Êñá‰ª∂Á≥ªÁªüÊîØÊåÅÊúÄÂ§ö64000‰∏™Â≠êÁõÆÂΩïÔºåÊòØext3Êñá‰ª∂Á≥ªÁªüÁöÑ‰∏§ÂÄç</p>
</li>
<li>
<p>Êâ©Â±ïÊï∞ÊçÆÂùó</p>
<p>ÈºìÂä±ÂØπÂ§ßÊñá‰ª∂ÂàíÂàÜÂ§ö‰∏™ËøûÁª≠Êï∞ÊçÆÂùóÔºåÂú®Á°¨Áõò‰∏äËøõË°åËøûÁª≠Â∏ÉÂ±ÄÔºå‰ªéËÄåÂáèÂ∞ëÁª¥Êä§Â§ßÈáèÁöÑÈó¥Êé•Êò†Â∞ÑÔºåÊúâÂä©‰∫éÊèêÈ´òÊÄßËÉΩÔºåÂáèÂ∞ëÁ°¨ÁõòÁ¢éÁâá</p>
</li>
<li>
<p>Â§öÂùóÂêåÊó∂ÂàÜÈÖçÔºå</p>
<p>Âú®ext3Êñá‰ª∂Á≥ªÁªü‰∏≠ÔºåÊñá‰ª∂Á≥ªÁªüÂú®ÂàÜÈÖçÁ©∫Èó≤ÂùóÊó∂ÔºåÂè™ËÉΩ‰∏ÄÊ¨°Â§ÑÁêÜ‰∏Ä‰∏™ÂùóÁî≥ËØ∑Ôºåext4ÊîØÊåÅÂ§öÂùóÂàÜÈÖçÊú∫Âà∂ÔºåÂèØ‰ª•‰∏ÄÊ¨°Áî≥ËØ∑Â§ö‰∏™Âùó</p>
</li>
<li>
<p>ÂùóÁöÑÂª∂Êó∂ÂàÜÈÖç</p>
<p>ÂÄüÈâ¥‰∫ÜXFS„ÄÅZFS„ÄÅbtrfsÁ≠âÁé∞‰ª£Êñá‰ª∂Á≥ªÁªüÔºåÂú®ÊâßË°åÂÜôÂÖ•ËøáÁ®ãÊó∂ÔºåÂú®‰ª•ÂæÄÁöÑÊñá‰ª∂Á≥ªÁªü‰∏≠ÔºåÈÉΩÊòØÂØπÂÜôÂÖ•Âà∞cacheÁöÑÊï∞ÊçÆÁ´ãÂç≥ÂàÜÈÖçÁõ∏Â∫îÁöÑblockÔºåÊ∂àËÄó‰∫ÜÂ§ßÈáèÁöÑÊó∂Èó¥ÔºåÂª∂Êó∂ÂàÜÈÖçÂêéÔºåÂè™ÊúâÂΩìÊï∞ÊçÆÈúÄË¶ÅË¢´Âà∑Êñ∞Âà∞Á°¨ÁõòÊó∂ÔºåÊâç‰ºöÊâßË°åÂùóÁöÑÂàÜÈÖçÔºåÂèØ‰ª•Âíå‰∏äÈù¢‰∏§‰∏™featËøõË°åÈÖçÂêàÔºåÊèêÈ´ò‰∫ÜÊñá‰ª∂Á≥ªÁªüÁöÑÊÄßËÉΩ</p>
</li>
<li>
<p>Âø´ÈÄüfsck</p>
<p>fsckÊòØÊûÅÂÖ∂ËÄóÊó∂ÁöÑËøáÁ®ãÔºå‰∏ªË¶ÅÊòØÈúÄË¶ÅÊ£ÄÊü•Êñá‰ª∂Á≥ªÁªüÊâÄÊúâÁöÑinode„ÄÇext4‰∏≠ÔºåÂú®ÊØè‰∏™group&rsquo;s inode table‰∏≠ÈÉΩ‰øùÂ≠ò‰∫Ü‰∏Ä‰∏™Á©∫Èó≤inodeÈìæË°®ÔºàÂêåÊó∂‰øùÂ≠ò‰∫ÜchecksumÔºâÔºåÂõ†Ê≠§fsckÂ∞±‰∏çÂøÖÂÜçÊ£ÄÊü•Ëøô‰∫õinode</p>
</li>
<li>
<p>Êó•ÂøóÊ†°È™åÂíå</p>
<p>Êó•ÂøóÂú®Á°¨Áõò‰∏≠ÊòØÂæàÂÆπÊòìÂá∫ÈîôÁöÑÈÉ®ÂàÜÔºåÊ∑ªÂä†Ê†°È™åÂíåÂèØ‰ª•ÈÅøÂÖçÊñá‰ª∂Á≥ªÁªüÊÅ¢Â§çÈîôËØØÁöÑÊó•ÂøóÂ∏¶Êù•Êõ¥Â§ßÁöÑÊçüÂ§±„ÄÇ‰ΩøÁî®Ê†°È™åÂíåËøò‰ΩøÂæóÂú®ext3‰∏≠Êó•ÂøóÁöÑ‰∏§Ê≠•Êèê‰∫§ÁÆÄÂåñ‰∏∫‰∏ÄÊ≠•</p>
</li>
<li>
<p>Êó†Êó•ÂøóÊ®°Âºè</p>
<p>ext4‰∏≠ÂèØ‰ª•ÂÖ≥Èó≠Êó•Âøó</p>
</li>
<li>
<p>Âú®Á∫øÁ¢éÁâáÊï¥ÁêÜ</p>
<p>‰ΩøÁî®e4defragÂ∑•ÂÖ∑ÊâãÂä®ËøõË°åÁ¢éÁâáÊï¥ÁêÜ</p>
</li>
<li>
<p>inodeÁõ∏ÂÖ≥feat</p>
<ul>
<li>
<p>Êõ¥Â§ßÁöÑinode</p>
<p>‰ªé128bytesÊèêÈ´òÂà∞256bytes</p>
</li>
<li>
<p>inodeÈ¢ÑÁïô</p>
<p>ÂàõÂª∫ÁõÆÂΩïÊó∂È¢ÑÁïô‰∏Ä‰∫õinodeÊèêÈ´òÊÄßËÉΩ</p>
</li>
<li>
<p>Á∫≥ÁßíÁ∫ßÊó∂Èó¥Êà≥</p>
<p>ÊèêÈ´òÁ≥ªÁªüÁöÑtime resolution</p>
</li>
</ul>
</li>
<li>
<p>Á°¨ÁõòÁ©∫Èó¥È¢ÑÂàÜÈÖç</p>
<p>Â∫îÁî®ÂèØ‰ª•ËÆ©Êñá‰ª∂Á≥ªÁªüÈ¢ÑÂÖàÂàÜÈÖç‰∏ÄÈÉ®ÂàÜÁ°¨Áõò‰∏äÁöÑÁ©∫Èó¥ÔºåÊñá‰ª∂Á≥ªÁªü‰ºöÊèêÂâçÂàõÂª∫Â•ΩÁõ∏ÂÖ≥ÁöÑÊï∞ÊçÆÁªìÊûÑÂπ∂ÂàÜÈÖçÁõ∏Â∫îÁöÑÂùóÔºåÂêéÁª≠ÂèØ‰ª•Áõ¥Êé•ÂÜôÂÖ•Êï∞ÊçÆÔºåÁ±ª‰ººP2P‰∏ãËΩΩÊó∂È¢ÑÂàÜÈÖçÔºå1.ÂèØ‰ª•Èò≤Ê≠¢Á±ª‰ººÂäüËÉΩÁöÑ‰ΩéÊïàÁéáÂ∫îÁî®Á∫ßÂÆûÁé∞Ôºõ2.ÂáèÂ∞ëÁ°¨ÁõòÁ¢éÁâáÔºõ3.ÂØπ‰∫éÂÆûÊó∂Â∫îÁî®Êù•ËØ¥ÔºàÂª∂ËøüÊïèÊÑüÔºåËà™Á©∫Â∑•‰∏öÁ≠âÔºâÔºåËøô‰∏™ÁâπÁÇπÊîπÂñÑ‰∫ÜÂª∂Ëøü„ÄÇÊ≠§featÈÄöËøá<code>libc posix_fallocate()</code>ÂÆûÁé∞</p>
</li>
<li>
<p>ÈªòËÆ§ÂêØÁî®ÂÜôÂ±èÈöú</p>
<p>ÈÄöËøáÊ∂àËÄó‰∏Ä‰∫õÊÄßËÉΩÊù•ÊîπÂñÑÊñá‰ª∂Á≥ªÁªüÁöÑÂÆåÊï¥ÊÄßÔºåÂÆÉÁ°Æ‰øùÊñá‰ª∂Á≥ªÁªüÂÖÉÊï∞ÊçÆÂú®Á°¨Áõò‰∏äË¢´Ê≠£Á°ÆÂú∞ÂÜôÂÖ•ÂíåÊéíÂ∫èÔºåÂç≥‰ΩøÂú®ÊéâÁîµÊó∂‰πüÊòØÂ¶ÇÊ≠§ÔºåÂØπ‰∫é‰∏Ä‰∫õÂàõÂª∫Â§ßÈáèÂ∞èÊñá‰ª∂ÊàñËÄÖÊìç‰ΩúÂÖÉÊï∞ÊçÆÁöÑÁ®ãÂ∫èÔºå‰ºöÂ∏¶Êù•ÂæàÂ§ßÁöÑÊÄßËÉΩÂΩ±Âìç„ÄÇÂ¶ÇÊûúÁ°¨ÁõòÊòØÁîµÊ±†‰æõÁîµÔºåÈÄöËøá<code>barrier=0</code>ÂèØ‰ª•ÂÖ≥Èó≠ÂÜôÂ±èÈöúÔºà‰ºö‰øùËØÅÂÆâÂÖ®ÊÄßÔºâ„ÄÇÂÜôÂ±èÈöú‰øùÊä§‰øùËØÅÂú®Êï∞ÊçÆÂÜôÂÖ•<code>ÁºìÂ≠òÔºàÁ°¨ÁõòÁºìÂ≠òÔºâ</code>ÂêéÔºåÂÖàÂÜôÂÖ•Êó•Âøó‰∏≠ÁöÑÂÖÉÊï∞ÊçÆÂà∑Êñ∞Âà∞Á°¨ÁõòÔºåÈò≤Ê≠¢Âá∫Áé∞Âõ†‰∏∫Ë∞ÉÂ∫¶Á≠ñÁï•ÂØºËá¥ÁöÑÊï∞ÊçÆÂÖà‰∫éÊó•ÂøóÂÜôÂÖ•Á°¨Áõò</p>
</li>
<li>
<p>discard/TRIM</p>
<p>‰∏∫SSDÊèê‰æõÁöÑTRIMÊîØÊåÅ„ÄÇ</p>
<p>ÂØπ‰∫éSSDËÄåË®ÄÔºåÁî±‰∫éÊñá‰ª∂Á≥ªÁªüÂú®Âà†Èô§Êó∂Âè™ÂØπÂùóÊ†áËÆ∞‰∏∫Á©∫Èó≤ÔºåËÄåSSDÂç¥Âπ∂‰∏çÁü•ÈÅìÂì™‰∫õÊï∞ÊçÆÂùóÂèØÁî®ÔºåÂÜçÊ¨°ÂÜôÂÖ•Êó∂‰ºöÂÖàÊ∏ÖÈô§Èó™Â≠ò‰∏≠ÁöÑÊï∞ÊçÆÔºåÂÜçËøõË°åÂÜôÂÖ•ÔºåË¶ÅÊì¶Èô§Êó†ÊïàÈ°µÔºåË¶ÅÂÖàÁßªËµ∞ÊúâÊïàÈ°µÔºåÁÑ∂ÂêéÂÜçÂØπ‰∏ÄÊï¥Ë°åËøõË°åÊì¶Èô§ÔºåÊúÄÂêéÊâçËÉΩÊâßË°åÂÜôÂÖ•ËøáÁ®ãÔºåËøô‰∏™Áé∞Ë±°‰πüË¢´Áß∞‰∏∫<a class="link" href="https://en.wikipedia.org/wiki/Write_amplification"  target="_blank" rel="noopener"
    >ÂÜôÂÖ•ÊîæÂ§ß(Write Amplification)</a>„ÄÇ</p>
<p>TRIM‰∏ªË¶Å‰ΩøÂæóÊñá‰ª∂Á≥ªÁªüÂëäÁü•SSDÂì™‰∫õÈ°µ‰∏çÂÜçÂåÖÂê´ÊúâÊïàÁöÑÊï∞ÊçÆÔºåÊúâÂä©‰∫éÊèêÈ´òSSDÁöÑÂØøÂëΩÂíåÁ£®ÊçüÂùáË°°</p>
<p>ÈöèÁùÄ‰ΩøÁî®ÁöÑblockÊï∞ÈáèÊé•ËøëSSDÁöÑÂÆπÈáè‰∏äÈôêÔºå‰ºöÂØºËá¥SSDÁöÑÊÄßËÉΩ‰∏ãÈôçÔºåÊñá‰ª∂Á≥ªÁªüÈÄöËøádiscardÊåá‰ª§ÂëäÁü•SSDÂì™‰∫õËåÉÂõ¥ÂÜÖÁöÑblockÂ∑≤Áªè‰∏çÂÜç‰ΩøÁî®ÔºåSSDÂèØ‰ª•Â∞ÜÂÖ∂ÂõûÊî∂ÊàñËÄÖÁî®Êù•ÂÆûÁé∞Á£®ÊçüÂùáË°°</p>
</li>
</ul>
<h3 id="Êï∞ÊçÆÁªÑÁªá">Êï∞ÊçÆÁªÑÁªá</h3>
<p>ext4Êñá‰ª∂Á≥ªÁªüÂ∞ÜÈÉ®ÂàÜblockÁªÑÁªá‰∏∫‰∏Ä‰∏™groupÔºåÈªòËÆ§blockÂ§ßÂ∞èÈááÁî®4KBÔºåÂõ†Ê≠§‰∏Ä‰∏™group‰∏≠ÁöÑblockÊï∞Èáè‰∏∫<code>8*block_size_in_bytes=32768 blocks</code>ÔºåÁ©∫Èó¥‰∏∫128MB„ÄÇ</p>
<p>ext4ÈÉ®ÂàÜÂú®Á°¨Áõò‰∏≠ÊåâÂ∞èÁ´ØÂÜôÂÖ•Ôºåjdb2Êó•ÂøóÈÉ®ÂàÜÂú®Á°¨Áõò‰∏≠ÊåâÂ§ßÁ´ØÂÜôÂÖ•„ÄÇ</p>
<p>ext4Âú®ÂàÜÈÖçÁ°¨ÁõòÁ©∫Èó¥Êó∂Âè™ËÉΩÂàÜÈÖçËã•Âπ≤‰∏™blockÔºå‰∏Ä‰∏™blockÂåÖÂê´Á°¨Áõò‰∏äÁöÑËã•Âπ≤‰∏™ÊâáÂå∫ÔºåÊâáÂå∫ÁöÑÊï∞ÈáèÂøÖÈ°ªÊòØ2ÁöÑÂπÇÊ¨°„ÄÇ</p>
<p>‰∏ç‰ΩøÁî®Êâ©Â±ïÂ∏ÉÂ±ÄÁöÑÊñá‰ª∂ÔºàÈÄöËøáblockÊò†Â∞ÑÁª¥Êä§ÔºâÂøÖÈ°ªÂ≠òÊîæÂú®Êñá‰ª∂Á≥ªÁªüÂâç$2^{32}$‰∏™block‰∏≠ÔºåÈÄöËøáÊâ©Â±ïÂ∏ÉÂ±ÄÊù•‰øùÂ≠òÁöÑÊñá‰ª∂ÔºåÂøÖÈ°ªÂ≠òÊîæÂú®Ââç$2^{48}$‰∏™block‰∏≠„ÄÇ</p>
<p>ÂØπ‰∫é32‰ΩçÂíå64‰ΩçÁöÑÊñá‰ª∂Á≥ªÁªüÔºåÂêÑ‰∏™Êï∞ÊçÆÁªìÊûÑÁöÑÂ§ßÂ∞èÈôêÂà∂Â¶Ç‰∏ãÂõæÊâÄÁ§∫Ôºö</p>
<p><img src="/img/image-20221115165058013.png"
	
	
	
	loading="lazy"
	
		alt="image-20221115165058013"
	
	
></p>
<p><img src="/img/image-20221115165128885.png"
	
	
	
	loading="lazy"
	
		alt="image-20221115165128885"
	
	
></p>
<p>Âú®‰∏Ä‰∏™Block Group‰∏≠ÔºåÊï∞ÊçÆÁöÑÁªÑÁªáÂ¶ÇË°®Ê†ºÊâÄÁ§∫Ôºö</p>
<div class="table-wrapper"><table>
<thead>
<tr>
<th>Group 0 Padding</th>
<th>ext4 Super Block</th>
<th>Group Descriptors</th>
<th>Reserved GDT Blocks</th>
<th>Data Block Bitmap</th>
<th>inode Bitmap</th>
<th>inode Table</th>
<th>Data Blocks</th>
</tr>
</thead>
<tbody>
<tr>
<td>1024 bytes</td>
<td>1 block</td>
<td>many blocks</td>
<td>many blocks</td>
<td>1 block</td>
<td>1 block</td>
<td>many blocks</td>
<td>many more blocks</td>
</tr>
</tbody>
</table></div>
<p>Á°¨Áõò‰∏≠‰ºöÈ¢ÑÁïô1024 bytesÔºåÁî®‰∫éÊìç‰ΩúÁ≥ªÁªüÁöÑÂºïÂØºÊ®°ÂùóÂÆâË£ÖÔºåËØ•paddingÂàÜÂå∫Âè™Êúâgroup 0Âê´ÊúâÔºå‰∏∫‰∫ÜÈÅøÂÖçsupper blockÊçüÂùèÂØºËá¥Êï¥‰∏™Êñá‰ª∂Á≥ªÁªü‰∏çÂèØÁî®ÔºåÂú®ÂÖ∂‰ªñblock group‰∏≠Ëøò‰ºöÊúâÂ§á‰ªΩÔºåÂ¶ÇÊûú‰∏Ä‰∏™block group‰∏çÂê´ÊúâÂÜó‰ΩôÂ§á‰ªΩÔºåÈÇ£‰πàÂÆÉÂ∞Ü‰ª•data block bitmapÂºÄÂ§¥„ÄÇ</p>
<p>Âú®ÊâßË°åmkfsÊó∂ÔºåËøò‰ºöÂú®group descriptorÊèèËø∞Á¨¶ÂàÜÂå∫Âíådata block bitmapÂàÜÂå∫‰πãÈó¥ÂàÜÈÖç‰∏Ä‰∏™‰øùÁïôÁöÑGDT blocksÂàÜÂå∫ÔºåÁî®‰∫éÊñá‰ª∂Á≥ªÁªüÊó•ÂêéÁöÑÊâ©Â±ï„ÄÇ</p>
<p>ext4Êñá‰ª∂Á≥ªÁªü‰∏≠ËøòÂºïÂÖ•‰∫ÜFlexible Block GroupsÁöÑÊ¶ÇÂøµ(flex_bg)Ôºå‰∏ªË¶ÅÊÄùÊÉ≥ÊòØÂ∞ÜËã•Âπ≤‰∏™block groupÁªÑÂêàÊàê‰∏Ä‰∏™Â§ßÁöÑGroupÔºåÂ∞ÜÊâÄÊúâblock group‰∏≠ÁöÑÂÖÉÊï∞ÊçÆÔºàinodeÔºåbitmapÔºâÈÉΩÈõÜ‰∏≠Âà∞Á¨¨‰∏Ä‰∏™block group‰∏≠ÔºåÊèêÈ´òÂØπÂÖÉÊï∞ÊçÆÂä†ËΩΩÂíåÊü•ËØ¢ÁöÑÊïàÁéáÔºåÂπ∂‰∏î‰ΩøÂæóÊñá‰ª∂Êï∞ÊçÆÂú®Á°¨Áõò‰∏äËøûÁª≠ÔºåÊõ¥Á¥ßÂáë„ÄÇ‰∏ÄËà¨ÈÄöËøá<code>2^sb.s_log_groups_per_flex</code>‰∏™block groupÊù•ÁªÑÊàê‰∏Ä‰∏™Â§ßÁöÑGroup„ÄÇ</p>
<p>Ëá™ext3Ëµ∑ÔºåextÊñá‰ª∂Á≥ªÁªüÂ∞±ÂºÄÂßã‰ΩøÁî®Meta block groups(META_BG)ÔºåÊòØ‰∏ÄÁªÑÂè™Áî®‰∏Ä‰∏™group descriptorÊù•ÊèèËø∞ÁöÑblock groupsÔºåÈ¶ñ‰∏™block group‰∏çÂÜçÂ≠òÂÇ®ÊØè‰∏™block groupÁöÑÊèèËø∞Á¨¶ÔºåËΩ¨Áî±meta block groupÊù•Â≠òÂÇ®ÔºåÂπ∂‰∏î‰ºöÂú®ÂÖ∂‰∏≠Â≠òÂÇ®Âá†‰∏™ÂÜó‰ΩôÂâØÊú¨„ÄÇ</p>
<p>ÂØπ‰∫éext4Êñá‰ª∂Á≥ªÁªüÁöÑËØªÂÜôÊµÅÁ®ãËÆ°ÂàíÂú®Ê≠§ÂêéÂçïÁã¨ÂÜô‰∏ÄÁØáÊñáÁ´†ËøõË°åÊÄªÁªì„ÄÇ</p>
<h2 id="f2fs">F2FS</h2>
<p>F2FSÊñá‰ª∂Á≥ªÁªüÊèêÂá∫‰∫é<code>USENIX FAST'15</code>Ôºå<a class="link" href="https://www.usenix.org/conference/fast15/technical-sessions/presentation/lee"  target="_blank" rel="noopener"
    >F2FS: A New File System for Flash Storage | USENIX</a></p>
<p>ÂÖ®Áß∞‰∏∫Flash-Friendly File SystemÔºåÂü∫‰∫éÊó•ÂøóÁªìÊûÑÊñá‰ª∂Á≥ªÁªü(Log-structured File System, LFS)ÔºåÈíàÂØπLFS‰∏≠wandering treeÂíågcÂºÄÈîÄÂ§ßÁöÑÈóÆÈ¢òËøõË°å‰∫Ü‰ºòÂåñ„ÄÇ</p>
<h3 id="‰∏ªË¶ÅÁâπÁÇπ">‰∏ªË¶ÅÁâπÁÇπ</h3>
<p>ÈíàÂØπÈó™Â≠òËøõË°å‰∫Ü‰ºòÂåñÔºö</p>
<ul>
<li>==Êâ©Â§ßÈöèÊú∫ÂÜôÂÖ•Âå∫ÂüüÊù•ÊèêÈ´òÊÄßËÉΩ==ÔºàÊ≠§Â§ÑÂ≠òÂú®ÁñëÈóÆÔºâÔºå‰ΩÜÂ∏¶Êù•‰∫ÜÁ©∫Èó¥Â±ÄÈÉ®ÊÄß</li>
<li>Â∞ΩÂèØËÉΩ‰ΩøÂæóÊñá‰ª∂Á≥ªÁªüÁöÑÂ§ÑÁêÜÂçïÂÖÉ‰∏éFTL‰∏≠‰øùÊåÅ‰∏ÄËá¥</li>
</ul>
<p>ÈíàÂØπwandering treeÈóÆÈ¢òÔºåËØ•ÈóÆÈ¢òÊòØÂõ†‰∏∫LFSÁöÑËÑèÊï∞ÊçÆÈÄöËøáËøΩÂä†Êõ¥Êñ∞ÔºåÂ¶ÇÊûú‰∏Ä‰∏™Êï∞ÊçÆÂùóÂèòÊàêËÑèÊï∞ÊçÆÔºåÈÇ£‰πàÂÖ∂Á¥¢ÂºïÂùóÔºå‰ª•ÂèäÈó¥Êé•Á¥¢ÂºïÂùóÈÉΩ‰ºöÂèòÊàêËÑèÂùóÔºö</p>
<ul>
<li>‰ΩøÁî®nodeÊù•‰ª£ÊõøinodeÂíåÊåáÈíàÂùó</li>
<li>ÈÄöËøáÂåÖÂê´ÊâÄÊúânodeÂùóÂú∞ÂùÄÁöÑNode Address Table(NAT)Êù•ÂàáÊñ≠Êõ¥Êñ∞ÈÄíÂΩíÁöÑ‰º†Êí≠</li>
</ul>
<p>ÂûÉÂúæÂõûÊî∂ÈóÆÈ¢òÔºö</p>
<ul>
<li>ÊîØÊåÅÂêéÂè∞Ê∏ÖÁêÜ</li>
<li>ÊîØÊåÅË¥™ÂøÉÂíåcost-benefitÁÆóÊ≥ï</li>
<li>‰∏∫Âä®ÊÄÅ/ÈùôÊÄÅÂÜ∑ÁÉ≠Êï∞ÊçÆÂàÜÁ¶ªÊèê‰æõmulti-head logs</li>
<li>ÂºïÂÖ•Ëá™ÈÄÇÂ∫îÊó•ÂøóÊù•ÂÆûÁé∞È´òÊïàÁöÑÂùóÂàÜÈÖç</li>
</ul>
<h2 id="btrfs">Btrfs</h2>
<p>BtrfsÊòØ‰∏Ä‰∏™ÂÜôÊó∂Â§çÂà∂ÁöÑÊñá‰ª∂Á≥ªÁªüÔºåÂü∫‰∫éB-treeÂÆûÁé∞Ôºå‰∏ìÊ≥®‰∫éÂÆπÈîôÔºå‰øÆÂ§çÂíåÊòì‰∫éÁÆ°ÁêÜÔºåÂèëÂ∏É‰∫é2014Âπ¥ÔºåÂèëÂ±ïÁõÆÊ†áÊòØ‰∏∫‰∫ÜÂèñ‰ª£ext3Êñá‰ª∂Á≥ªÁªüÔºåËß£ÂÜ≥ext3ÁöÑÈôêÂà∂„ÄÇÂú®2021Âπ¥ÔºåFedora 33ÂÆ£Â∏ÉÂ∞Ü‰ΩøÁî®Btrfs‰Ωú‰∏∫ÂÆâË£ÖÊó∂ÈªòËÆ§ÁöÑÊñá‰ª∂Á≥ªÁªü„ÄÇËÄåFedoraÂèóÂà∞redhatÁöÑÁõ¥Êé•ËµûÂä©ÔºåËØ¥ÊòéBtrfsÂú®‰∏çÊñ≠ÂèëÂ±ïÁöÑËøáÁ®ã‰∏≠ÔºåÂæóÂà∞‰∫ÜÁ§æÂå∫‰∏≠ÈÉ®ÂàÜÁî®Êà∑‰ª•Âèä‰ºÅ‰∏öÁöÑËÆ§ÂèØÔºåÁõÆÂâçËøòÂ§ÑÂú®ÊµãËØïÂíå‰∏çÊñ≠ÂÆåÂñÑÁöÑÈò∂ÊÆµ„ÄÇ</p>
<p>‰∏ªË¶ÅÁâπÁÇπ</p>
<ul>
<li>Âü∫‰∫éB-TreeÁª¥Êä§ÂÖÉÊï∞ÊçÆÔºåÊèíÂÖ•Êü•ËØ¢Êìç‰ΩúÈ´òÊïà</li>
<li>Âü∫‰∫éCOWÔºåÊèêÈ´òÁ°¨ÁõòÂØøÂëΩ</li>
<li>ÊîØÊåÅÂè™ËØª/ÂèØËØªÂø´ÁÖß</li>
</ul>
<h1 id="ÂùóioÂ±Ç-‰∏é-ioË∞ÉÂ∫¶Âô®">ÂùóI/OÂ±Ç ‰∏é I/OË∞ÉÂ∫¶Âô®</h1>
<h2 id="ÂùóËÆæÂ§á">ÂùóËÆæÂ§á</h2>
<p>ÂØπ‰∫éUnixÁ≥ªÁªüÊù•ËØ¥ÔºåÊúâÁùÄ‰∏ÄÂàáÁöÜÊñá‰ª∂ÁöÑËÆæËÆ°Âì≤Â≠¶ÔºåÂõ†Ê≠§Â§ñÈÉ®ËÆæÂ§áÂú®Êìç‰ΩúÁ≥ªÁªüÁúãÊù•ÊòØ‰∏Ä‰∏™ËÆæÂ§áÊñá‰ª∂„ÄÇËÆæÂ§áÊñá‰ª∂ÂÖ±ÂàÜ‰∏∫‰∏§ÁßçÔºö</p>
<ul>
<li>ÂùóËÆæÂ§áÔºöÊï∞ÊçÆÂèØ‰ª•Ë¢´ÈöèÊú∫ËÆøÈóÆ</li>
<li>Â≠óÁ¨¶ËÆæÂ§áÔºöÊï∞ÊçÆ‰∏çÂèØ‰ª•Ë¢´ÈöèÊú∫ËÆøÈóÆÔºåÊàñËÄÖÂåÖÂê´ÂèóÈôêÂà∂ÁöÑÈöèÊú∫ËÆøÈóÆÔºàËÆæÂ§áÂÜÖÈÉ®ÊûÑÊàêÔºâ</li>
</ul>
<p>ÂùóËÆæÂ§áÁöÑ‰∏Ä‰∏™‰∏ªË¶ÅÁâπÁÇπÂ∞±ÊòØCPUÂíåÊÄªÁ∫øËØªÂÜôÊï∞ÊçÆÁöÑÊó∂Èó¥ÂºÄÈîÄ‰∏éÁ°¨ÁõòÁ°¨‰ª∂ÈÄüÂ∫¶‰∏çÂåπÈÖç„ÄÇ</p>
<p>ÂÜÖÊ†∏ÂÜçÂØπÂùóËÆæÂ§áÂèëÂá∫I/OËØ∑Ê±ÇÊó∂ÔºåÂÜÖÊ†∏Âà©Áî®<code>ÈÄöÁî®ÂùóÂ±Ç</code>ÂèëËµ∑I/OÔºåÊØèÊ¨°I/OËØ∑Ê±ÇÈÉΩÊòØÈÄöËøá‰∏Ä‰∏™<code>bio</code>ÁªìÊûÑ‰ΩìÊù•ÊèèËø∞„ÄÇÈÄöÁî®ÂùóÂ±Ç‰∏ãÁöÑI/OË∞ÉÂ∫¶Á®ãÂ∫è‰ºöÊ†πÊçÆÁ≠ñÁï•Â∞ÜÂæÖÂ§ÑÁêÜÁöÑI/OËØ∑Ê±ÇËøõË°åÂΩíÁ±ªÔºåÂ∞ÜÁõ∏ÈÇªÁöÑËØ∑Ê±ÇËÅöÈõÜÂú®‰∏ÄËµ∑ÔºåÂáèÂ∞ëÁ°¨ÁõòÁ£ÅÂ§¥ÁöÑÁßªÂä®„ÄÇ</p>
<p>ÂùóÊòØÊìç‰ΩúÁ≥ªÁªüÂíåÁ°¨‰ª∂ËÆæÂ§áÂú®‰º†ËæìÊï∞ÊçÆÊó∂ÁöÑÂü∫Êú¨Âçï‰Ωç„ÄÇ</p>
<p>Êú¨Êñá‰∏ªË¶Å‰ªãÁªçmq-deadlineÔºåkyberÔºåbfq‰∏â‰∏™Â§öÈòüÂàóËÆæËÆ°ÁöÑË∞ÉÂ∫¶Âô®</p>
<h2 id="mq-deadline">mq-deadline</h2>
<p>mq-deadlineË∞ÉÂ∫¶Âô®‰∏ªË¶ÅÊ†πÊçÆdeadlineË∞ÉÂ∫¶Âô®Êù•ËÆæËÆ°ÔºåÊòØdeadlineË∞ÉÂ∫¶Âô®ÁöÑÂ§öÈòüÂàóÁâàÊú¨ÔºåÈÄÇÈÖç‰∫ÜblockÂ±ÇÁöÑÂ§öÈòüÂàó</p>
<p>mq-deadlineË∞ÉÂ∫¶Âô®Â∞ÜIOÂàÜ‰∏∫readÂíåwrite‰∏§ÁßçÁ±ªÂûãÔºåÂØπ‰∫éËøôÊØèÁßçÁ±ªÂûãÁöÑIOÊúâ‰∏ÄÊ£µÁ∫¢ÈªëÊ†ëÂíå‰∏Ä‰∏™FIFOÁöÑÈòüÂàóÔºåÁ∫¢ÈªëÊ†ëÁî®‰∫éÂ∞ÜI/OÊåâÁÖßÂÖ∂ËÆøÈóÆÁöÑLBAÊéíÂàóÊñπ‰æøÊü•ÊâæÂêàÂπ∂ÔºåFIFOÈòüÂàóÂàôËÆ∞ÂΩï‰∫ÜI/OËøõÂÖ•mq-deadlineË∞ÉÂ∫¶Âô®ÁöÑÈ°∫Â∫èÔºå‰ª•Êèê‰æõË∂ÖÊó∂ÊúüÈôêÁöÑ‰øùÈöú</p>
<p>readËØ∑Ê±ÇÁöÑI/OÂèØ‰ª•Êä¢Âç†writeÁöÑÂàÜÂèëÊú∫‰ºöÔºå‰ΩÜ‰∏çËÉΩ‰∏ÄÁõ¥Âç†ÊúâÔºåÁª¥Êä§‰∫Ü‰∏Ä‰∏™ËÆ°Êï∞‰øùËØÅreadËØ∑Ê±Ç‰∏ç‰ºöÂØºËá¥writeËØ∑Ê±ÇÈ••È•ø</p>
<p>mq-deadlineË∞ÉÂ∫¶Âô®‰ºö‰ºòÂÖàÂéªÊâπÈáèÂºèÂú∞ÂàÜÂèëI/OËÄå‰∏çÂéªÁÆ°I/OÁöÑÂà∞ÊúüÊó∂Èó¥ÔºåÂΩìÊâπÈáèÂàÜÂèëÂà∞‰∏ÄÂÆöÁöÑ‰∏™Êï∞ÂÜçÂÖ≥ÂøÉÂà∞ÊúüÊó∂Èó¥ÔºåÁÑ∂ÂêéÂéªÂàÜÂèëÂç≥Â∞ÜÂà∞ÊúüÁöÑI/O</p>
<p>ÊúÄÂêémq-deadlineÈíàÂØπsyncÁ©øÈÄèÊÄßI/OËøôÁßçÈúÄË¶ÅÂ∞ΩÂø´ÂèëÈÄÅÂà∞ËÆæÂ§áÁöÑI/OËÆæÁΩÆÂè¶Â§ñ‰∏Ä‰∏™dispatchÈòüÂàóÔºåÁÑ∂ÂêéÊØèÊ¨°Ê¥æÂèëÁöÑÊó∂ÂÄôÈÉΩ‰ºòÂÖàÊ¥æÂèëdispatchÈòüÂàó‰∏äÁöÑI/O</p>
<h2 id="bfq">bfq</h2>
<p>ÂÖ®Áß∞‰∏∫Budget Fair QueueingÔºåbfqÊòØ‰∏ÄÁßçÊØî‰æãÂÖ±‰∫´ÁöÑI/OË∞ÉÂ∫¶Âô®ÔºåÊúâ‰∏Ä‰∫õ‰ΩéÂª∂ËøüËÉΩÂäõ„ÄÇÊîØÊåÅcgroup„ÄÇ</p>
<p>BFQÁöÑ‰∏ªË¶ÅÁâπÁÇπÊúâÔºö</p>
<ul>
<li>BFQ‰øùËØÅ‰∫ÜÁ≥ªÁªüÂíåÂ∫îÁî®Á®ãÂ∫èÁöÑÂìçÂ∫îËÉΩÂäõÔºå‰ª•ÂèäÂØπÊó∂Èó¥ÊïèÊÑüÁ®ãÂ∫è‰øùËØÅ‰ΩéÂª∂ËøüÔºàÈü≥ËßÜÈ¢ëÊí≠ÊîæÔºâ</li>
<li>BFQÂú®ËøõÁ®ãÊàñËÄÖÁªÑ‰πãÈó¥ÂàÜÈÖçÂ∏¶ÂÆΩ„ÄÅÊó∂Èó¥ÔºåÂú®‰øùÊåÅÂêûÂêêÈáèÊó∂ËøõË°åÊó∂Èó¥ÂàÜÈÖç</li>
</ul>
<p>Âú®ÈªòËÆ§ÈÖçÁΩÆ‰∏ãÔºåBFQ‰ºòÂÖàËÄÉËôëÂª∂ËøüËÄåÈùûÂêûÂêêÈáèÔºåÂèØ‰ª•ÈÄöËøáËÆæÁΩÆ<code>low_latency=0</code>Êù•ÂÖ≥Èó≠‰ΩéÂª∂ËøüÂêØÂèëÂºèÁÆóÊ≥ïÔºåÊù•ÊèêÈ´òËÆæÂ§áÂêûÂêêÈáè„ÄÇBFQÈÄöËøáÈîÅÊù•‰øùÊä§ÊØè‰∏™I/OËØ∑Ê±ÇÔºå‰ºöÂ¢ûÂä†‰∏Ä‰∫õÈ¢ùÂ§ñÂºÄÈîÄ„ÄÇ</p>
<p>BFQÊòØ‰∏ÄÁßçÊØî‰æã‰ªΩÈ¢ùË∞ÉÂ∫¶Âô®Ôºå‰∏ªË¶ÅÈÉ®ÂàÜÂÄüÈâ¥‰∫ÜCFQÔºåÊòØ‰∏ÄÁßçÂÖ¨Âπ≥ÁöÑË∞ÉÂ∫¶Âô®„ÄÇ</p>
<ul>
<li>ÊØè‰∏™Âú®ËÆæÂ§á‰∏äÊâßË°åI/OÁöÑËøõÁ®ãÈÉΩ‰∏é‰∏Ä‰∏™ÊùÉÈáçÂíå‰∏Ä‰∏™bfq ÈòüÂàóÁõ∏ÂÖ≥ËÅî</li>
<li>BFQÊéàÊùÉ‰∏Ä‰∏™ÈòüÂàóÔºàËøõÁ®ãÔºâÂèØ‰ª•Âú®‰∏ÄÊÆµÊó∂Èó¥ÂÜÖÂØπËÆæÂ§áÁöÑÁã¨Âç†ËÆøÈóÆÔºåÂπ∂ÈÄöËøáÂ∞ÜÊØè‰∏™ÈòüÂàó‰∏éÈ¢ÑÁÆóÔºàËØ∑Ê±ÇÊâáÂå∫Êï∞ÈáèÔºâÁõ∏ÂÖ≥ËÅîÊù•ÂÆûÁé∞„ÄÇ</li>
<li>ÊØè‰∏™ÈòüÂàóËé∑ÂæóËÆæÂ§áËÆøÈóÆÊéàÊùÉÂêéÔºåÈòüÂàóÁöÑÈ¢ÑÁÆó‰ºöÂú®ÊØèÊ¨°ËØ∑Ê±ÇÂèëÈÄÅÊó∂Ê†πÊçÆËØ∑Ê±ÇÂ§ßÂ∞èÈÄíÂáè</li>
<li>ÂΩìÂèëÁîüÔºöÈòüÂàóÂÆåÊàêÂÖ∂È¢ÑÁÆó„ÄÅÈòüÂàóÊ∏ÖÁ©∫„ÄÅËß¶ÂèëÈ¢ÑÁÆóË∂ÖÊó∂Êó∂ÔºåÈòüÂàóÊâç‰ºöËøáÊúüÔºåÈ¢ÑÁÆóË∂ÖÊó∂Êú∫Âà∂ÂèØ‰ª•Èò≤Ê≠¢ÈöèÊú∫I/OËøõÁ®ãÂØπËÆæÂ§áÈïøÊó∂Èó¥ÁöÑÂç†Áî®Èôç‰ΩéÂêûÂêêÈáè</li>
</ul>
<h2 id="kyber">kyber</h2>
<p>Kyber I/OË∞ÉÂ∫¶Âô®ÊòØLinux‰∏äÈù¢ÈíàÂØπÈ´òÈÄüÂ≠òÂÇ®ËÆæÂ§áÔºàNVMeÈó™Â≠òÔºâËÆæËÆ°ÁöÑ‰∏Ä‰∏™Êñ∞ÁöÑI/OË∞ÉÂ∫¶Âô®ÔºåÈÖçÂíåÂ§öÈòüÂàóÁöÑBlockÂ±Ç‰ΩøÁî®„ÄÇÂú®Linux 4.12ÁöÑÊó∂ÂÄôÂíåBFQË∞ÉÂ∫¶Âô®‰∏ÄËµ∑Êàê‰∏∫ÂÜÖÊ†∏‰∏≠ÁöÑ‰∏Ä‰∏™ÂèØÈÄâÈ°π</p>
<p>KyberË∞ÉÂ∫¶Âô®ÁöÑÂü∫Êú¨ÊÄùË∑ØÊòØ‰ºö‰∏∫ÊØè‰∏Ä‰∏™ÁöÑÁ°¨‰ª∂ÁöÑÈòüÂàóÁª¥Êä§‰∏Ä‰∏™‰∏çÂêåÁ±ªÂûãI/OËØ∑Ê±ÇÁöÑÈòüÂàóÔºåËøô‰∫õËØ∑Ê±Ç‰∏ªË¶ÅÊ†πÊçÆI/OÊìç‰ΩúÁöÑÊñπÂºèÊù•ËøõË°åÂå∫ÂàÜ„ÄÇKyberÊåâÁÖßËØª„ÄÅÂêåÊ≠•ÂÜô‰ª•ÂèäÂÖ∂ÂÆÉÁöÑ(ÂºÇÊ≠•ÂÜôÁ≠â)Â∞ÜI/OËØ∑Ê±ÇÂàÜ‰∏∫‰∫Ü3Á±ª„ÄÇÂú®KyberÁöÑËÆæËÆ°‰∏≠ÔºåÊõ¥Âä†ÂÄæÂêë‰∫éËÆ©ËØª‰ºòÂÖàÔºåËøô‰∏™Á≠ñÁï•‰πüÂíåÂÖ∂ÂÆÉÁöÑ‰∏Ä‰∫õË∞ÉÂ∫¶Âô®ÁöÑËÆæËÆ°Á±ª‰ºº</p>
<p>KyberÂú®‰∏Ä‰∏™Kyber‰∏ä‰∏ãÊñá‰∏≠Áª¥Êä§‰∫ÜÂÖ≥‰∫éËøôÂá†Á±ªËØ∑Ê±ÇÁöÑÈòüÂàó„ÄÇÂÆÉÈÄöËøáÈôêÂà∂ÊØè‰∏Ä‰∏™ÈòüÂàóÁöÑÈïøÂ∫¶Êù•ÂØπÂú®ËøôÈáå‰∫ßÁîüÁöÑËØ∑Ê±ÇÁöÑÂª∂ËøüËøõË°åÊéßÂà∂„ÄÇKyberÂè™ÊúâÂú®Ëøô‰∫õÈòüÂàóÈáåÈù¢ÁöÑËØ∑Ê±ÇË¢´Â§ÑÁêÜ‰∫Ü‰πãÂêéÊâç‰ºöÊî∂ÈõÜÊñ∞ÁöÑËØ∑Ê±Ç„ÄÇËøôÈáåÈôêÂà∂ÁöÑÊñπÂºèÈááÁî®‰∫ÜÂü∫‰∫éTokenÁöÑÊñπÂºè</p>
<p>Áî±‰∫éKyberÈù¢ÂêëÁöÑÊòØÈ´òÈÄüÂ≠òÂÇ®ÔºåËøôÁ±ªËÆæÂ§á‰∏ÄËà¨ÊòØNVMe SSD„ÄÅNVM„ÄÇÈááÁî®Á±ª‰ººCFQ‰∏≠ÁöÑ‰∏Ä‰∫õÂØπËØ∑Ê±ÇÊéíÂ∫èÁöÑÊñπÊ≥ïÂèØËÉΩÊúâÊçü‰∫éÊÄßËÉΩÔºåÊâÄ‰ª•Âú®Kyber‰∏≠Ê≤°ÊúâÂØπËØ∑Ê±ÇÊéíÂ∫èÁöÑÈÄªËæë„ÄÇKyber‰ºöÂØπ‰∏Ä‰∫õI/OËØ∑Ê±ÇËøõË°åÂêàÂπ∂Êìç‰ΩúÔºå‰ª•Âèä‰ºöÂ∞ùËØïÊâπÈáèÂ§ÑÁêÜËøô‰∫õËØ∑Ê±ÇÊù•ÊèêÈ´òÊÄßËÉΩ„ÄÇÊâπÈáèÂ§ÑÁêÜÁöÑÂ§ßÂ∞èÊ†πÊçÆËØ∑Ê±ÇÁ±ªÂûãÊù•ÂÜ≥ÂÆö</p>
<h1 id="nvmeÊé•Âè£ÂçèËÆÆ">NVMeÊé•Âè£ÂçèËÆÆ</h1>
<h2 id="ÁÆÄ‰ªã">ÁÆÄ‰ªã</h2>
<p>NVMeÂçèËÆÆÁöÑ‰∫ßÁîüÊòØ‰∏∫‰∫ÜÂèñ‰ª£Âõ∫ÊÄÅÁ°¨ÁõòÂéüÊúâÁöÑAHCIÂçèËÆÆ+SATAÊé•Âè£ÔºåÈöèÁùÄÂõ∫ÊÄÅÁ°¨ÁõòÊäÄÊúØÁöÑÂèëÂ±ïÔºå‰ΩøÂæóÊÄßËÉΩÁì∂È¢à‰ªéÂ≠òÂÇ®ËÆæÂ§á‰∏äÁöÑËΩ¨ÁßªÂà∞‰∫ÜÂçèËÆÆÂíåÊé•Âè£‰∏≠Ôºå‰∫éÊòØÂõ∫ÊÄÅÁ°¨ÁõòÁöÑÂá†Â§ßÁîü‰∫ßÂïÜ‰∏ÄËµ∑Âà∂ÂÆö‰∫ÜËØ•ÂçèËÆÆ„ÄÇ</p>
<p>NVMeÂÆûÈôÖ‰∏äÊòØÈùûÊòìÂ§±ÊÄßÂ≠òÂÇ®Âô®Ê†áÂáÜÔºå‰∏çÈôê‰∫éÈó™Â≠òSSDÔºå‰ΩøÁî®PCIeÊé•Âè£„ÄÇ</p>
<p>Áõ∏ÊØî‰∫éAHCIÂçèËÆÆÔºåNVMeÁöÑ‰∏ªË¶ÅÁâπÁÇπ‰∏∫Ôºö</p>
<ol>
<li>‰ΩéÊó∂Âª∂ÔºöÂ≠òÂÇ®‰ªãË¥®ÊñπÈù¢ÔºåÂ≠òÂÇ®‰ªãË¥®ÂæóÂà∞‰∫ÜÂ∑®Â§ßÊèêÂçáÔºõÊéßÂà∂Âô®ÊñπÈù¢ÔºåPCIe‰∏ªÊéßÁõ¥Êé•‰∏éCPUÁõ∏ËøûÔºåSATAÊé•Âè£ÈúÄË¶ÅÂçóÊ°•ÊéßÂà∂Âô®‰∏≠ËΩ¨ÂÜçËøûÊé•CPUÔºõËΩØ‰ª∂Êé•Âè£ÊñπÈù¢ÔºåÁÆÄÂåñ‰∫ÜÊåá‰ª§Ë∑ØÂæÑÔºåÊèêÈ´ò‰∫ÜÂπ∂ÂèëËÉΩÂäõ</li>
<li>È´òÊÄßËÉΩÔºöÁõ∏ËæÉ‰∫éAHCIÂÅöÂá∫‰∫ÜÂ§ßÈáè‰ºòÂåñ</li>
<li>‰ΩéÂäüËÄóÔºöËá™Âä®ÂäüËÄóÁä∂ÊÄÅÂàáÊç¢ÔºåÂä®ÊÄÅËÉΩËÄóÁÆ°ÁêÜ</li>
</ol>
<h2 id="nvmeÂ∑•‰ΩúÂéüÁêÜ">NVMeÂ∑•‰ΩúÂéüÁêÜ</h2>
<p>NVMe‰Ωú‰∏∫È´òÂ±ÇÊ¨°ÁöÑÂçèËÆÆÔºåÂéüÂàô‰∏äÂèØ‰ª•Áî®‰∫é‰ªª‰ΩïÊé•Âè£Ôºå‰∏ÄËà¨‰ΩøÁî®PCIe</p>
<p>NVMeÂà∂ÂÆö‰∫Ü‰∏ªÊú∫ÂíåSSD‰πãÈó¥ÁöÑÈÄö‰ø°ÂëΩ‰ª§ÔºåNVMeÂÖ±Êúâ‰∏§ÁßçÂëΩ‰ª§Ôºö</p>
<ul>
<li>AdminÂëΩ‰ª§ÔºöÁî®‰∫é‰∏ªÊú∫ÁÆ°ÁêÜ„ÄÅSSDÊéßÂà∂</li>
<li>I/O ÂëΩ‰ª§ÔºöÁî®‰∫é‰∏ªÊú∫ÂíåSSD‰πãÈó¥ÁöÑÊï∞ÊçÆ‰º†Ëæì</li>
</ul>
<p>AdminÂëΩ‰ª§ÈõÜÊúâÔºö</p>
<img src="/img/image-20221105160942779.png" alt="image-20221105160942779" style="zoom:50%;" />
<p>NVM I/OÊåá‰ª§ÈõÜÊúâÔºö</p>
<img src="/img/image-20221105161030669.png" alt="image-20221105161030669" style="zoom:50%;" />
<h3 id="‰ªé‰∏ªÊú∫ioËØ∑Ê±ÇÂà∞ssd">‰ªé‰∏ªÊú∫I/OËØ∑Ê±ÇÂà∞SSD</h3>
<p>NVMeÊúâ‰∏â‰∏™ÈáçË¶ÅÁöÑÊú∫Âà∂ÔºåSubmission Queue„ÄÅCompletion Queue„ÄÅDoorbell Register„ÄÇ</p>
<p>SQÂíåCQ‰Ωç‰∫é‰∏ªÊú∫ÁöÑÂÜÖÂ≠ò‰∏≠ÔºåDB‰Ωç‰∫éSSDÊéßÂà∂Âô®ÂÜÖÈÉ®Ôºå‰∏ãÂõæÁõ¥ËßÇÁöÑÂ±ïÁ§∫‰∫Ü‰ªñ‰ª¨‰πãÈó¥ÁöÑ‰ΩçÁΩÆÂÖ≥Á≥ª„ÄÇ</p>
<img src="/img/image-20221105161458148.png" alt="image-20221105161458148" style="zoom:50%;" />
<p>Âú®‰∏ªÊú∫ÂèëËµ∑I/OÊåá‰ª§Êó∂ÔºåÁé∞Â∞ÜÊåá‰ª§ÊîæÂú®SQ‰∏≠Ôºå‰∏ªÊú∫‰ºöÈÄöËøá‰øÆÊîπDBÂØÑÂ≠òÂô®Êù•ÈÄöÁü•SSD‰ªéSQ‰∏≠ÂèñÂá∫ÈúÄË¶ÅÊâßË°åÁöÑÊåá‰ª§„ÄÇCQËÆ∞ÂΩï‰∫ÜÊåá‰ª§ÊâßË°åÁöÑÁä∂ÊÄÅÔºàÊàêÂäü/Â§±Ë¥•ÔºâÔºåSSDË¥üË¥£ÂêëCQ‰∏≠ÂÜôÂÖ•ÂëΩ‰ª§ÁöÑÁä∂ÊÄÅ„ÄÇ</p>
<p>NVMeÂØπÊåá‰ª§ÁöÑÂ§ÑÁêÜÊµÅÁ®ãÂèØ‰ª•Áî®‰∏ãÂõæÊù•Ê¶ÇÊã¨Ôºö</p>
<p><img src="/img/image-20221105162016851.png"
	
	
	
	loading="lazy"
	
		alt="image-20221105162016851"
	
	
></p>
<ol>
<li>‰∏ªÊú∫ÂÜôËØ∑Ê±ÇÂà∞SQ</li>
<li>‰∏ªÊú∫ÂÜôSQÂ∞æDBÂØÑÂ≠òÂô®ÔºåÈÄöÁü•SSDÈúÄË¶ÅÊâßË°åI/OËØ∑Ê±Ç</li>
<li>SSDÊéßÂà∂Âô®ÂèñÂá∫SQ‰∏≠ÁöÑËØ∑Ê±Ç</li>
<li>SSDÊéßÂà∂Âô®ÊâßË°åÂëΩ‰ª§</li>
<li>SSDÊéßÂà∂Âô®Â∞ÜËØ∑Ê±ÇÁöÑÁä∂ÊÄÅÂÜôÂÖ•CQ</li>
<li>SSDÊéßÂà∂Âô®ÂèëÂá∫MSI-X‰∏≠Êñ≠ÔºåÈÄöÁü•‰∏ªÊú∫Êåá‰ª§ÂÆåÊàê</li>
<li>‰∏ªÊú∫Êî∂Âà∞‰∏≠Êñ≠ÂêéÔºåÂ§ÑÁêÜCQÔºåÁúãÊü•ËØ∑Ê±ÇÁöÑÂÆåÊàêÁä∂ÊÄÅ</li>
<li>‰∏ªÊú∫ÂÜôÂÖ•CQÂ§¥DBÂØÑÂ≠òÂô®ÔºåÂëäÁü•SSDËØ•Êåá‰ª§ÁöÑÁªìÊûúÂ∑≤ÁªèÊî∂Âà∞Âπ∂Â§ÑÁêÜ</li>
</ol>
<h2 id="submission-queueÂíåcompletion-queueÁÆÄ‰ªã">Submission QueueÂíåCompletion QueueÁÆÄ‰ªã</h2>
<p>Áî±‰∫éNVMeÁöÑSQ„ÄÅCQÊú∫Âà∂ÔºåËøô‰∏§‰∏™Êï∞ÊçÆÁªìÊûÑÂøÖÁÑ∂ÊòØÊàêÂØπÂ≠òÂú®ÁöÑÔºå‰πüÂ≠òÂú®Â§öÂØπ‰∏ÄÁöÑÂÖ≥Á≥ª„ÄÇ</p>
<p>ÂØπ‰∫éI/OÊåá‰ª§ÂíåAdminÊåá‰ª§ÔºåÂàÜÂà´Áî±‰∏ìÊúâÁöÑSQÂíåCQËøõË°åÁÆ°ÁêÜÔºåÂç≥Admin SQ/CQÂíåI/O SQ/CQ„ÄÇ</p>
<p>I/O SQÂíåSQÊòØÈÄöËøáAdminÁöÑÁõ∏ÂÖ≥Êåá‰ª§Êù•ËøõË°åÂàõÂª∫ÁöÑ„ÄÇ</p>
<p>‰∏ªÊú∫ÊñπÈù¢ÊØè‰∏™CPUÊ†∏ÂøÉÂèØ‰ª•Êúâ‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™SQÔºå‰ΩÜÊòØÂè™ËÉΩÊúâ‰∏Ä‰∏™CQ„ÄÇ‰∏Ä‰∏™Ê†∏ÂøÉÂàõÂª∫Â§ö‰∏™SQ‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÊèêÈ´òÂ§öÁ∫øÁ®ãÁöÑÂπ∂ÂèëËÉΩÂäõÔºåÂêåÊó∂ÂèØ‰ª•ÂØπ‰∏çÂêåSQËÆæÁΩÆ‰ºòÂÖàÁ∫ßÊù•ÊèêÈ´òÊúçÂä°Ë¥®Èáè„ÄÇ</p>
<p><img src="/img/image-20221105165937311.png"
	
	
	
	loading="lazy"
	
		alt="image-20221105165937311"
	
	
></p>
<p>ÂØπ‰∫éAdmin SQ/CQÈòüÂàóÔºåÊ∑±Â∫¶Âú®$2-4096(4K)$</p>
<p>ÂØπ‰∫éI/O SQ/CQÈòüÂàóÔºåÊ∑±Â∫¶Âú®$2-65536(64K)$Ôºå‰∏Ä‰∏™SQÂëΩ‰ª§Êù°ÁõÆÂ§ßÂ∞è‰∏∫$64Byte$Ôºå‰∏Ä‰∏™CQÊù°ÁõÆÂ§ßÂ∞è‰∏∫$16Byte$ÔºåÈòüÂàóÊ∑±Â∫¶ÂèØ‰ª•Ëá™Ë°åÈÖçÁΩÆ„ÄÇ</p>
<p>‰∏Ä‰∏™PCIeÊé•Âè£‰πüÊîØÊåÅÂ§ö‰∏™lane„ÄÇ</p>
<p>Êï¥‰∏™NVMeÁöÑÂ∑•‰ΩúÊµÅÁ®ãÂÉèÊòØÂ¶Ç‰∏ãÂõæÊâÄÁ§∫ÁöÑ‰∏§‰∏™Áîü‰∫ßËÄÖÊ∂àË¥πËÄÖÊ®°Âûã</p>
<p><img src="/img/image-20221105234231636.png"
	
	
	
	loading="lazy"
	
		alt="image-20221105234231636"
	
	
></p>
<h2 id="db-doorbell-register">DB: Doorbell Register</h2>
<p>Âú®SQÂíåCQÈòüÂàó‰∏≠ÈÉΩÊúâHeadÂíåTailÔºåÂπ∂‰∏îÂàÜÂà´ÊúâÂØπÂ∫îÁöÑDoorbellÔºåÂç≥Head DBÂíåTail DBÔºåDBÂú®SSD‰∏ÄÁ´ØÔºåËÆ∞ÂΩïSQÂíåCQÈòüÂàóÂ§¥„ÄÅÂ∞æÁöÑ‰ΩçÁΩÆ„ÄÇ</p>
<p>ÂØπ‰∫éSSDËÄåË®ÄÔºåË¶ÅÈ¢ëÁπÅ‰ªéSQÂ§¥ÂèñÂá∫Êï∞ÊçÆÔºåÂèØ‰ª•ËΩªÊùæÁöÑËé∑ÂèñSQÈòüÂ§¥ÁöÑ‰ΩçÁΩÆÔºåÊâÄ‰ª•SQ Head DBÁî±SSDÊù•Áª¥Êä§ÔºåËÄåÂØπ‰∫éSQÁöÑÈòüÂ∞æÂØπ‰∫é‰∏ªÊú∫ËÄåË®ÄÊõ¥ÂÆπÊòìÁª¥Êä§ÔºåÂõ†‰∏∫Ë¶ÅÈ¢ëÁπÅÁöÑÂêëÈòüÂ∞æÊèíÂÖ•Êï∞ÊçÆÔºåÂõ†Ê≠§SQ Tail DBÁî±‰∏ªÊú∫Áª¥Êä§ÔºåSSDÊ†πÊçÆSQÁöÑÂ§¥Â∞æÂèØ‰ª•Ëé∑ÂèñÂΩìÂâçÈòüÂàó‰∏≠<code>ÊúâÂ§öÂ∞ëËØ∑Ê±ÇÂú®Á≠âÂæÖÊâßË°å</code>„ÄÇÂêåÁêÜÔºåCQ Head DBÁî±‰∏ªÊú∫Êù•Áª¥Êä§ÔºåCQ Tail DBÁî±SSDÊù•Áª¥Êä§ÔºåSSDÊ†πÊçÆCQÈòüÂàóÁöÑÂ§¥Â∞æÊù•Âà§Êñ≠CQÈòüÂàóÊòØÂê¶ËøòËÉΩÊé•ÂèóÊñ∞ÁöÑ<code>ËØ∑Ê±ÇÂÆåÊàê‰ø°ÊÅØ</code>„ÄÇ</p>
<p>‰ªéDoorbellÁöÑÂêçÂ≠óÊù•ÁúãÔºåËøòÊúâÈÄöÁü•ÁöÑ‰ΩúÁî®ÔºåÂΩìDoorbell RegisterÁöÑÂÄºÊîπÂèòÊó∂ÔºåSSDÂ∞±Áü•ÈÅìÊúâÊñ∞ÁöÑËØ∑Ê±ÇÈúÄË¶ÅÂ§ÑÁêÜÔºõ‰∏ªÊú∫Â∞±Áü•ÈÅìÊúâÊñ∞ÁöÑËØ∑Ê±ÇÂ∑≤ÁªèÂÆåÊàê‰∫Ü„ÄÇ</p>
<p>Ê≥®ÊÑèÔºöÂØπ‰∫é‰∏ªÊú∫Êù•ËØ¥ÔºåDBÊòØÂèØ‰ª•ÂÜô‰∏çÂèØËØªÁöÑ„ÄÇ</p>
<h2 id="ÂÖ∂‰ªñÊúâÂÖ≥nvmeÁöÑÂÜÖÂÆπ">ÂÖ∂‰ªñÊúâÂÖ≥NVMeÁöÑÂÜÖÂÆπ</h2>
<p>ÂØªÂùÄÈóÆÈ¢òÔºàPRP„ÄÅSGLÔºâ</p>
<p>Namespace</p>
<p>Êï∞ÊçÆ‰øùÊä§ÈóÆÈ¢ò</p>
<p>ÂêéÁª≠ÊúâÊó∂Èó¥ÂÜçÂØπËøô‰∫õÂÜÖÂÆπËøõË°åÂ≠¶‰π†</p>
<h1 id="Âü∫‰∫éÈó™Â≠òÁöÑÂõ∫ÊÄÅÁõò">Âü∫‰∫éÈó™Â≠òÁöÑÂõ∫ÊÄÅÁõò</h1>
<p>Ê≠§Ââç‰∏ÄÁØáÂçöÂÆ¢Êï¥ÁêÜ‰∫ÜÊúâÂÖ≥Èó™Â≠òÂíåÂõ∫ÊÄÅÁõòÁöÑÂÜÖÂÆπÔºå‰∏ãÊñá‰∏∫ËΩ¨ËΩΩËøáÊù•ÁöÑÂÜÖÂÆπ</p>
<p><a class="link" href="https://blog.ipandai.club/p/%e5%ad%98%e5%82%a8%e6%8a%80%e6%9c%af%e5%9f%ba%e7%a1%80%e5%9b%ba%e6%80%81%e7%a1%ac%e7%9b%98/"  target="_blank" rel="noopener"
    >Flash Memory &amp;&amp; Âõ∫ÊÄÅÁ°¨Áõò</a></p>
<p>‰∏ªË¶ÅÁî±Flash Memory ÂíåFTLÁªÑÊàê</p>
<p>Non-Volatile Memory Êèê‰æõ‰ΩéÂª∂ËøüÊåÅ‰πÖÊÄßÁöÑÂÜÖÂ≠ò/Â≠òÂÇ®Ôºå‰πüÂèØ‰ª•Áî®Êù•ÂÅöÂÜÖÂ≠ò</p>
<p>Ê†πÊçÆÂª∂ËøüÊï∞ÈáèÁ∫ßÔºå‰∏ÄËà¨Áî®PCMÂÅöÂÜÖÂ≠òÔºåFlash MemoryÂÅöÂ§ñÂ≠ò</p>
<h2 id="flash-memory">Flash Memory</h2>
<h3 id="Èó™Â≠òÂéüÁêÜ">Èó™Â≠òÂéüÁêÜ</h3>
<h4 id="Á±ªÂûã">Á±ªÂûã</h4>
<p>NORÈó™Â≠ò</p>
<ul>
<li>Â≠òÂÇ®ÂØÜÂ∫¶‰Ωé</li>
<li>ÂèØÂ≠óËäÇÊîπÂÜô</li>
</ul>
<p>NANDÈó™Â≠òÔºà‰∏ªÊµÅÔºâ</p>
<ul>
<li>Â≠òÂÇ®ÂØÜÂ∫¶È´ò</li>
<li>‰∏çÂèØË¶ÜÁõñÂÜô</li>
</ul>
<p>Áî®‰∫éÂ§ñÂ≠òÈúÄË¶ÅËæÉÈ´òÁöÑÂ≠òÂÇ®ÈáèÁ∫ßÔºå‰∏ÄËà¨Áî®NAND</p>
<h4 id="Èó™Â≠òÂçïÂÖÉ">Èó™Â≠òÂçïÂÖÉ</h4>
<p>ËØªÔºöÁîµÂéã‰ª£Ë°®‰∏çÂêåÊï∞ÂÄº</p>
<p>ÂÜôÔºöÁîµÂ≠êÊ≥®ÂÖ•</p>
<p>Áõ∏ÊØîÊô∂‰ΩìÁÆ°Ê∑ªÂä†‰∫ÜÊµÆÊ†ÖÈó®Ôºå‰øùÂ≠òÁîµÂ≠ê</p>
<p>ÂéüÁêÜÂÖ∂ÂÆûÊØîËæÉÁÆÄÂçïÔºåÈùûÁîµÂ≠êÁ≥ªÂ∞±‰∏çÂÅöÂ§™ËØ¶ÁªÜÁöÑÁ†îÁ©∂‰∫Ü</p>
<p>Èó™Â≠òÈ°µ(4KB,8KB,16KBÔºåËØªÂÜôÂçïÂÖÉ)ÔºåÈòµÂàó‰∏≠ÁöÑÊØè‰∏ÄË°å</p>
<p>Èó™Â≠òÂùó(Êì¶Èô§ÂçïÂÖÉ)ÔºåÁî±Â§ö‰∏™È°µÁªÑÊàêÁöÑÂçïÂÖÉ</p>
<img src="/img/image-20220922124359358.png" alt="image-20220922124359358" style="zoom:33%;" />
<p>ÈÄâ‰∏≠Ë°åÂíåÂàóÔºåÁÑ∂ÂêéÂ∞ÜÊï∞ÊçÆÂä†ËΩΩÂà∞Sense Amplifiers</p>
<p>Â≠òÂÇ®ÂçïÂÖÉÊúâ‰∏§‰∏™ÈòàÂÄºÁöÑÁîµÂéãÔºåÂèØ‰ª•Ê†πÊçÆ‰∏§‰∏™ÁîµÂéãÁöÑ‰∏≠ÁÇπ‰Ωú‰∏∫ËØªÁîµÂéãÔºå2.5VËØªÁîµÂéãÊó∂Â∑¶ËæπÈÄöÁîµÔºåÊï∞ÊçÆ‰∏∫1ÔºåÂè≥ËæπÂàô‰∏çÈÄöÁîµÔºåÊï∞ÊçÆ‰∏∫0</p>
<img src="/img/image-20220922124755447.png" alt="image-20220922124755447" style="zoom:25%;" />
<p>Pass Through</p>
<p>ÈÄâÂèñ‰∏Ä‰∏™ËæÉÂ§ßÁöÑÁîµÂéãÔºå‰ΩøÂæóÊâÄÊúâÁöÑÂçïÂÖÉÈÉΩÊé•ÈÄöÔºåÊï∞ÊçÆ‰∏∫1Ôºå‰∏çÂΩ±ÂìçÂÖ∂‰ªñË°åÁöÑÁä∂ÊÄÅ</p>
<img src="/img/image-20220922131649578.png" alt="image-20220922131649578" style="zoom:25%;" />
<p>Â¶ÇÂõæÊâÄÁ§∫ÁöÑÂ≠òÂÇ®ÁªìÊûÑÔºåÂú®Á¨¨‰∫åË°åÊñΩÂä†2.5VÁîµÂéãÔºåÂÖ∂‰ªñË°åÊñΩÂä†5VÔºåÊúÄÁªàËØªÂèñÊï∞ÊçÆ‰∏∫0011</p>
<img src="/img/image-20220922134857889.png" alt="image-20220922134857889" style="zoom:33%;"/>
<p>‰∏äËø∞‰∏∫SLCÔºåSingle Level CellÔºåÂçïÂ≠òÂÇ®ÂçïÂÖÉ</p>
<h4 id="Â§öÊØîÁâπÈó™Â≠ò">Â§öÊØîÁâπÈó™Â≠ò</h4>
<p>Â§öÊØîÁâπÈó™Â≠òÂçïÂÖÉMLCÔºåÂåÖÂê´2Bits 4‰∏™LevelÁöÑÊï∞ÊçÆ</p>
<p>TLC 3 Bits 8‰∏™Level</p>
<p>QLC 4 Bits 16‰∏™Level</p>
<p><strong>Â§öÊØîÁâπ‰ΩøÁî®Ê†ºÈõ∑Á†ÅÊù•ÁºñÁ†Å</strong></p>
<blockquote>
<p>‰ΩøÁî®Ê†ºÈõ∑Á†Å‰ΩøÂæóÁõ∏ÈÇªÂçïÂÖÉÂè™Êúâ‰∏Ä‰ΩçÂ∑ÆÂºÇÔºåÊñπ‰æøÁ∫†Èîô</p>
</blockquote>
<p>Â§öÊØîÁâπÊèêÈ´ò‰∫ÜÂ≠òÂÇ®ÂØÜÂ∫¶Ôºå‰ΩÜÊòØÊèêÈ´ò‰∫ÜÈîôËØØÁéáÔºåÂõ†‰∏∫ÊñΩÂä†ÁöÑÁîµÂéãÂ∑ÆË∑ùÂæàÂ∞è„ÄÇÂèØÈù†ÊÄß‰ºöÈôç‰Ωé„ÄÇ</p>
<img src="/img/image-20220922135516463.png" alt="image-20220922135516463" style="zoom:45%;" />
<p>ÂØπ‰∫éÂ§öÊØîÁâπÁöÑÂÜôÔºåMLCÂàÜ‰∏∫È´òÊØîÁâπÂíå‰ΩéÊØîÁâπÔºåÂØπ‰∫é‰ΩéÊØîÁâπÁöÑÁä∂ÊÄÅÂä†ÂÅèÁßªÁîµÂéãÁ°ÆÂÆöÈ´òÊØîÁâπÔºåÂú®‰ΩéÊØîÁâπÊó∂ÈúÄË¶ÅÂä†ÁöÑÁîµÂéãËæÉÂ§ßÔºåÊìç‰ΩúÈöæÂ∫¶‰ΩéÔºåËøêË°åÈÄüÂ∫¶Âø´ÔºåÂú®È´òÊØîÁâπÊó∂ÈúÄË¶ÅÂä†ÁöÑÁîµÂéãÂ∞èÔºåÊ≥¢ÂΩ¢ÁöÑÈó¥Ë∑ùÂ∞èÔºåÊìç‰ΩúÈöæÂ∫¶È´òÔºåËøêË°åÁöÑÈÄüÂ∫¶ËæÉÊÖ¢„ÄÇ</p>
<img src="/img/image-20220922140421405.png" alt="image-20220922140421405" style="zoom:40%;" />
<p>ÂØπ‰∫éÂ§öÊØîÁâπÁöÑËØªÔºåÂÖàÁúãlower bitÔºåÂä†‰∏ÄÊ¨°ÁîµÂéãÔºåÂç≥ÂèØÁ≠õÈÄâÂá∫‰Ωé‰ΩçÁöÑ0Ôºå1ÔºåÂÜçÂä†‰∏§Ê¨°ÁîµÂéãÁ°ÆÂÆöupper bit„ÄÇÂõ†‰∏∫upper bit‰∏∫0ÁöÑÂú®‰∏≠Èó¥ÈÉ®ÂàÜÔºå‰∏∫1ÁöÑÂú®‰∏§‰æßÔºåÂõ†Ê≠§ÈúÄË¶ÅÂú®‰∏§‰∏™ÂàÜÁïåÁ∫øÂàÜÂà´Âä†‰∏ÄÊ¨°ÁîµÂéãÊù•Á°ÆÂÆöupper bit‰∏∫Â§öÂ∞ë„ÄÇ</p>
<img src="/img/image-20220922141455826.png" alt="image-20220922141455826" style="zoom:40%;" />
<h4 id="Èó™Â≠ò">Èó™Â≠ò</h4>
<p>BlockÁöÑÂ§ßÂ∞èÁöÑ‰∏ÄÁßçÈÖçÁΩÆÔºö</p>
<p>‰∏ÄË°åÊúâ‰∏§‰∏™PageÔºåUpper PageÂíåLower PageÔºåÊØè‰∏™ÂçïÂÖÉ‰∏≠Ôºå‰Ωé‰ΩçÊûÑÊàêLower PageÔºåÈ´ò‰ΩçÊûÑÊàêUpper PageÔºåÊúâ128‰∏™ÂçïÂÖÉÔºå128K/8=16KB</p>
<p>Êúâ64ÂàóbitlinesÔºå‰∏Ä‰∏™blockÁöÑÂ§ßÂ∞èÂç≥‰∏∫<code>16KB*64*2=2MB</code>Ôºå‰∏ÄËà¨ÊåâÁÖßÊ≠§ÊØî‰æãÈÖçÁΩÆBlock</p>
<p>ÂÜôÂÖ•Êó∂ÊåâÁÖßÂõ∫ÂÆöÈ°∫Â∫èÔºåÂÜôÂÖ•È´ò‰ΩéÈ°µÈù¢Áõ∏‰∫íÁã¨Á´ãÔºå‰∏çËÉΩÂêåÊó∂ÂÜôÔºåÂú®ÂÜôÂÖ•Âä†ÂéãÊó∂ÂÆπÊòì‰ΩøÁõ∏ÈÇªÂçïÂÖÉÂèëÁîüÊï∞ÊçÆÂÅèÁßªÔºåË¶ÅÈôç‰ΩéÈîôËØØÁéá</p>
<p>ÂÜôÂÖ•ÊòØÈúÄË¶ÅÂÖàÊì¶Èô§ÂÜçÂÜôÂÖ•ÔºåÊì¶Èô§Êï¥‰∏™Âùó</p>
<img src="/img/image-20220922143608667.png" alt="image-20220922143608667" style="zoom:50%;" />
<h4 id="Èó™Â≠òÁâπÊÄß">Èó™Â≠òÁâπÊÄß</h4>
<h5 id="ËØªÂÜôÁ≤íÂ∫¶">ËØªÂÜôÁ≤íÂ∫¶</h5>
<p>Èó™Â≠òÈ°µËØªÂÜôÁ≤íÂ∫¶Ôºö</p>
<ul>
<li>4KBÔºå8KBÔºå16KBÂøÖÈ°ªÂÖ®ÈÉ®ËØªÂèñÊàñËÄÖÂÜôÂÖ•</li>
<li>usÂª∂Ëøü</li>
</ul>
<p>Èó™Â≠òÂùóÊì¶Èô§ÂäõÂ∫¶</p>
<ul>
<li>2MBÊì¶Èô§</li>
<li>msÂª∂ËøüÔºåÂèØ‰ª•ÈÄöËøáFTLÊù•‰ºòÂåñ</li>
</ul>
<h5 id="‰∏çÂèØË¶ÜÁõñÂÜô">‰∏çÂèØË¶ÜÁõñÂÜô</h5>
<p>ÂÜôÂâçÈúÄË¶ÅÊì¶Èô§ÔºåËØªÂÜôÁ≤íÂ∫¶‰∏éÊì¶Èô§Á≤íÂ∫¶‰∏çÂêå</p>
<p>Â≠òÂú®64bytesÁöÑOOBÔºàout of bound areaÔºâÔºå‰øùÂ≠òECCÔºåÁî®‰∫éÁ∫†ÈîôÔºåÂÆπÂøçÂÜôÂÖ•Êó∂ÈÉ®ÂàÜÊØîÁâπÂá∫Èîô</p>
<img src="/img/image-20220922162139217.png" alt="image-20220922162139217" style="zoom:50%;" />
<h5 id="ÊúâÈôêÊ¨°Êì¶Èô§">ÊúâÈôêÊ¨°Êì¶Èô§</h5>
<p>ÈöèÁùÄÊì¶Èô§Ê¨°Êï∞ÁöÑÂ¢ûÂä†ÔºåÂ≠òÂÇ®ÂçïÂÖÉ‰∏çËÉΩÂèØÈù†ÁöÑ‰øùÊåÅÁä∂ÊÄÅÔºàÂ≠òÂÇ®Êï∞ÊçÆÔºâ„ÄÇ</p>
<p>Ê∞ßÂåñÂ±ÇËÄÅÂåñÂèòËñÑÔºåÊùüÁºöÁîµÂ≠êËÉΩÂäõÂèòÂº±</p>
<ul>
<li>ËÄê‰πÖÊÄß ÂèòËñÑÂú∞Ê¨°Êï∞</li>
<li>‰øùÊåÅÂäõ ‰∏çÈÄöÁîµÂèØ‰ª•ÊîæÁΩÆÁöÑÊó∂Èó¥</li>
</ul>
<p>SLCÔºö10wÊ¨°</p>
<p>MLCÔºö1wÊ¨°</p>
<p>TLCÔºö1kÊ¨°</p>
<p>Ê†πÊçÆÁâπÊÄßÊù•ËÆæËÆ°FTLÂõ∫‰ª∂</p>
<img src="/img/image-20220922164523965.png" alt="image-20220922164523965" style="zoom:50%;" />
<h2 id="ftl">FTL</h2>
<p>Âõ∫ÊÄÅÁ°¨ÁõòÊï¥‰ΩìÊûÑÊàê</p>
<img src="/img/image-20220922164728094.png" alt="image-20220922164728094" style="zoom:50%;" />
<p>SSD‰∏≠ÁöÑÈÄöÈÅìÂèØ‰ª•Âπ∂Ë°åÔºåÈÄöÈÅì‰∏≠‰πüÂèØ‰ª•Âπ∂Ë°åËØªÂèñÔºåÊØè‰∏™Plane‰∏≠ÊúâÂØÑÂ≠òÂô®ÔºåÊöÇÊó∂Â≠òÂÇ®ÂáÜÂ§áÂ•ΩÁöÑÊï∞ÊçÆ„ÄÇ‰∏çÂêåÂçïÂÖÉÂπ∂Ë°åÔºåÂõ†Ê≠§ÂÜÖÈÉ®Â∏¶ÂÆΩÂ§ß</p>
<img src="/img/image-20220922165354311.png" alt="image-20220922165354311" style="zoom:50%;" />
<h3 id="ÂûÉÂúæÂõûÊî∂">ÂûÉÂúæÂõûÊî∂</h3>
<p>pageÂØπ‰∫éOSËÄåË®ÄÔºåÊòØÂÜôÂÖ•Êó∂ÁöÑblock</p>
<p>Page‰∏âÁßçÁä∂ÊÄÅ</p>
<ul>
<li>Á©∫Èó≤ free page</li>
<li>ÊúâÊïàÈ°µ live/valid page</li>
<li>Êó†ÊïàÈ°µ dead/invalid page</li>
</ul>
<img src="/img/image-20220922184349456.png" alt="image-20220922184349456" style="zoom:25%;" />
<p>ÈúÄË¶ÅÊì¶Èô§Êó†ÊïàÈ°µÔºåÂÖàÁßªËµ∞ÊúâÊïàÈ°µÔºåÁÑ∂ÂêéÂÜçÂØπ‰∏ÄÊï¥Ë°åËøõË°åÊì¶Èô§ÔºåËΩ¨‰∏∫Á©∫Èó≤</p>
<img src="/img/image-20220922184406162.png" alt="image-20220922184406162" style="zoom:25%;" />
<p>Êó∂Èó¥ÂºÄÈîÄÔºö</p>
<ul>
<li>Â§çÂà∂ÊúâÊïàÊï∞ÊçÆÂà∞$(R_{Latency}+W_{Latency})*N$ÔºåNÊòØÁßªÂä®pageÁöÑÊï∞Èáè</li>
<li>Êì¶Èô§‰∫ßÁîüÁöÑÂºÄÈîÄ msÁ∫ßÂª∂Ëøü</li>
</ul>
<h4 id="gcÁ≠ñÁï•">GCÁ≠ñÁï•</h4>
<p>Ë¶ÅËß£ÂÜ≥ÁöÑÈóÆÈ¢òÔºö</p>
<ul>
<li>‰ΩïÊó∂ÂêØÂä®GC</li>
<li>ÈÄâ‰∏≠ÈÇ£‰∫õ/Â§öÂ∞ëBlockËøõË°åGC</li>
<li>ÊúâÊïàÁöÑÈ°µÂ¶Ç‰ΩïË¢´ËΩ¨ÂÜô</li>
<li>Êñ∞Êï∞ÊçÆÂÜôÂà∞Âì™Èáå</li>
</ul>
<p>GCÁöÑÊó∂Èó¥ÂºÄÈîÄÔºö</p>
<ul>
<li>ÂùóÊì¶Èô§ÁöÑÊó∂Èó¥ ms</li>
<li>ÊúâÊïàÈ°µÁöÑÂ§çÂà∂Êó∂Èó¥</li>
</ul>
<p>Ë¥™ÂøÉÁ≠ñÁï•Ôºö</p>
<ul>
<li>ÊâæÂà∞ËÑèÈ°µÊúÄÂ§öÁöÑblockÊù•ËøõË°åÊì¶Èô§</li>
</ul>
<p>‰ºòÂåñÔºö</p>
<ul>
<li>Age</li>
<li>Hot/Cold Êï∞ÊçÆÈöîÁ¶ªÔºåÂàÜÁªÑÈóÆÈ¢ò</li>
</ul>
<h3 id="Á£®ÊçüÂùáË°°">Á£®ÊçüÂùáË°°</h3>
<p>‰ºòÂåñÂØøÂëΩÔºåÊúâÈùôÊÄÅÂíåÂä®ÊÄÅÁ≠ñÁï•</p>
<p>ÈùôÊÄÅÔºöÂë®ÊúüÊÄßÁöÑË∞ÉÊï¥ÂÜ∑ÁÉ≠Êï∞ÊçÆÂ≠òÂÇ®ÁöÑ‰ΩçÁΩÆ</p>
<p>ÂÜ∑ÁÉ≠Êï∞ÊçÆÁöÑÂàÜÂå∫ÔºöÂ∞ÜÂÜ∑Êï∞ÊçÆÊîæÂú®‰∏ÄËµ∑ÔºåÁÉ≠Êï∞ÊçÆÊîæÂú®‰∏ÄËµ∑</p>
<h3 id="ftlÁÆÄ‰ªã">FTLÁÆÄ‰ªã</h3>
<ul>
<li>
<p>Áª¥Êä§Êò†Â∞ÑÔºåËôöÊãüÂú∞ÂùÄÂà∞Áâ©ÁêÜÂú∞ÂùÄ</p>
</li>
<li>
<p>‰ΩøÁî®SRAMÂ≠òÂÇ®Êò†Â∞Ñ</p>
</li>
<li>
<p>Âêë‰∏äÂ±ÇÈöêËóèÊì¶Èô§Êìç‰ΩúÔºö</p>
<ul>
<li>
<p>ÈÅøÂÖçÂéüÂú∞Êõ¥Êñ∞-&gt;ÂºÇÂú∞Êõ¥Êñ∞</p>
</li>
<li>
<p>Êõ¥Êñ∞‰∏Ä‰∏™Êñ∞È°µÈù¢</p>
</li>
<li>
<p>È´òÊÄßËÉΩÁöÑÂûÉÂúæÂõûÊî∂ÂíåÊì¶Èô§</p>
</li>
</ul>
</li>
</ul>
<p>OOBÊúâÁâ©ÁêÜÂú∞ÂùÄÂà∞ËôöÊãüÂú∞ÂùÄÁöÑÊò†Â∞ÑÔºåÁî®‰∫éÊéâÁîµÊÅ¢Â§çÔºåËøôÈáåÂºïÁî®‰∏ÄÊÆµ<a class="link" href="https://pages.cs.wisc.edu/~remzi/OSTEP/file-ssd.pdf"  target="_blank" rel="noopener"
    >wiscÁöÑOSTEP‰∏≠ÁöÑ‰∏ÄÊÆµËß£ÈáäÔºà44 Flash- based SSDÔºâ</a>„ÄÇ</p>
<p>OOB‰øùÂ≠òÁöÑÂú®ÊØè‰∏™È°µ‰∏≠Êò†Â∞Ñ‰ø°ÊÅØÔºåÂΩìÊéâÁîµÊàñËÄÖÈáçÂêØÊó∂Áî®ÂÆÉÂú®ÂÜÖÂ≠ò‰∏≠ÈáçÂª∫Êò†Â∞Ñ</p>
<p>‰∏∫‰∫ÜÈò≤Ê≠¢Âú®ÈáçÂª∫Êó∂Êâ´Á†ÅÊï¥‰∏™SSDÔºåÂèØ‰ª•‰ΩøÁî®Êó•ÂøóÊàñËÄÖÊ£ÄÊü•ÁÇπÁöÑÊñπÂºèÊù•Âä†ÈÄüËøô‰∏™ËøáÁ®ã</p>
<p>Â§ßËá¥Áúã‰∫Ü‰∏Ä‰∏ãOSTEPÔºåÊòØÊúâÂÖ≥Êìç‰ΩúÁ≥ªÁªüÁöÑ‰∏ÄÊú¨ÈùûÂ∏∏Â•ΩÁöÑ‰π¶ÔºåÂ∏åÊúõ‰ª•ÂêéÊúâÊó∂Èó¥ËØª‰∏Ä‰∏ã</p>
<img src="/img/image-20220924141132556.png" alt="image-20220924141132556" style="zoom:50%;" />
<h3 id="page-level-ftl">Page-Level FTL</h3>
<p>ÂéüÁêÜÁ±ª‰ººOS‰∏≠ÁöÑÈ°µË°®ÔºåÁî±Logical Page NumberÊü•ËØ¢È°µË°®ÂæóÂà∞Physical Page Number</p>
<p>Áº∫ÁÇπÊòØÈ°µË°®Âç†Áî®ÂæàÂ§ßÁöÑÁ©∫Èó¥</p>
<img src="/img/image-20220924152322358.png" alt="image-20220924152322358" style="zoom:50%;" />
<h3 id="block-level-ftl">Block-Level FTL</h3>
<p>‰øùÊåÅBlock Âà∞BlockÁöÑÊò†Â∞Ñ</p>
<p>ÂÖàÊü•ÊâæÂà∞ÂØπÂ∫îÁöÑBlockÔºåÂú®Ê†πÊçÆoffsetÂæóÂà∞pageÔºåÂùóÂÜÖÁöÑÈ°µÁ†ÅÂÅèÁßªoffsetÊòØÂõ∫ÂÆöÁöÑ</p>
<img src="/img/image-20220924152259043.png" alt="image-20220924152259043" style="zoom:50%;" />
<p>‰ºòÁÇπÊòØÂç†Áî®Á©∫Èó¥ÂæàÂ∞èÔºåÁº∫ÁÇπÊòØGCË¥üËΩΩÂ¢ûÂä†</p>
<p>ÂéüÂõ†ÔºöoffsetÂú®‰∏çÂêåBlock‰∏≠‰øùÊåÅ‰∏çÂèòÔºåÂú®ÂºÇÂú∞Êõ¥Êñ∞Êó∂ÔºåË¶ÅÈÄâÊã©ÂÖ∂‰ªñblock‰∏≠Áõ∏ÂêåÁöÑoffsetËøõË°åÂÜôÂÖ•ÔºåÂ¶ÇÊûúÈÄâ‰∏≠ÁöÑblockÂ∑≤ÁªèÂ≠òÂú®Êï∞ÊçÆÔºåÈúÄË¶ÅÊääÊï∞ÊçÆËøÅÁßª„ÄÇ„ÄêTODO ËøôÈáåËÆ≤Âæó‰∏çÊòØÈùûÂ∏∏ÁöÑÊ∏ÖÊ•ö„Äë</p>
<h3 id="hybrid-ftl">Hybrid FTL</h3>
<p>ÂØπÂÜôÂÖ•ÂàÜ‰∏∫Êñ∞/ÊóßÊï∞ÊçÆÔºåÊñ∞ÂÜôÂÖ•ÁöÑÊï∞ÊçÆÁî®Page-Level MappingÊïàÁéáÈ´òÔºåÂÜôÂÖ•Log Blocks‰Ωú‰∏∫ÁºìÂÜ≤Ôºå‰πãÂêéÂÜçÊõ¥Êñ∞Âà∞Data Blocks</p>
<p>ÊóßÊï∞ÊçÆÂõ†‰∏∫ÂÜôÂÖ•ÂêéÊõ¥Êñ∞Áõ∏ÂØπ‰∏çÈ¢ëÁπÅÔºå‰ΩøÁî®Block-Level MappingÔºåÂÜôÂÖ•Data Blocks</p>
<h1 id="reference">Reference</h1>
<ol>
<li>NNSSÂÆûÈ™åÂÆ§ÊöëÊúüÂÆû‰π†ÊñáÊ°£</li>
<li>„ÄäLinuxÂÜÖÊ†∏ËÆæËÆ°‰∏éÂÆûÁé∞„Äã</li>
<li>„ÄäÊ∑±ÂÖ•ÁêÜËß£LinuxÂÜÖÊ†∏„Äã</li>
<li>„ÄäLinuxËÆæÂ§áÈ©±Âä®Á®ãÂ∫è„Äã</li>
<li>„ÄäÊ∑±ÂÖ•ÊµÖÂá∫SSDÔºöÂõ∫ÊÄÅÂ≠òÂÇ®Ê†∏ÂøÉÊäÄÊúØ„ÄÅÂéüÁêÜ‰∏éÂÆûÊàò„Äã</li>
<li><a class="link" href="https://www.enterprisestorageforum.com/hardware/nand-dram-sas-scsi-and-sata-ahci-not-dead-yet/"  target="_blank" rel="noopener"
    >NAND, DRAM, SAS/SCSI and SATA/AHCI: Not Dead, Yet | Enterprise Storage Forum</a></li>
<li><a class="link" href="https://www.quora.com/Linux-Kernel/What-is-the-major-difference-between-the-buffer-cache-and-the-page-cache-Why-were-they-separate-entities-in-older-kernels-Why-were-they-merged-later-on/answer/Robert-Love-1"  target="_blank" rel="noopener"
    >„ÄêQuora„ÄëRobert LoveÂØπÁºìÂÜ≤Âå∫ÁºìÂ≠òÂíåÈ°µÈù¢ÁºìÂ≠òÁöÑ‰∏ªË¶ÅÂå∫Âà´ÊòØ‰ªÄ‰πàÁöÑÂõûÁ≠îÔºü‰∏∫‰ªÄ‰πàÂÆÉ‰ª¨Âú®ËæÉÊóßÁöÑÂÜÖÊ†∏‰∏≠ÊòØÁã¨Á´ãÁöÑÂÆû‰ΩìÔºü‰∏∫‰ªÄ‰πàÂêéÊù•‰ªñ‰ª¨Ë¢´ÂêàÂπ∂‰∫ÜÔºü</a></li>
<li><a class="link" href="https://pages.cs.wisc.edu/~remzi/OSTEP/"  target="_blank" rel="noopener"
    >„ÄêOSTEP„ÄëOperating Systems: Three Easy Pieces (wisc.edu)</a></li>
<li><a class="link" href="https://www.bilibili.com/video/BV1xE411T7Dy/"  target="_blank" rel="noopener"
    >„Äêbilibili Ê∏ÖÂçéÂ§ßÂ≠¶„ÄëÂ≠òÂÇ®ÊäÄÊúØÂü∫Á°Ä</a></li>
<li><a class="link" href="https://ext4.wiki.kernel.org/index.php/Ext4_Howto"  target="_blank" rel="noopener"
    >„Äêkernel.org Ext4Êñá‰ª∂Á≥ªÁªü‰ªãÁªç„ÄëExt4 Howto - Ext4</a></li>
<li><a class="link" href="https://btrfs.wiki.kernel.org/index.php/Status"  target="_blank" rel="noopener"
    >„Äêkernel.org BtrfsÊñá‰ª∂Á≥ªÁªüÁé∞Áä∂„ÄëStatus - btrfs Wiki</a></li>
<li><a class="link" href="https://www.kernel.org/doc/html/latest/filesystems/ext4/index.html"  target="_blank" rel="noopener"
    >„Äêkernel.org Ext4Êñá‰ª∂Á≥ªÁªüËÆæËÆ°„Äëext4 Data Structures and Algorithms</a></li>
<li><a class="link" href="https://www.usenix.org/conference/fast15/technical-sessions/presentation/lee"  target="_blank" rel="noopener"
    >„ÄêUSENIX FAST'21„ÄëF2FS: A New File System for Flash Storage</a></li>
<li><a class="link" href="https://wiki.archlinux.org/title/Ext4_%28%e7%ae%80%e4%bd%93%e4%b8%ad%e6%96%87%29#%e5%85%b3%e9%97%ad%e5%b1%8f%e9%9a%9c"  target="_blank" rel="noopener"
    >„Äêarchlinux.org ArchWiki„ÄëExt4 </a></li>
<li><a class="link" href="https://access.redhat.com/documentation/en-us/red_hat_enterprise_linux/7/html/storage_administration_guide/ch-ssd"  target="_blank" rel="noopener"
    >„ÄêRed Hat Customer Portal | SSD discard„ÄëChapter 21. Solid-State Disk Deployment Guidelines Red Hat Enterprise Linux 7</a></li>
<li><a class="link" href="https://blog.51cto.com/u_15061941/3859244"  target="_blank" rel="noopener"
    >„Äêmq-deadline„Äëmq-deadlineË∞ÉÂ∫¶Âô®ÂéüÁêÜÂèäÊ∫êÁ†ÅÂàÜÊûê</a></li>
<li><a class="link" href="https://nan01ab.github.io/2019/02/Kyber.html"  target="_blank" rel="noopener"
    >„ÄêKyber I/O„ÄëKyber IO Scheduler of Linux ¬∑ Columba M71&rsquo;s Blog</a></li>
</ol>

</section>


    <footer class="article-footer">
    
    <section class="article-tags">
        
            <a href="/tags/linux/">Linux</a>
        
            <a href="/tags/i/o/">I/O</a>
        
            <a href="/tags/nvme/">NVMe</a>
        
            <a href="/tags/ssd/">SSD</a>
        
            <a href="/tags/file-system/">File System</a>
        
    </section>


    
    <section class="article-copyright">
        <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <circle cx="12" cy="12" r="9" />
  <path d="M14.5 9a3.5 4 0 1 0 0 6" />
</svg>



        <span>Licensed under CC BY-NC-SA 4.0</span>
    </section>
    </footer>


    
        <link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.css"integrity="sha256-J&#43;iAE0sgH8QSz9hpcDxXIftnj65JEZgNhGcgReTTK9s="crossorigin="anonymous"
            ><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/katex.min.js"integrity="sha256-InsNdER1b2xUewP&#43;pKCUJpkhiqwHgqiPXDlIk7GzBu4="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/katex@0.15.6/dist/contrib/auto-render.min.js"integrity="sha256-y39Mpg7V3D4lhBX4x6O0bUqTV4pSrfgwEfGKfxkOdgI="crossorigin="anonymous"
                defer
                >
            </script><script>
    window.addEventListener("DOMContentLoaded", () => {
        renderMathInElement(document.querySelector(`.article-content`), {
            delimiters: [
                { left: "$$", right: "$$", display: true },
                { left: "$", right: "$", display: false },
                { left: "\\(", right: "\\)", display: false },
                { left: "\\[", right: "\\]", display: true }
            ]
        });})
</script>
    
</article>

    

    

<aside class="related-content--wrapper">
    <h2 class="section-title">Related content</h2>
    <div class="related-content">
        <div class="flex article-list--tile">
            
                
<article class="">
    <a href="/p/fast23-more-than-capacity-performance-oriented-evolution-of-pangu-in-alibaba/">
        
        

        <div class="article-details">
            <h2 class="article-title">[FAST&#39;23] More Than Capacity: Performance-oriented Evolution of Pangu in Alibaba</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/osdi22-xrp-in-kernel-storage-functions-with-ebpf/">
        
        

        <div class="article-details">
            <h2 class="article-title">[OSDI&#39;22] XRP: In-Kernel Storage Functions with eBPF</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/fast22-mt2-memory-bandwidth-regulation-on-hybrid-nvm/dram-platforms/">
        
        

        <div class="article-details">
            <h2 class="article-title">[FAST&#39;22] MT^2: Memory Bandwidth Regulation on Hybrid NVM/DRAM Platforms</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/acm-trans.-on-storage-hintstor-a-framework-to-study-i/o-hints-in-heterogeneous-storage/">
        
        

        <div class="article-details">
            <h2 class="article-title">[ACM Trans. On Storage] HintStor: A Framework to Study I/O Hints in Heterogeneous Storage</h2>
        </div>
    </a>
</article>

            
                
<article class="">
    <a href="/p/atc20-pink-high-speed-in-storage-key-value-store-with-bounded-tails/">
        
        

        <div class="article-details">
            <h2 class="article-title">[ATC&#39;20] PinK: High-speed In-storage Key-value Store with Bounded Tails</h2>
        </div>
    </a>
</article>

            
        </div>
    </div>
</aside>

     
    
        
    <div class="disqus-container">
    <div id="disqus_thread"></div>
<script type="application/javascript">
    window.disqus_config = function () {
    
    
    
    };
    (function() {
        if (["localhost", "127.0.0.1"].indexOf(window.location.hostname) != -1) {
            document.getElementById('disqus_thread').innerHTML = 'Disqus comments not available by default when the website is previewed locally.';
            return;
        }
        var d = document, s = d.createElement('script'); s.async = true;
        s.src = '//' + "coding-pandas" + '.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="https://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
</div>

<style>
    .disqus-container {
        background-color: var(--card-background);
        border-radius: var(--card-border-radius);
        box-shadow: var(--shadow-l1);
        padding: var(--card-padding);
    }
</style>

<script>
    window.addEventListener('onColorSchemeChange', (e) => {
        if (typeof DISQUS == 'object') {
            DISQUS.reset({
                reload: true
            });
        }
    })
</script>

    

    <footer class="site-footer">
    <section class="copyright">
        &copy; 
        
            2019 - 
        
        2023 Coding_Panda&#39;s Blog
    </section>
    
    
    <section class="powerby">
        ICPÂ§áÊ°àÔºö <a href="https://beian.miit.gov.cn">È≤ÅICPÂ§á2021030271Âè∑</a> <br/>
        Built with <a href="https://gohugo.io/" target="_blank" rel="noopener">Hugo</a> <br />
        Theme <b><a href="https://github.com/CaiJimmy/hugo-theme-stack" target="_blank" rel="noopener" data-version="3.14.0">Stack</a></b> designed by <a href="https://jimmycai.com" target="_blank" rel="noopener">Jimmy</a>
    </section>
</footer>


    
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    
    <div class="pswp__bg"></div>

    
    <div class="pswp__scroll-wrap">

        
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                
                
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo="crossorigin="anonymous"
                defer
                >
            </script><script 
                src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU="crossorigin="anonymous"
                defer
                >
            </script><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css"crossorigin="anonymous"
            ><link 
                rel="stylesheet" 
                href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css"crossorigin="anonymous"
            >

            </main>
    <aside class="sidebar right-sidebar sticky">
        
            
                
    <section class="widget archives">
        <div class="widget-icon">
            <svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round">
  <path stroke="none" d="M0 0h24v24H0z"/>
  <line x1="5" y1="9" x2="19" y2="9" />
  <line x1="5" y1="15" x2="19" y2="15" />
  <line x1="11" y1="4" x2="7" y2="20" />
  <line x1="17" y1="4" x2="13" y2="20" />
</svg>



        </div>
        <h2 class="widget-title section-title">Table of contents</h2>
        
        <div class="widget--toc">
            <nav id="TableOfContents">
  <ol>
    <li><a href="#linux-io-Ê†àÊ¶ÇËø∞">Linux I/O Ê†àÊ¶ÇËø∞</a>
      <ol>
        <li><a href="#Â∫îÁî®Á®ãÂ∫èÂ±Ç">Â∫îÁî®Á®ãÂ∫èÂ±Ç</a></li>
        <li><a href="#vfsÂ±Ç">VFSÂ±Ç</a></li>
        <li><a href="#ÂùóioÂ±Ç">ÂùóI/OÂ±Ç</a></li>
        <li><a href="#scsiÂ∫ïÂ±Ç--ËÆæÂ§áÈ©±Âä®Â±Ç">SCSIÂ∫ïÂ±Ç &amp;&amp; ËÆæÂ§áÈ©±Âä®Â±Ç</a></li>
        <li><a href="#Áâ©ÁêÜÂ§ñËÆæÂ±Ç">Áâ©ÁêÜÂ§ñËÆæÂ±Ç</a></li>
      </ol>
    </li>
    <li><a href="#vfsÁÆÄ‰ªã">VFSÁÆÄ‰ªã</a>
      <ol>
        <li><a href="#intro">Intro</a></li>
        <li><a href="#directory-entry-cache-dcache">Directory Entry Cache (dcache)</a></li>
        <li><a href="#the-inode-object">The Inode Object</a></li>
        <li><a href="#the-file-object">The File Object</a></li>
        <li><a href="#the-dentry-object">The Dentry Object</a></li>
        <li><a href="#the-superblock-object">The SuperBlock Object</a>
          <ol>
            <li><a href="#Ê≥®ÂÜåÂíåÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü">Ê≥®ÂÜåÂíåÊåÇËΩΩ‰∏Ä‰∏™Êñá‰ª∂Á≥ªÁªü</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#page-cache">Page Cache</a>
      <ol>
        <li><a href="#‰∏ªË¶ÅÊï∞ÊçÆÁªìÊûÑ">‰∏ªË¶ÅÊï∞ÊçÆÁªìÊûÑ</a></li>
        <li><a href="#Âü∫Êï∞Ê†ë-radix-tree">Âü∫Êï∞Ê†ë Radix Tree</a></li>
        <li><a href="#page-cacheÂ§ÑÁêÜÂáΩÊï∞">Page CacheÂ§ÑÁêÜÂáΩÊï∞</a>
          <ol>
            <li><a href="#find_get_page">find_get_page()</a></li>
            <li><a href="#add_to_page_cache">add_to_page_cache()</a></li>
            <li><a href="#remove_from_page_cache">remove_from_page_cache()</a></li>
            <li><a href="#read_cache_page">read_cache_page()</a></li>
          </ol>
        </li>
        <li><a href="#buffer-cache">Buffer Cache</a></li>
        <li><a href="#ËÑèÈ°µÁöÑÂ§ÑÁêÜ">ËÑèÈ°µÁöÑÂ§ÑÁêÜ</a></li>
      </ol>
    </li>
    <li><a href="#Êñá‰ª∂ÁöÑËÆøÈóÆ">Êñá‰ª∂ÁöÑËÆøÈóÆ</a>
      <ol>
        <li><a href="#ËØªÊñá‰ª∂">ËØªÊñá‰ª∂</a>
          <ol>
            <li><a href="#generic_file_read">generic_file_read()</a></li>
            <li><a href="#__generic_file_aio_read">__generic_file_aio_read()</a></li>
          </ol>
        </li>
        <li><a href="#ÂÜôÊµÅÁ®ã">ÂÜôÊµÅÁ®ã</a></li>
        <li><a href="#È¢ÑÂèñÊú∫Âà∂">È¢ÑÂèñÊú∫Âà∂</a></li>
        <li><a href="#ÁºìÂ≠òÂõûÂÜôÊú∫Âà∂">ÁºìÂ≠òÂõûÂÜôÊú∫Âà∂</a></li>
      </ol>
    </li>
    <li><a href="#Êñá‰ª∂Á≥ªÁªü">Êñá‰ª∂Á≥ªÁªü</a>
      <ol>
        <li><a href="#ext4">ext4</a>
          <ol>
            <li><a href="#ext-Êñá‰ª∂Á≥ªÁªüÂèëÂ±ïÂéÜÂè≤">ext Êñá‰ª∂Á≥ªÁªüÂèëÂ±ïÂéÜÂè≤</a>
              <ol>
                <li><a href="#ext1">ext1</a></li>
                <li><a href="#ext2">ext2</a></li>
                <li><a href="#ext3">ext3</a></li>
                <li><a href="#ext4-1">ext4</a></li>
              </ol>
            </li>
            <li><a href="#Êï∞ÊçÆÁªÑÁªá">Êï∞ÊçÆÁªÑÁªá</a></li>
          </ol>
        </li>
        <li><a href="#f2fs">F2FS</a>
          <ol>
            <li><a href="#‰∏ªË¶ÅÁâπÁÇπ">‰∏ªË¶ÅÁâπÁÇπ</a></li>
          </ol>
        </li>
        <li><a href="#btrfs">Btrfs</a></li>
      </ol>
    </li>
    <li><a href="#ÂùóioÂ±Ç-‰∏é-ioË∞ÉÂ∫¶Âô®">ÂùóI/OÂ±Ç ‰∏é I/OË∞ÉÂ∫¶Âô®</a>
      <ol>
        <li><a href="#ÂùóËÆæÂ§á">ÂùóËÆæÂ§á</a></li>
        <li><a href="#mq-deadline">mq-deadline</a></li>
        <li><a href="#bfq">bfq</a></li>
        <li><a href="#kyber">kyber</a></li>
      </ol>
    </li>
    <li><a href="#nvmeÊé•Âè£ÂçèËÆÆ">NVMeÊé•Âè£ÂçèËÆÆ</a>
      <ol>
        <li><a href="#ÁÆÄ‰ªã">ÁÆÄ‰ªã</a></li>
        <li><a href="#nvmeÂ∑•‰ΩúÂéüÁêÜ">NVMeÂ∑•‰ΩúÂéüÁêÜ</a>
          <ol>
            <li><a href="#‰ªé‰∏ªÊú∫ioËØ∑Ê±ÇÂà∞ssd">‰ªé‰∏ªÊú∫I/OËØ∑Ê±ÇÂà∞SSD</a></li>
          </ol>
        </li>
        <li><a href="#submission-queueÂíåcompletion-queueÁÆÄ‰ªã">Submission QueueÂíåCompletion QueueÁÆÄ‰ªã</a></li>
        <li><a href="#db-doorbell-register">DB: Doorbell Register</a></li>
        <li><a href="#ÂÖ∂‰ªñÊúâÂÖ≥nvmeÁöÑÂÜÖÂÆπ">ÂÖ∂‰ªñÊúâÂÖ≥NVMeÁöÑÂÜÖÂÆπ</a></li>
      </ol>
    </li>
    <li><a href="#Âü∫‰∫éÈó™Â≠òÁöÑÂõ∫ÊÄÅÁõò">Âü∫‰∫éÈó™Â≠òÁöÑÂõ∫ÊÄÅÁõò</a>
      <ol>
        <li><a href="#flash-memory">Flash Memory</a>
          <ol>
            <li><a href="#Èó™Â≠òÂéüÁêÜ">Èó™Â≠òÂéüÁêÜ</a>
              <ol>
                <li><a href="#Á±ªÂûã">Á±ªÂûã</a></li>
                <li><a href="#Èó™Â≠òÂçïÂÖÉ">Èó™Â≠òÂçïÂÖÉ</a></li>
                <li><a href="#Â§öÊØîÁâπÈó™Â≠ò">Â§öÊØîÁâπÈó™Â≠ò</a></li>
                <li><a href="#Èó™Â≠ò">Èó™Â≠ò</a></li>
                <li><a href="#Èó™Â≠òÁâπÊÄß">Èó™Â≠òÁâπÊÄß</a>
                  <ol>
                    <li><a href="#ËØªÂÜôÁ≤íÂ∫¶">ËØªÂÜôÁ≤íÂ∫¶</a></li>
                    <li><a href="#‰∏çÂèØË¶ÜÁõñÂÜô">‰∏çÂèØË¶ÜÁõñÂÜô</a></li>
                    <li><a href="#ÊúâÈôêÊ¨°Êì¶Èô§">ÊúâÈôêÊ¨°Êì¶Èô§</a></li>
                  </ol>
                </li>
              </ol>
            </li>
          </ol>
        </li>
        <li><a href="#ftl">FTL</a>
          <ol>
            <li><a href="#ÂûÉÂúæÂõûÊî∂">ÂûÉÂúæÂõûÊî∂</a>
              <ol>
                <li><a href="#gcÁ≠ñÁï•">GCÁ≠ñÁï•</a></li>
              </ol>
            </li>
            <li><a href="#Á£®ÊçüÂùáË°°">Á£®ÊçüÂùáË°°</a></li>
            <li><a href="#ftlÁÆÄ‰ªã">FTLÁÆÄ‰ªã</a></li>
            <li><a href="#page-level-ftl">Page-Level FTL</a></li>
            <li><a href="#block-level-ftl">Block-Level FTL</a></li>
            <li><a href="#hybrid-ftl">Hybrid FTL</a></li>
          </ol>
        </li>
      </ol>
    </li>
    <li><a href="#reference">Reference</a></li>
  </ol>
</nav>
        </div>
    </section>

            
        
    </aside>


        </div>
        <script 
                src="https://cdn.jsdelivr.net/npm/node-vibrant@3.1.6/dist/vibrant.min.js"integrity="sha256-awcR2jno4kI5X0zL8ex0vi2z&#43;KMkF24hUW8WePSA9HM="crossorigin="anonymous"
                
                >
            </script><script type="text/javascript" src="/ts/main.js" defer></script>
<script>
    (function () {
        const customFont = document.createElement('link');
        customFont.href = "https://fonts.googleapis.com/css2?family=Lato:wght@300;400;700&display=swap";

        customFont.type = "text/css";
        customFont.rel = "stylesheet";

        document.head.appendChild(customFont);
    }());
</script>

    </body>
</html>
